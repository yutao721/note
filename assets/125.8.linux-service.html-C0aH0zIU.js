import{_ as n,c as a,a as e,o as t}from"./app-CD1YpnS1.js";const l={};function p(i,s){return t(),a("div",null,[...s[0]||(s[0]=[e(`<h2 id="_1-服务简介和分类" tabindex="-1"><a class="header-anchor" href="#_1-服务简介和分类"><span>1.服务简介和分类</span></a></h2><h3 id="_1-1-运行级别" tabindex="-1"><a class="header-anchor" href="#_1-1-运行级别"><span>1.1 运行级别</span></a></h3><h4 id="_1-1-1-运行级别分类" tabindex="-1"><a class="header-anchor" href="#_1-1-1-运行级别分类"><span>1.1.1 运行级别分类</span></a></h4><table><thead><tr><th style="text-align:left;">运行级别</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">0</td><td style="text-align:left;">关机</td></tr><tr><td style="text-align:left;">1</td><td style="text-align:left;">单用户,类似于Window的安全模式，主要用于系统修复</td></tr><tr><td style="text-align:left;">2</td><td style="text-align:left;">不完全多用户，类似于字符界面，但不包含NFS(Linux和Window进行文件共享)服务</td></tr><tr><td style="text-align:left;">3</td><td style="text-align:left;">完整的命令行模式，就是标准的字符界面</td></tr><tr><td style="text-align:left;">4</td><td style="text-align:left;">系统保留未使用</td></tr><tr><td style="text-align:left;">5</td><td style="text-align:left;">图形界面</td></tr><tr><td style="text-align:left;">6</td><td style="text-align:left;">重启</td></tr></tbody></table><h4 id="_1-1-2-查看上一个级别和当前级别" tabindex="-1"><a class="header-anchor" href="#_1-1-2-查看上一个级别和当前级别"><span>1.1.2 查看上一个级别和当前级别</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">runlevel </span>
<span class="line"><span class="token constant">N</span> <span class="token number">3</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-1-3-切换运行级别" tabindex="-1"><a class="header-anchor" href="#_1-1-3-切换运行级别"><span>1.1.3 切换运行级别</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">init <span class="token number">5</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_1-1-4-设置默认运行级别" tabindex="-1"><a class="header-anchor" href="#_1-1-4-设置默认运行级别"><span>1.1.4 设置默认运行级别</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">vi <span class="token operator">/</span>etc<span class="token operator">/</span>inittab</span>
<span class="line"><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">3</span><span class="token operator">:</span>initdefault<span class="token operator">:</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-服务的分类" tabindex="-1"><a class="header-anchor" href="#_1-2-服务的分类"><span>1.2 服务的分类</span></a></h3><ul><li>系统开启的服务越少，服务器就会更加稳定和安全</li><li>服务安装方式不同，启动的方式也不同</li></ul><h4 id="_1-2-1-服务管理的方式" tabindex="-1"><a class="header-anchor" href="#_1-2-1-服务管理的方式"><span>1.2.1 服务管理的方式</span></a></h4><ul><li><code>RPM包</code>安装的服务,由软件包作者指定安装位置,独立的服务，绝大多数服务都是独立运行在内存中的，可以直接响应客户端的请求</li><li><code>源码包</code>安装的服务，由我们用户决定安装位置</li></ul><h4 id="_1-2-2-查看rpm包安装的服务" tabindex="-1"><a class="header-anchor" href="#_1-2-2-查看rpm包安装的服务"><span>1.2.2 查看RPM包安装的服务</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">chkconfig --list</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_1-2-3-查看源码包安装的服务" tabindex="-1"><a class="header-anchor" href="#_1-2-3-查看源码包安装的服务"><span>1.2.3 查看源码包安装的服务</span></a></h4><ul><li>查看自定义的安装位置，默认为<code>/usr/local</code>下</li><li>usr= Unix System Resource 系统资源</li></ul><h4 id="_1-2-4-启动和自启动" tabindex="-1"><a class="header-anchor" href="#_1-2-4-启动和自启动"><span>1.2.4 启动和自启动</span></a></h4><ul><li>启动服务就是指让此服务在当前系统中运行，并向客户端提供服务</li><li>服务自启动就是指通过设置，让此服务在开机或者重启后随着系统启动而自动启动</li></ul><h3 id="_1-3-服务与端口" tabindex="-1"><a class="header-anchor" href="#_1-3-服务与端口"><span>1.3 服务与端口</span></a></h3><p>查看系统中的运行中的进程</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">ps -aux</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>查看常见服务端口</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">cat /etc/services</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_1-4-查询系统中监听的端口" tabindex="-1"><a class="header-anchor" href="#_1-4-查询系统中监听的端口"><span>1.4 查询系统中监听的端口</span></a></h3><ul><li>netstat -tulnp</li></ul><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-t</td><td style="text-align:left;">列出tcp数据</td></tr><tr><td style="text-align:left;">-u</td><td style="text-align:left;">列出udp数据</td></tr><tr><td style="text-align:left;">-l</td><td style="text-align:left;">列出正在监听的网络服务</td></tr><tr><td style="text-align:left;">-n</td><td style="text-align:left;">用端口号来显示服务，而非服务名</td></tr><tr><td style="text-align:left;">-p</td><td style="text-align:left;">列出该服务的进程ID</td></tr></tbody></table><h2 id="_2-prm包服务管理" tabindex="-1"><a class="header-anchor" href="#_2-prm包服务管理"><span>2. PRM包服务管理</span></a></h2><ul><li>RMP 是 LINUX 下的一种软件的可执行程序，你只要安装它就可以了。这种软件安装包通常是一个RPM包（Redhat Linux Packet Manager，就是Redhat的包管理器），后缀是.rpm</li><li>RPM是Red Hat公司随Redhat Linux推出了一个软件包管理器，通过它能够更加轻松容易地实现软件的安装</li></ul><h3 id="_2-1-rpm命令" tabindex="-1"><a class="header-anchor" href="#_2-1-rpm命令"><span>2.1 rpm命令</span></a></h3><table><thead><tr><th style="text-align:left;">用途</th><th style="text-align:left;">命令</th></tr></thead><tbody><tr><td style="text-align:left;">安装软件</td><td style="text-align:left;">执行<code>rpm -ivh rpm</code>包名</td></tr><tr><td style="text-align:left;">升级软件</td><td style="text-align:left;">执行<code>rpm -Uvh rpm</code>包名</td></tr><tr><td style="text-align:left;">反安装</td><td style="text-align:left;">执行<code>rpm -e rpm</code>包名</td></tr><tr><td style="text-align:left;">查询软件包的详细信息</td><td style="text-align:left;">执行<code>rpm -qpi rpm</code>包名</td></tr><tr><td style="text-align:left;">查询某个文件是属于那个rpm包的</td><td style="text-align:left;">执行<code>rpm -qf rpm</code>包名</td></tr><tr><td style="text-align:left;">查该软件包会向系统里面写入哪些文件</td><td style="text-align:left;">执行 <code>rpm -qpl rpm</code>包名</td></tr></tbody></table><h3 id="_2-2-repo" tabindex="-1"><a class="header-anchor" href="#_2-2-repo"><span>2.2 repo</span></a></h3><ul><li>repo文件是yum源（软件仓库）的配置文件，通常一个repo文件定义了一个或者多个软件仓库的细节内容，例如我们将从哪里下载需要安装或者升级的软件包，repo文件中的设置内容将被yum读取和应用</li><li>服务器端：在服务器上面存放了所有的RPM软件包，然后以相关的功能去分析每个RPM文件的依赖性关系，将这些数据记录成文件存放在服务器的某特定目录内。</li><li>客户端：如果需要安装某个软件时，先下载服务器上面记录的依赖性关系文件(可通过WWW或FTP方式)，通过对服务器端下载的纪录数据进行分析，然后取得所有相关的软件，一次全部下载下来进行安装。</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">cat /etc/yum.conf</span>
<span class="line">/etc/yum.repos.d</span>
<span class="line">/etc/yum.repos.d/nginx.repo</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-rpm包的默认安装位置" tabindex="-1"><a class="header-anchor" href="#_2-3-rpm包的默认安装位置"><span>2.3 RPM包的默认安装位置</span></a></h3><table><thead><tr><th style="text-align:left;">文件</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">/etc</td><td style="text-align:left;">配置文件位置</td></tr><tr><td style="text-align:left;">/etc/init.d</td><td style="text-align:left;">启动脚本位置</td></tr><tr><td style="text-align:left;">/etc/sysconfig</td><td style="text-align:left;">初始化环境配置文件位置</td></tr><tr><td style="text-align:left;">/var/lib</td><td style="text-align:left;">服务产生的数据放在这里</td></tr><tr><td style="text-align:left;">/var/log</td><td style="text-align:left;">日志</td></tr></tbody></table><h3 id="_2-4-启动命令" tabindex="-1"><a class="header-anchor" href="#_2-4-启动命令"><span>2.4 启动命令</span></a></h3><ul><li>systemd是Linux系统最新的初始化系统(init),作用是提高系统的启动速度，尽可能启动较少的进程，尽可能更多进程并发启动</li><li>systemd对应的进程管理命令是<code>systemctl</code></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">rpm <span class="token operator">-</span>ivh http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>nginx<span class="token punctuation">.</span>org<span class="token operator">/</span>packages<span class="token operator">/</span>centos<span class="token operator">/</span><span class="token number">6</span><span class="token operator">/</span>noarch<span class="token operator">/</span><span class="token constant">RPMS</span><span class="token operator">/</span>nginx<span class="token operator">-</span>release<span class="token operator">-</span>centos<span class="token operator">-</span><span class="token number">6</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">.</span>el6<span class="token punctuation">.</span>ngx<span class="token punctuation">.</span>noarch<span class="token punctuation">.</span>rpm</span>
<span class="line">yum info nginx</span>
<span class="line">yum install <span class="token operator">-</span>y nginx </span>
<span class="line">systemctl start nginx<span class="token punctuation">.</span>service</span>
<span class="line">netstat <span class="token operator">-</span>ltun <span class="token operator">|</span> grep <span class="token number">80</span></span>
<span class="line">curl http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-源码包服务管理" tabindex="-1"><a class="header-anchor" href="#_2-源码包服务管理"><span>2. 源码包服务管理</span></a></h2><ul><li>使用绝对路径，调用启动脚本来启动。</li><li>不同的源码包的启动脚本不一样</li><li>要通过阅读源码包安装说明的方式来查看启动的方法</li></ul><h3 id="_2-1-安装nginx" tabindex="-1"><a class="header-anchor" href="#_2-1-安装nginx"><span>2.1 安装nginx</span></a></h3><h4 id="_2-1-1-安装依赖" tabindex="-1"><a class="header-anchor" href="#_2-1-1-安装依赖"><span>2.1.1 安装依赖</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">yum install gcc gcc-c++ perl -y</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-1-2-下载源文件" tabindex="-1"><a class="header-anchor" href="#_2-1-2-下载源文件"><span>2.1.2 下载源文件</span></a></h4><h5 id="_2-1-2-1-pcre" tabindex="-1"><a class="header-anchor" href="#_2-1-2-1-pcre"><span>2.1.2.1 PCRE</span></a></h5><ul><li><a href="http://www.pcre.org/" target="_blank" rel="noopener noreferrer">官网</a></li><li><a href="ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/" target="_blank" rel="noopener noreferrer">FTP下载</a></li><li><a href="http://sourceforge.net/projects/pcre/files/pcre/" target="_blank" rel="noopener noreferrer">HTTP下载</a></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">wget https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>img<span class="token punctuation">.</span>zhufengpeixun<span class="token punctuation">.</span>com<span class="token operator">/</span>pcre<span class="token operator">-</span><span class="token number">8.44</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="_2-1-2-2-zlib" tabindex="-1"><a class="header-anchor" href="#_2-1-2-2-zlib"><span>2.1.2.2 zlib</span></a></h5><ul><li><a href="http://www.zlib.net/" target="_blank" rel="noopener noreferrer">官网</a></li><li><a href="http://prdownloads.sourceforge.net/libpng/zlib-1.2.11.tar.gz" target="_blank" rel="noopener noreferrer">HTTP下载</a></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">wget https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>img<span class="token punctuation">.</span>zhufengpeixun<span class="token punctuation">.</span>com<span class="token operator">/</span>zlib<span class="token operator">-</span><span class="token number">1.2</span><span class="token number">.11</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="_2-1-2-3-openssl" tabindex="-1"><a class="header-anchor" href="#_2-1-2-3-openssl"><span>2.1.2.3 openssl</span></a></h5><ul><li><a href="https://www.openssl.org/" target="_blank" rel="noopener noreferrer">官网</a></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">wget https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>img<span class="token punctuation">.</span>zhufengpeixun<span class="token punctuation">.</span>com<span class="token operator">/</span>openssl<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span><span class="token number">2n</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="_2-1-2-4-nginx" tabindex="-1"><a class="header-anchor" href="#_2-1-2-4-nginx"><span>2.1.2.4 nginx</span></a></h5><ul><li><a href="http://nginx.org/en/docs/configure.html" target="_blank" rel="noopener noreferrer">官网</a></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">wget https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>img<span class="token punctuation">.</span>zhufengpeixun<span class="token punctuation">.</span>com<span class="token operator">/</span>nginx<span class="token operator">-</span><span class="token number">1.10</span><span class="token number">.1</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-1-3-解压文件" tabindex="-1"><a class="header-anchor" href="#_2-1-3-解压文件"><span>2.1.3 解压文件</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mkdir <span class="token operator">/</span>root<span class="token operator">/</span>nginxinstall</span>
<span class="line">cd  <span class="token operator">/</span>root<span class="token operator">/</span>nginxinstall</span>
<span class="line">tar <span class="token operator">-</span>zxvf nginx<span class="token operator">-</span><span class="token number">1.10</span><span class="token number">.1</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line">tar <span class="token operator">-</span>zxvf openssl<span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">.</span>2h<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line">tar <span class="token operator">-</span>zxvf pcre<span class="token operator">-</span><span class="token number">8.44</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line">tar <span class="token operator">-</span>zxvf zlib<span class="token operator">-</span><span class="token number">1.2</span><span class="token number">.11</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-1-3-配置和安装" tabindex="-1"><a class="header-anchor" href="#_2-1-3-配置和安装"><span>2.1.3 配置和安装</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">cd nginx-1.10.1</span>
<span class="line">./configure --prefix=/usr/local/nginx \\</span>
<span class="line">--pid-path=/usr/local/nginx/nginx.pid \\</span>
<span class="line">--error-log-path=/usr/local/nginx/error.log \\</span>
<span class="line">--http-log-path=/usr/local/nginx/access.log \\</span>
<span class="line">--with-http_ssl_module \\</span>
<span class="line">--with-mail --with-mail_ssl_module \\</span>
<span class="line">--with-stream --with-threads \\</span>
<span class="line">--user=comex --group=comexgroup \\</span>
<span class="line">--with-pcre=/root/nginxinstall/pcre-8.44 \\</span>
<span class="line">--with-zlib=/root/nginxinstall/zlib-1.2.11 \\</span>
<span class="line">--with-openssl=/root/nginxinstall/openssl-1.0.2n</span>
<span class="line">make &amp;&amp; make install</span>
<span class="line"></span>
<span class="line">/usr/local/nginx/sbin/nginx  -t</span>
<span class="line">nginx: [emerg] getpwnam(&quot;comex&quot;) failed</span>
<span class="line"></span>
<span class="line"> useadd nginx </span>
<span class="line">vi /usr/local/nginx/conf/nginx.conf</span>
<span class="line">user  nginx;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-1-4-管理命令" tabindex="-1"><a class="header-anchor" href="#_2-1-4-管理命令"><span>2.1.4 管理命令</span></a></h4><table><thead><tr><th style="text-align:left;">功能</th><th style="text-align:left;">命令</th></tr></thead><tbody><tr><td style="text-align:left;">启动</td><td style="text-align:left;">/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</td></tr><tr><td style="text-align:left;">从容停止</td><td style="text-align:left;">ps -ef grep nginx;kill -QUIT 2072</td></tr><tr><td style="text-align:left;">快速停止</td><td style="text-align:left;">ps -ef grep nginx;kill -TERM 2132; kill -INT 2132</td></tr><tr><td style="text-align:left;">强制停止</td><td style="text-align:left;">pkill -9 nginx</td></tr><tr><td style="text-align:left;">验证nginx配置文件是否正确</td><td style="text-align:left;">nginx -t</td></tr><tr><td style="text-align:left;">重启Nginx服务</td><td style="text-align:left;">nginx -s reload</td></tr><tr><td style="text-align:left;">查找当前nginx进程号</td><td style="text-align:left;">kill -HUP 进程号</td></tr></tbody></table><h4 id="_2-1-5-以服务启动service" tabindex="-1"><a class="header-anchor" href="#_2-1-5-以服务启动service"><span>2.1.5 以服务启动service</span></a></h4><ul><li>Nginx启动、关闭、重新加载脚本</li><li>创建文件 <code>etc/init.d/nginx</code></li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">/etc/init.d/nginx start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line"></span>
<span class="line"><span class="token constant">NAME</span><span class="token operator">=</span>nginx</span>
<span class="line"><span class="token constant">DAEMON</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>sbin<span class="token operator">/</span>$<span class="token constant">NAME</span></span>
<span class="line"><span class="token constant">CONFIGFILE</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token operator">/</span>$<span class="token constant">NAME</span><span class="token punctuation">.</span>conf</span>
<span class="line"><span class="token constant">PIDFILE</span><span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>logs<span class="token operator">/</span>$<span class="token constant">NAME</span><span class="token punctuation">.</span>pid</span>
<span class="line"><span class="token constant">SCRIPTNAME</span><span class="token operator">=</span><span class="token operator">/</span>etc<span class="token operator">/</span>init<span class="token punctuation">.</span>d<span class="token operator">/</span>$<span class="token constant">NAME</span></span>
<span class="line"></span>
<span class="line">set <span class="token operator">-</span>e</span>
<span class="line"><span class="token punctuation">[</span> <span class="token operator">-</span>x <span class="token string">&quot;$DAEMON&quot;</span> <span class="token punctuation">]</span> <span class="token operator">||</span> exit <span class="token number">0</span></span>
<span class="line"></span>
<span class="line"><span class="token function">do_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"> $<span class="token constant">DAEMON</span> <span class="token operator">-</span>c $<span class="token constant">CONFIGFILE</span>  <span class="token operator">||</span> echo <span class="token operator">-</span>n <span class="token string">&quot;nginx already running&quot;</span></span>
<span class="line"> pid<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>ps <span class="token operator">-</span>ef <span class="token operator">|</span> grep nginx <span class="token operator">|</span> grep master <span class="token operator">|</span> awk <span class="token string">&#39;{print $2}&#39;</span><span class="token punctuation">)</span></span>
<span class="line"> echo $pid <span class="token operator">&gt;</span> <span class="token string">&quot;$PIDFILE&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token function">do_stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"> kill <span class="token operator">-</span><span class="token constant">INT</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">cat $PIDFILE</span><span class="token template-punctuation string">\`</span></span> <span class="token operator">||</span> echo <span class="token operator">-</span>n <span class="token string">&quot;nginx not running&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token function">do_reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"> kill <span class="token operator">-</span><span class="token constant">HUP</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">cat $PIDFILE</span><span class="token template-punctuation string">\`</span></span> <span class="token operator">||</span> echo <span class="token operator">-</span>n <span class="token string">&quot;nginx can&#39;t reload&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">case</span> <span class="token string">&quot;$1&quot;</span> <span class="token keyword">in</span></span>
<span class="line"> start<span class="token punctuation">)</span></span>
<span class="line"> echo <span class="token operator">-</span>n <span class="token string">&quot;Starting  $NAME&quot;</span></span>
<span class="line"> do_start</span>
<span class="line"> echo <span class="token string">&quot;.&quot;</span></span>
<span class="line"> <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line"> stop<span class="token punctuation">)</span></span>
<span class="line"> echo <span class="token operator">-</span>n <span class="token string">&quot;Stopping  $NAME&quot;</span></span>
<span class="line"> do_stop</span>
<span class="line"> echo <span class="token string">&quot;.&quot;</span></span>
<span class="line"> <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line"> reload<span class="token operator">|</span>graceful<span class="token punctuation">)</span></span>
<span class="line"> echo <span class="token operator">-</span>n <span class="token string">&quot;Reloading  configuration&quot;</span></span>
<span class="line"> do_reload</span>
<span class="line"> echo <span class="token string">&quot;.&quot;</span></span>
<span class="line"> <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line"> restart<span class="token punctuation">)</span></span>
<span class="line"> echo <span class="token operator">-</span>n <span class="token string">&quot;Restarting  $NAME&quot;</span></span>
<span class="line"> do_stop</span>
<span class="line"> do_start</span>
<span class="line"> echo <span class="token string">&quot;.&quot;</span></span>
<span class="line"> <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line"> <span class="token operator">*</span><span class="token punctuation">)</span></span>
<span class="line"> echo <span class="token string">&quot;Usage: $SCRIPTNAME {start|stop|reload|restart}&quot;</span> <span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token number">2</span></span>
<span class="line"> exit <span class="token number">3</span></span>
<span class="line"> <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line">esac</span>
<span class="line">exit <span class="token number">0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-1-7-chkconfig" tabindex="-1"><a class="header-anchor" href="#_2-1-7-chkconfig"><span>2.1.7 chkconfig</span></a></h4><ul><li>指定nginx脚本可以被chkconfig命令管理</li></ul><h5 id="_2-1-7-1-开机启动" tabindex="-1"><a class="header-anchor" href="#_2-1-7-1-开机启动"><span>2.1.7.1 开机启动</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chkconfig <span class="token operator">--</span>add nginx</span>
<span class="line">chkconfig <span class="token operator">--</span>list </span>
<span class="line">chkconfig <span class="token operator">--</span>level <span class="token number">2345</span> nginx on </span>
<span class="line">chkconfig nginx off</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,72)])])}const c=n(l,[["render",p]]),o=JSON.parse('{"path":"/strong/125.8.linux-service.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/125.8.linux-service.md"}');export{c as comp,o as data};
