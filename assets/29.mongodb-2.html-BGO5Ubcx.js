import{_ as n,c as a,a as p,o as t}from"./app-CD1YpnS1.js";const e={};function l(o,s){return t(),a("div",null,[...s[0]||(s[0]=[p(`<h2 id="_1-通过配置项启动数据库" tabindex="-1"><a class="header-anchor" href="#_1-通过配置项启动数据库"><span>1. 通过配置项启动数据库</span></a></h2><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">--dbpath</td><td style="text-align:left;">指定数据库文件的目录</td></tr><tr><td style="text-align:left;">--port</td><td style="text-align:left;">端口 默认是27017 28017</td></tr><tr><td style="text-align:left;">--fork</td><td style="text-align:left;">以后台守护的方式进行启动</td></tr><tr><td style="text-align:left;">--logpath</td><td style="text-align:left;">指定日志文件输出路径</td></tr><tr><td style="text-align:left;">--config</td><td style="text-align:left;">指定一个配置文件</td></tr><tr><td style="text-align:left;">--auth</td><td style="text-align:left;">以安全方式启动数据库，默认不验证</td></tr></tbody></table><h3 id="_1-1-mongo-conf" tabindex="-1"><a class="header-anchor" href="#_1-1-mongo-conf"><span>1.1 mongo.conf</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\mongo\\data</span>
<span class="line">logpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\mongo\\log</span>
<span class="line">port<span class="token operator">=</span><span class="token number">50000</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-启动服务器" tabindex="-1"><a class="header-anchor" href="#_1-2-启动服务器"><span>1.2 启动服务器</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">mongod --config mongo.conf</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_1-3-启动客户端" tabindex="-1"><a class="header-anchor" href="#_1-3-启动客户端"><span>1.3 启动客户端</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mongo <span class="token operator">--</span>port <span class="token number">50000</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_2-导入导出数据" tabindex="-1"><a class="header-anchor" href="#_2-导入导出数据"><span>2. 导入导出数据</span></a></h2><p>这命令是保存成了文件格式</p><ul><li>mongoimport 导出数据</li><li>mongoexport 导入数据</li></ul><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-h [ --host ]</td><td style="text-align:left;">连接的数据库</td></tr><tr><td style="text-align:left;">--port</td><td style="text-align:left;">端口号</td></tr><tr><td style="text-align:left;">-u</td><td style="text-align:left;">用户名</td></tr><tr><td style="text-align:left;">-p</td><td style="text-align:left;">密码</td></tr><tr><td style="text-align:left;">-d</td><td style="text-align:left;">导出的数据库</td></tr><tr><td style="text-align:left;">-d</td><td style="text-align:left;">导出的数据库</td></tr><tr><td style="text-align:left;">-c</td><td style="text-align:left;">指定导出的集合</td></tr><tr><td style="text-align:left;">-o</td><td style="text-align:left;">导出的文件存储路径</td></tr><tr><td style="text-align:left;">-q</td><td style="text-align:left;">进行过滤</td></tr></tbody></table><h3 id="_2-1-准备数据" tabindex="-1"><a class="header-anchor" href="#_2-1-准备数据"><span>2.1 准备数据</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">use school<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> students <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    students<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zfpx&#39;</span><span class="token operator">+</span>i<span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span>i<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>students<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-备份记录" tabindex="-1"><a class="header-anchor" href="#_2-2-备份记录"><span>2.2 备份记录</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mongoexport <span class="token operator">-</span>h <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">--</span>port <span class="token number">50000</span>  <span class="token operator">-</span>d school <span class="token operator">-</span>c students <span class="token operator">-</span>o stu<span class="token punctuation">.</span>bak</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-3-删除记录" tabindex="-1"><a class="header-anchor" href="#_2-3-删除记录"><span>2.3 删除记录</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nRemoved&quot;</span> <span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-导入记录" tabindex="-1"><a class="header-anchor" href="#_2-4-导入记录"><span>2.4 导入记录</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mongoimport <span class="token operator">--</span>port <span class="token number">50000</span> <span class="token operator">--</span>db school <span class="token operator">--</span>collection students <span class="token operator">--</span>file</span>
<span class="line">stu<span class="token punctuation">.</span>bak</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-备份与恢复" tabindex="-1"><a class="header-anchor" href="#_3-备份与恢复"><span>3. 备份与恢复</span></a></h2><h3 id="_3-1-mongodump" tabindex="-1"><a class="header-anchor" href="#_3-1-mongodump"><span>3.1 mongodump</span></a></h3><p>在Mongodb中我们使用mongodump命令来备份MongoDB数据。该命令可以导出所有数据到指定目录中。</p><blockquote><p>mongodump -h dbhost -d dbname -o dbdirectory</p><ul><li>-h MongDB所在服务器地址，例如：127.0.0.1，当然也可以指定端口号：127.0.0.1:27017</li><li>-d 需要备份的数据库实例，例如：test</li><li>-o 备份的数据存放位置</li></ul></blockquote><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">mongodump  -d school -o data.dmp</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-2-mongorestore" tabindex="-1"><a class="header-anchor" href="#_3-2-mongorestore"><span>3.2 mongorestore</span></a></h3><p>mongodb使用 mongorestore 命令来恢复备份的数据。</p><ul><li>--host MongoDB所在服务器地址</li><li>--db -d 需要恢复的数据库实例</li><li><path>最后的一个参数，设置备份数据所在位置</path></li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">mongorestore  data.dmp</span>
<span class="line">mongorestore -d school data.bmp/school</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>Mongodump可以backup整个数据库，而mongoexport要对每个collection进行操作，最主要的区别也是选择的标准是mongoexport输出的JSON比Mongodump的BSON可读性更高，进而可以直接对JSON文件进行操作然后还原数据（BSON转换JSON存在潜在兼容问题）。</p></blockquote><h2 id="_4-直接拷贝数据" tabindex="-1"><a class="header-anchor" href="#_4-直接拷贝数据"><span>4. 直接拷贝数据</span></a></h2><h2 id="_5-锁定和解锁数据库" tabindex="-1"><a class="header-anchor" href="#_5-锁定和解锁数据库"><span>5. 锁定和解锁数据库</span></a></h2><p>为了数据的完整性和一致性，导出前要先锁定写入，导出后再解锁。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&gt;</span> use admin<span class="token punctuation">;</span></span>
<span class="line">switched to db admin</span>
<span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">fsync</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">lock</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;info&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;now locked against writes, use db.fsyncUnlock() to unlock&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;seeAlso&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;http://dochub.mongodb.org/core/fsynccommand&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;ok&quot;</span> <span class="token operator">:</span> <span class="token number">1</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">fsyncUnlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">{</span> <span class="token string-property property">&quot;ok&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;info&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;unlock completed&quot;</span> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-安全措施" tabindex="-1"><a class="header-anchor" href="#_6-安全措施"><span>6. 安全措施</span></a></h2><ul><li>物理隔离</li><li>网络隔离</li><li>防火墙(IP/IP段/白名单/黑名单)</li><li>用户名和密码验证</li></ul><h3 id="_6-1-用户管理" tabindex="-1"><a class="header-anchor" href="#_6-1-用户管理"><span>6.1 用户管理</span></a></h3><h3 id="_6-1-1-查看角色" tabindex="-1"><a class="header-anchor" href="#_6-1-1-查看角色"><span>6.1.1 查看角色</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">show roles;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>内置角色</p><ul><li>数据库用户角色：read、readWrite；</li><li>数据库管理角色：dbAdmin、dbOwner、userAdmin;</li><li>集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManage；</li><li>备份恢复角色：backup、restore；</li><li>所有数据库角色：readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase</li><li>超级用户角色：root</li><li>内部角色：__system</li></ul><h3 id="_6-1-2-老的创建用户的方法" tabindex="-1"><a class="header-anchor" href="#_6-1-2-老的创建用户的方法"><span>6.1.2 老的创建用户的方法</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">addUser</span><span class="token punctuation">(</span><span class="token string">&#39;zfpx&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;123456&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token constant">WARNING</span><span class="token operator">:</span> The <span class="token string">&#39;addUser&#39;</span> shell helper is <span class="token constant">DEPRECATED</span><span class="token punctuation">.</span> Please use <span class="token string">&#39;createUser&#39;</span> inste</span>
<span class="line">ad</span>
<span class="line">Successfully added user<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;user&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zfpx&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;roles&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;root&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span></span>
<span class="line">show roles<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-1-3-新的创建用户的方法" tabindex="-1"><a class="header-anchor" href="#_6-1-3-新的创建用户的方法"><span>6.1.3 新的创建用户的方法</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">db<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">user</span><span class="token operator">:</span><span class="token string">&quot;zfpx2&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">pwd</span><span class="token operator">:</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">roles</span><span class="token operator">:</span><span class="token punctuation">[</span></span>
<span class="line">        <span class="token punctuation">{</span></span>
<span class="line">            <span class="token literal-property property">role</span><span class="token operator">:</span><span class="token string">&quot;readWrite&quot;</span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token literal-property property">db</span><span class="token operator">:</span><span class="token string">&quot;school&quot;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;read&#39;</span></span>
<span class="line">   <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">user</span><span class="token operator">:</span><span class="token string">&#39;zfpx2&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">pwd</span><span class="token operator">:</span><span class="token string">&#39;123456&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">roles</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token literal-property property">role</span><span class="token operator">:</span><span class="token string">&#39;read&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">db</span><span class="token operator">:</span><span class="token string">&#39;school&#39;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">Successfully added user<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;user&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zfpx2&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;roles&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token string-property property">&quot;role&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;read&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                        <span class="token string-property property">&quot;db&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;school&quot;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-1-4-查看用户的权限" tabindex="-1"><a class="header-anchor" href="#_6-1-4-查看用户的权限"><span>6.1.4 查看用户的权限</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">usersInfo</span><span class="token operator">:</span><span class="token string">&#39;zfpx2&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">showPrivileges</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;users&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">                <span class="token punctuation">{</span></span>
<span class="line">                        <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;admin.zfpx2&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                        <span class="token string-property property">&quot;user&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zfpx2&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                        <span class="token string-property property">&quot;db&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                        <span class="token string-property property">&quot;roles&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">                                <span class="token punctuation">{</span></span>
<span class="line">                                        <span class="token string-property property">&quot;role&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;read&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                                        <span class="token string-property property">&quot;db&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;school&quot;</span></span>
<span class="line">                                <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-1-5-服务器启动权限认证" tabindex="-1"><a class="header-anchor" href="#_6-1-5-服务器启动权限认证"><span>6.1.5 服务器启动权限认证</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\mongo\\data</span>
<span class="line">logpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\mongo\\log</span>
<span class="line">port<span class="token operator">=</span><span class="token number">50000</span></span>
<span class="line">auth<span class="token operator">=</span><span class="token boolean">true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-1-6-用户登录和修改密码" tabindex="-1"><a class="header-anchor" href="#_6-1-6-用户登录和修改密码"><span>6.1.6 用户登录和修改密码</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">&gt; use admin;</span>
<span class="line">&gt; use admin;</span>
<span class="line">switched to db admin</span>
<span class="line">&gt; db.auth(&#39;zfpx&#39;,&#39;123456&#39;)</span>
<span class="line">1</span>
<span class="line">&gt; db.changeUserPassword(&#39;zfpx&#39;,&#39;123&#39;);</span>
<span class="line">&gt; db.auth(&#39;zfpx&#39;,&#39;123&#39;)</span>
<span class="line">1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-1-7-修改个人信息" tabindex="-1"><a class="header-anchor" href="#_6-1-7-修改个人信息"><span>6.1.7 修改个人信息</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">updateUser</span><span class="token operator">:</span><span class="token string">&#39;zfpx&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">pwd</span><span class="token operator">:</span><span class="token string">&#39;123&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">customData</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;珠峰培训&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">email</span><span class="token operator">:</span><span class="token string">&#39;zfpx@126.com&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">usersInfo</span><span class="token operator">:</span><span class="token string">&#39;zfpx&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">showPrivileges</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>用户的操作都需要在admin数据库下面进行操作</li><li>如果在某个数据库下面执行操作，那么只对当前数据库生效</li><li>addUser已经废弃，默认会创建root用户，不安全，不再建议使用</li></ul><h2 id="_7-数据库高级命令" tabindex="-1"><a class="header-anchor" href="#_7-数据库高级命令"><span>7. 数据库高级命令</span></a></h2><h3 id="_7-1-准备数据" tabindex="-1"><a class="header-anchor" href="#_7-1-准备数据"><span>7.1 准备数据</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> students <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zfpx1&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">home</span><span class="token operator">:</span><span class="token string">&#39;北京&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zfpx2&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">home</span><span class="token operator">:</span><span class="token string">&#39;北京&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zfpx3&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">home</span><span class="token operator">:</span><span class="token string">&#39;北京&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zfpx4&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">home</span><span class="token operator">:</span><span class="token string">&#39;广东&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zfpx5&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">home</span><span class="token operator">:</span><span class="token string">&#39;广东&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zfpx6&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">home</span><span class="token operator">:</span><span class="token string">&#39;广东&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line">db<span class="token punctuation">.</span>students<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>students<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-2-count" tabindex="-1"><a class="header-anchor" href="#_7-2-count"><span>7.2 count</span></a></h3><p>查看记录数</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">db.students.find().count();</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_7-2-查找不重复的值-distinct" tabindex="-1"><a class="header-anchor" href="#_7-2-查找不重复的值-distinct"><span>7.2 查找不重复的值 distinct</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">distinct</span><span class="token operator">:</span><span class="token string">&#39;students&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">key</span><span class="token operator">:</span><span class="token string">&#39;home&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">[</span> <span class="token string">&quot;北京&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;广东&quot;</span> <span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-3-group-分组" tabindex="-1"><a class="header-anchor" href="#_7-3-group-分组"><span>7.3 group 分组</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">db.runCommand({</span>
<span class="line">        group:{</span>
<span class="line">                ns:集合名称，</span>
<span class="line">                key:分组的键,</span>
<span class="line">                initial:初始值,</span>
<span class="line">                $reduce:分解器</span>
<span class="line">                condition:条件,</span>
<span class="line">                finalize:完成时的处理器</span>
<span class="line">        }</span>
<span class="line">});</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-3-1-按城市分组-求每个城市里符合条件的人的年龄总和" tabindex="-1"><a class="header-anchor" href="#_7-3-1-按城市分组-求每个城市里符合条件的人的年龄总和"><span>7.3.1 按城市分组，求每个城市里符合条件的人的年龄总和</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">group</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="line">                <span class="token literal-property property">ns</span><span class="token operator">:</span><span class="token string">&#39;students&#39;</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token literal-property property">key</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">home</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token literal-property property">initial</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">total</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token function-variable function">$reduce</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">doc<span class="token punctuation">,</span>result</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                      result<span class="token punctuation">.</span>total <span class="token operator">+=</span> doc<span class="token punctuation">.</span>age<span class="token punctuation">;</span>   </span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token literal-property property">condition</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$gt</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token function-variable function">finalize</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">                    result<span class="token punctuation">.</span>desc <span class="token operator">=</span> <span class="token string">&#39;本城市的总年龄为&#39;</span><span class="token operator">+</span>result<span class="token punctuation">.</span>total<span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-4-删除集合" tabindex="-1"><a class="header-anchor" href="#_7-4-删除集合"><span>7.4 删除集合</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">drop</span><span class="token operator">:</span><span class="token string">&#39;students&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_7-5-runcommand常用命令" tabindex="-1"><a class="header-anchor" href="#_7-5-runcommand常用命令"><span>7.5 runCommand常用命令</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">buildInfo</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">getLastError</span><span class="token operator">:</span><span class="token string">&quot;students&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span>persons<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span>persons<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">getLastError</span><span class="token operator">:</span><span class="token string">&quot;students&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_8-什么固定集合" tabindex="-1"><a class="header-anchor" href="#_8-什么固定集合"><span>8. 什么固定集合</span></a></h2><p>MongoDB 固定集合（Capped Collections）是性能出色且有着固定大小的集合，对于大小固定，我们可以想象其就像一个环形队列，当集合空间用完后，再插入的元素就会覆盖最初始的头部的元素！ <img src="http://img.zhufengpeixun.cn/firstinfirstout.png" alt="firstinfirstout"></p><h3 id="_8-1-特性" tabindex="-1"><a class="header-anchor" href="#_8-1-特性"><span>8.1 特性</span></a></h3><ul><li><ol><li>没有索引</li></ol></li><li><ol start="2"><li>插入和查询速度速度非常快 不需要重新分配空间</li></ol></li><li><ol start="3"><li>特别适合存储日志</li></ol></li></ul><h3 id="_8-2-创建固定集合" tabindex="-1"><a class="header-anchor" href="#_8-2-创建固定集合"><span>8.2 创建固定集合</span></a></h3><ul><li>我们通过createCollection来创建一个固定集合，且capped选项设置为true：</li><li>还可以指定文档个数,加上max:1000属性：</li><li>判断集合是否为固定集合: db.logs.isCapped()</li><li>size 是整个集合空间大小，单位为【KB】</li><li>max 是集合文档个数上线，单位是【个】</li><li>如果空间大小到达上限，则插入下一个文档时，会覆盖第一个文档；如果文档个数到达上限，同样插入下一个文档时，会覆盖第一个文档。两个参数上限判断取的是【与】的逻辑。</li><li>capped 封顶的</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> db<span class="token punctuation">.</span><span class="token function">createCollection</span><span class="token punctuation">(</span><span class="token string">&#39;logs&#39;</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">size</span><span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token literal-property property">max</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token literal-property property">capped</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_8-3-非固定集合转为固定集合" tabindex="-1"><a class="header-anchor" href="#_8-3-非固定集合转为固定集合"><span>8.3 非固定集合转为固定集合</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">convertToCapped</span><span class="token operator">:</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span><span class="token literal-property property">size</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_9-gridfs" tabindex="-1"><a class="header-anchor" href="#_9-gridfs"><span>9. gridfs</span></a></h2><ul><li>gridfs是mongodb自带的文件系统，使用二进制存储文件。</li><li>mongodb可以以BSON格式保存二进制对象。</li><li>但是BSON对象的体积不能超过4M。所以mongodb提供了<code>mongofiles</code>。它可以把一个大文件透明地分割成小文件（256K），从而保存大体积的数据。</li><li>GridFS 用于存储和恢复那些超过16M（BSON文件限制）的文件(如：图片、音频、视频等)。</li><li>GridFS 用两个集合来存储一个文件：fs.files与fs.chunks。</li><li>每个文件的实际内容被存在chunks(二进制数据)中,和文件有关的meta数据(filename,content_type,还有用户自定义的属性)将会被存在files集合中。</li><li><h3 id="_9-1-上传一个文件" tabindex="-1"><a class="header-anchor" href="#_9-1-上传一个文件"><span>9.1 上传一个文件</span></a></h3></li><li>-d 数据库的名称</li><li>-l 源文件的位置</li><li>put 指定文件名</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">mongofiles -d myfiles put test.txt</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_9-2-获取并下载文件" tabindex="-1"><a class="header-anchor" href="#_9-2-获取并下载文件"><span>9.2 获取并下载文件</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mongofiles <span class="token operator">-</span>d myfiles  <span class="token keyword">get</span> <span class="token string">&#39;test.txt&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_9-3-查看所有文件" tabindex="-1"><a class="header-anchor" href="#_9-3-查看所有文件"><span>9.3 查看所有文件</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mongofiles <span class="token operator">-</span>d myfiles  list</span>
<span class="line"><span class="token operator">&gt;</span>db<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token operator">&gt;</span>db<span class="token punctuation">.</span>fs<span class="token punctuation">.</span>chunks<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">files_id</span><span class="token operator">:</span><span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-4-删除文件" tabindex="-1"><a class="header-anchor" href="#_9-4-删除文件"><span>9.4 删除文件</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mongofiles <span class="token operator">-</span>d myfiles <span class="token keyword">delete</span> <span class="token string">&quot;test.txt&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_9-5-eval-服务器端脚本" tabindex="-1"><a class="header-anchor" href="#_9-5-eval-服务器端脚本"><span>9.5 eval 服务器端脚本</span></a></h3><ul><li>执行JS语句</li><li>定义JS全局变量</li><li>定义函数</li><li>Stored JavaScript</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">db<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;1+1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;return &#39;hello&#39;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span>system<span class="token punctuation">.</span>js<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">,</span><span class="token literal-property property">value</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;return x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span>system<span class="token punctuation">.</span>js<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token string">&quot;say&quot;</span><span class="token punctuation">,</span><span class="token function-variable function">value</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token string">&#39;hello&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;say()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,92)])])}const c=n(e,[["render",l]]),r=JSON.parse('{"path":"/strong/29.mongodb-2.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/29.mongodb-2.md"}');export{c as comp,r as data};
