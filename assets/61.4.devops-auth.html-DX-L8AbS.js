import{_ as a,c as n,a as e,o as l}from"./app-CD1YpnS1.js";const i={};function t(p,s){return l(),n("div",null,[...s[0]||(s[0]=[e(`<h2 id="_1-文件权限" tabindex="-1"><a class="header-anchor" href="#_1-文件权限"><span>1. 文件权限</span></a></h2><h3 id="_1-1-文件基本权限" tabindex="-1"><a class="header-anchor" href="#_1-1-文件基本权限"><span>1.1 文件基本权限</span></a></h3><p><code>-rw-r--r--</code></p><ul><li>文件类型 <ul><li><code>-</code> 文件</li><li><code>d</code> 目录</li><li><code>l</code> 软链接文件</li></ul></li><li>所有者 所属组 其它人</li><li>r读 w写 x执行</li></ul><h3 id="_1-2-基本权限的修改" tabindex="-1"><a class="header-anchor" href="#_1-2-基本权限的修改"><span>1.2 基本权限的修改</span></a></h3><p>chmod [选项] 模式 文件名</p><ul><li>选项 <ul><li><code>-R</code> 递归</li></ul></li><li>模式 <ul><li>[ugoa][+-=][rwx]</li></ul></li><li>权限数字 <ul><li>r 4</li><li>w 2</li><li>x 1</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">000</span> <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line">chmod u<span class="token operator">+</span>w <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line">chmod g<span class="token operator">+</span>x <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line">chmod o<span class="token operator">+</span>r <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line"></span>
<span class="line">chmod g<span class="token operator">+</span>x<span class="token punctuation">,</span>o<span class="token operator">+</span>x <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line"></span>
<span class="line">chmod u<span class="token operator">-</span>w <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line"></span>
<span class="line">chmod u<span class="token operator">=</span>rwx <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line"></span>
<span class="line">chmod <span class="token number">777</span> <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-3-权限的作用" tabindex="-1"><a class="header-anchor" href="#_1-3-权限的作用"><span>1.3 权限的作用</span></a></h3><ul><li>对文件来说最高权限是<code>x</code></li><li>对目录来讲最高权限是<code>w</code>,只有读权限没有意义，对目录有了写权限，里面可以做任何事情</li></ul><h4 id="_1-3-1-文件权限" tabindex="-1"><a class="header-anchor" href="#_1-3-1-文件权限"><span>1.3.1 文件权限</span></a></h4><table><thead><tr><th style="text-align:left;">权限</th><th style="text-align:left;">含义</th><th style="text-align:left;">示例</th></tr></thead><tbody><tr><td style="text-align:left;">r</td><td style="text-align:left;">读取文件内容</td><td style="text-align:left;">cat more head tail</td></tr><tr><td style="text-align:left;">w</td><td style="text-align:left;">编辑、新增、修改文件内容,不能删除文件,除非对目录有写权限</td><td style="text-align:left;">vi echo</td></tr><tr><td style="text-align:left;">x</td><td style="text-align:left;">可执行</td><td style="text-align:left;"></td></tr></tbody></table><h4 id="_1-3-2-目录权限" tabindex="-1"><a class="header-anchor" href="#_1-3-2-目录权限"><span>1.3.2 目录权限</span></a></h4><table><thead><tr><th style="text-align:left;">权限</th><th style="text-align:left;">含义</th><th style="text-align:left;">示例</th></tr></thead><tbody><tr><td style="text-align:left;">r</td><td style="text-align:left;">可以查看目录下的文件名</td><td style="text-align:left;">ls</td></tr><tr><td style="text-align:left;">w</td><td style="text-align:left;">具有修改目录结构的权限。如新建、删除和重命名此目录下的文件和目录</td><td style="text-align:left;">touch rm mv cp</td></tr><tr><td style="text-align:left;">x</td><td style="text-align:left;">进入目录</td><td style="text-align:left;">cd</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">useradd zf1</span>
<span class="line">passwd zf1</span>
<span class="line"></span>
<span class="line">cd <span class="token operator">/</span>home<span class="token operator">/</span>zf1</span>
<span class="line">mkdir folder</span>
<span class="line">touch folder<span class="token operator">/</span><span class="token number">1</span><span class="token punctuation">.</span>txt 默认<span class="token number">755</span></span>
<span class="line">chmod <span class="token number">750</span> folder </span>
<span class="line">chmod <span class="token number">640</span> folder<span class="token operator">/</span><span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line">chmod <span class="token number">754</span> folder </span>
<span class="line">chmod <span class="token number">755</span> folder  </span>
<span class="line">chmod <span class="token number">644</span> folder<span class="token operator">/</span><span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line">chmod <span class="token number">646</span> folder<span class="token operator">/</span><span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line">chmod <span class="token number">757</span> folder</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-1-3-其它权限命令" tabindex="-1"><a class="header-anchor" href="#_1-1-3-其它权限命令"><span>1.1.3 其它权限命令</span></a></h4><h5 id="_1-1-3-1-chown" tabindex="-1"><a class="header-anchor" href="#_1-1-3-1-chown"><span>1.1.3.1 chown</span></a></h5><ul><li>chown 用户名 文件名</li><li>如果想让一个用户拥有7权限，可以把这个文件的所有者改成这个用户名<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">755</span> folder</span>
<span class="line">chown zf1 folder</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h5 id="_1-1-3-2-chgrp" tabindex="-1"><a class="header-anchor" href="#_1-1-3-2-chgrp"><span>1.1.3.2 chgrp</span></a></h5><ul><li>chgrp 组名 文件名</li><li>创建用户名的时候会为它创建一个所属组</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">chgrp zf1 folder</span>
<span class="line">chown root:root folder</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-默认权限" tabindex="-1"><a class="header-anchor" href="#_2-默认权限"><span>2.默认权限</span></a></h2><h3 id="_2-1-umask" tabindex="-1"><a class="header-anchor" href="#_2-1-umask"><span>2.1 umask</span></a></h3><ul><li>查看默认权限</li><li>0022 <ul><li>第一位0 文件特殊权限</li><li>022 文件默认权限</li></ul></li></ul><h3 id="_2-2-文件权限" tabindex="-1"><a class="header-anchor" href="#_2-2-文件权限"><span>2.2 文件权限</span></a></h3><ul><li>默认权限就是文件一创建后就拥有的权限</li><li>文件默认不能建立可执行文件，必须手工赋予执行权限</li><li>文件默认权限最大为<code>666</code></li><li>默认权限需要换算成字母再相减</li><li>建立文件之后的默认权限，为666减去umask值</li></ul><p>666 - 022 = 744</p><h3 id="_2-3-目录" tabindex="-1"><a class="header-anchor" href="#_2-3-目录"><span>2.3 目录</span></a></h3><ul><li>目录默认权限最大为777</li><li>建立目录之后的默认权限，为777减去umask值</li></ul><p>777 - 022 = 755</p><h3 id="_2-4-修改umask值" tabindex="-1"><a class="header-anchor" href="#_2-4-修改umask值"><span>2.4 修改umask值</span></a></h3><p>临时修改</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">umask <span class="token number">0002</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>永久修改</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">vi /etc/profile</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_3-acl" tabindex="-1"><a class="header-anchor" href="#_3-acl"><span>3. ACL</span></a></h2><ul><li>一个文件或文件夹只能有一个所有者和所属组，无法适应某些应用场景</li><li>访问控制(Access Control List，ACL)就是为特定的用户和组分配特定权限</li></ul><h3 id="_3-1-查看分区acl权限是否开启" tabindex="-1"><a class="header-anchor" href="#_3-1-查看分区acl权限是否开启"><span>3.1 查看分区ACL权限是否开启</span></a></h3><ul><li>dumpe2fs 命令是查询指定分区详细文件系统信息的命令 <ul><li>-h 仅显示块中的信息，而不显示磁盘块组的详细信息</li></ul></li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">dumpe2fs -h /dev/sda1</span>
<span class="line"></span>
<span class="line">Default mount options:    user_xattr acl</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-1-1-临时开启分区的acl权限" tabindex="-1"><a class="header-anchor" href="#_3-1-1-临时开启分区的acl权限"><span>3.1.1 临时开启分区的ACL权限</span></a></h4><p>重新挂载根分区，并挂载加入ACL权限</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">mount -o remount,acl /dev/sda1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-1-2-永久开启分区的acl权限" tabindex="-1"><a class="header-anchor" href="#_3-1-2-永久开启分区的acl权限"><span>3.1.2 永久开启分区的ACL权限</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">vi <span class="token operator">/</span>etc<span class="token operator">/</span>fstab</span>
<span class="line"><span class="token constant">UUID</span> <span class="token operator">/</span>  ext4 defaults<span class="token punctuation">,</span>acl  <span class="token number">1</span> <span class="token number">1</span></span>
<span class="line">mount <span class="token operator">-</span>o remount <span class="token operator">/</span>dev<span class="token operator">/</span>sda1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-读写acl权限" tabindex="-1"><a class="header-anchor" href="#_3-2-读写acl权限"><span>3.2 读写ACL权限</span></a></h3><h4 id="_3-2-1-setfacl" tabindex="-1"><a class="header-anchor" href="#_3-2-1-setfacl"><span>3.2.1 setfacl</span></a></h4><ul><li><code>setfacl 选项 文件名</code></li></ul><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-m</td><td style="text-align:left;">设定ACL权限</td></tr><tr><td style="text-align:left;">-x</td><td style="text-align:left;">删除指定的ACL权限</td></tr><tr><td style="text-align:left;">-b</td><td style="text-align:left;">删除所有的ACL权限</td></tr><tr><td style="text-align:left;">-d</td><td style="text-align:left;">设定默认ACL权限</td></tr><tr><td style="text-align:left;">-k</td><td style="text-align:left;">删除默认的ACL权限</td></tr><tr><td style="text-align:left;">-R</td><td style="text-align:left;">递归设定ACL权限</td></tr></tbody></table><h4 id="_3-2-2-setfacl" tabindex="-1"><a class="header-anchor" href="#_3-2-2-setfacl"><span>3.2.2 setfacl</span></a></h4><ul><li>给用户<code>guest</code>赋予rx权限</li><li>格式 &quot;u:用户名:权限&quot;<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">useradd guest</span>
<span class="line">mkdir <span class="token operator">/</span>home<span class="token operator">/</span>guest<span class="token operator">/</span>folder</span>
<span class="line">useradd teacher</span>
<span class="line">groupadd students</span>
<span class="line">mkdir folder</span>
<span class="line">chown teacher<span class="token operator">:</span>students <span class="token operator">/</span>home<span class="token operator">/</span>guest<span class="token operator">/</span>folder</span>
<span class="line">chmod <span class="token number">770</span> <span class="token operator">/</span>home<span class="token operator">/</span>guest<span class="token operator">/</span>folder</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_3-2-2-设置最大权限" tabindex="-1"><a class="header-anchor" href="#_3-2-2-设置最大权限"><span>3.2.2 设置最大权限</span></a></h4><ul><li>mask是最大有效权限，如果给用户赋予了ACL权限，是需要和mask的权限做与运算后才能得到真正权限</li><li>如果mask值是777，那么任何数与它相与，得到的是权限本身</li><li>如果允许自定义ACL，又不想让它超出最大权限</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">setfacl -m m:r folder</span>
<span class="line"> [root@localhost someone]</span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line">user::rwx</span>
<span class="line"> user:someone:r-x        </span>
<span class="line"> group::rwx            </span>
<span class="line">mask::r--</span>
<span class="line">other::---</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-3-删除acl权限" tabindex="-1"><a class="header-anchor" href="#_3-2-3-删除acl权限"><span>3.2.3 删除ACL权限</span></a></h4><h5 id="_3-2-3-1-删除指定用户的acl权限" tabindex="-1"><a class="header-anchor" href="#_3-2-3-1-删除指定用户的acl权限"><span>3.2.3.1 删除指定用户的ACL权限</span></a></h5><p><code>setfacl -x u:用户名 文件名</code></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">setfacl -x u:someone folder</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="_3-2-3-2-删除文件所有用户的acl权限" tabindex="-1"><a class="header-anchor" href="#_3-2-3-2-删除文件所有用户的acl权限"><span>3.2.3.2 删除文件所有用户的ACL权限</span></a></h5><p><code>setfacl -b 文件名</code></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">setfacl -b folder</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="_3-2-3-3-删除指定用户组的acl权限" tabindex="-1"><a class="header-anchor" href="#_3-2-3-3-删除指定用户组的acl权限"><span>3.2.3.3 删除指定用户组的ACL权限</span></a></h5><p><code>setfacl -x g:组名 文件名</code></p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">setfacl -x g:students folder</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-2-4-递归权限" tabindex="-1"><a class="header-anchor" href="#_3-2-4-递归权限"><span>3.2.4 递归权限</span></a></h4><ul><li>向下一级一级传递权限</li><li>父目录设定ACL权限的时候，所有的子文件和子目录也会拥有相同的ACL权限</li><li>递归仅能赋给目录不能赋给文件</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">setfacl -m u:someone:rx folder</span>
<span class="line">setfacl -m u:someone:rx -R folder</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-5-默认权限" tabindex="-1"><a class="header-anchor" href="#_3-2-5-默认权限"><span>3.2.5 默认权限</span></a></h4><ul><li>默认ACL权限是指如果给父目录设置了默认ACL权限，那么父目录里所有新建的子文件都会继承父目录的ACL权限</li><li>setfacl -m d:u:用户名:权限 目录名</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">setfacl -m d:u:someone:rw folder</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_4-sudo权限" tabindex="-1"><a class="header-anchor" href="#_4-sudo权限"><span>4. sudo权限</span></a></h2><ul><li>root把本来只有超级管理员可以使用的命令赋予普通用户来使用</li><li>sudo操作的对象是系统命令</li></ul><h3 id="_4-1-visudo" tabindex="-1"><a class="header-anchor" href="#_4-1-visudo"><span>4.1 visudo</span></a></h3><ul><li>通过<code>visudo</code>可以由超级用户赋权</li><li>实际修改的是<code>/etc/sudoers</code>文件</li><li>命令必须写绝对路径</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">root    <span class="token constant">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token constant">ALL</span><span class="token punctuation">)</span> <span class="token constant">ALL</span></span>
<span class="line">用户名 被管理主机地址<span class="token operator">=</span><span class="token punctuation">(</span>可使用的身份<span class="token punctuation">)</span> <span class="token function">授权命令</span><span class="token punctuation">(</span>绝对路径<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">somethone <span class="token constant">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token operator">/</span>usr<span class="token operator">/</span>sbin<span class="token operator">/</span>useradd         <span class="token comment">//新增加用户行</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">%wheel ALL=(ALL) ALL</span>
<span class="line">%组名 被管理主机地址(IP)=(可使用的身份) 授权命令(绝对路径)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">sudo -l  查看目前的sudo权限</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-特殊权限" tabindex="-1"><a class="header-anchor" href="#_6-特殊权限"><span>6. 特殊权限</span></a></h2><h3 id="_6-1-setuid" tabindex="-1"><a class="header-anchor" href="#_6-1-setuid"><span>6.1 SetUID</span></a></h3><ul><li><code>set User ID</code></li><li>只有可以执行的二进制程序才能设置SUID权限</li><li>命令执行者要对该程序有x(执行)权限</li><li>命令执行者在执行该程序的时候身份会变成文件的所有者</li><li>SetUID权限只在该程序执行过程中有效，也就是说身份改变在程序执行过程中有效</li><li>文件属主的x权限,用s代替.表示被设置了SUID,如果属主位没有x权限,会显示为大写S,表示有故障(权限无效)</li></ul><p>字母表示法</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">chmod u+s 文件</span>
<span class="line">chmod u-s 文件</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>数字表示法,在普通三位数字权限位之前,用4代表添加的SUID位 <code>chmod 4755 文件</code> 添加<code>SUID</code>权限到二进制程序文件(添加到目录无意义)</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">4755</span> 文件</span>
<span class="line">chmod 0xxx 可以删除文件的 <span class="token constant">SUID</span><span class="token punctuation">(</span>无法删除目录的<span class="token constant">SUID</span><span class="token punctuation">)</span>  </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">4755</span> hello<span class="token punctuation">.</span>sh</span>
<span class="line"></span>
<span class="line">ll <span class="token operator">/</span>etc<span class="token operator">/</span>shadow</span>
<span class="line">ll <span class="token operator">/</span>user<span class="token operator">/</span>bin<span class="token operator">/</span>passwd</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-1-1-设置suid" tabindex="-1"><a class="header-anchor" href="#_6-1-1-设置suid"><span>6.1.1 设置SUID</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">4755</span> 文件名</span>
<span class="line">chmod u<span class="token operator">+</span>s 文件名 给所有者加suid权限</span>
<span class="line">chmod g<span class="token operator">+</span>s 文件名 给所属组加suid权限</span>
<span class="line">chmod o<span class="token operator">+</span>s 文件名 给其它人加suid权限</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-1-2-取消suid" tabindex="-1"><a class="header-anchor" href="#_6-1-2-取消suid"><span>6.1.2 取消SUID</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">0755</span> 文件名</span>
<span class="line">chmod u<span class="token operator">-</span>x 文件名 给所有者减去suid权限</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-1-3-安全设置" tabindex="-1"><a class="header-anchor" href="#_6-1-3-安全设置"><span>6.1.3 安全设置</span></a></h4><ul><li>关键目录应该严格控制写权限</li><li>用户的密码要正确设置</li><li>不能轻易给文件赋SetUID权限</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">4755</span> <span class="token operator">/</span>bin<span class="token operator">/</span>vi</span>
<span class="line"><span class="token operator">/</span>bin<span class="token operator">/</span>vi <span class="token operator">/</span>etc<span class="token operator">/</span>shadow</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-2-setgid" tabindex="-1"><a class="header-anchor" href="#_6-2-setgid"><span>6.2 SetGID</span></a></h3><p>Set Group ID</p><h4 id="_6-2-1-设置方法" tabindex="-1"><a class="header-anchor" href="#_6-2-1-设置方法"><span>6.2.1 设置方法</span></a></h4><p>字母表示法</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">chmod g+s 文件</span>
<span class="line"></span>
<span class="line">chmod g-s 文件</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>数字表示法</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">2755</span>  文件<span class="token operator">/</span>目录 添加<span class="token constant">SGID</span>到目录或文件</span>
<span class="line">在普通数字权限位前<span class="token punctuation">,</span>用<span class="token number">2</span>代表添加<span class="token constant">SGID</span>位</span>
<span class="line">chmod <span class="token number">0755</span> 文件<span class="token operator">/</span>目录 删除文件的<span class="token constant">SGID</span><span class="token punctuation">,</span><span class="token punctuation">(</span>目录不受影响<span class="token punctuation">)</span></span>
<span class="line">chmod <span class="token number">755</span> 文件<span class="token operator">/</span>目录 同上 </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-2-2-作用目标" tabindex="-1"><a class="header-anchor" href="#_6-2-2-作用目标"><span>6.2.2 作用目标</span></a></h4><h5 id="_6-2-2-1-针对文件" tabindex="-1"><a class="header-anchor" href="#_6-2-2-1-针对文件"><span>6.2.2.1 针对文件</span></a></h5><ul><li>只有可执行的二进制程序才能设置SGID权限</li><li>命令执行者要对该程序拥有x(执行)权限</li><li>命令执行在执行程序的时候，执行者的组身份升级为该程序文件的所属组</li><li><code>set</code>GID权限同样只在该程序执行过程中有效，也就是说组身份改变只在程序执行过程中有效</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">4755</span> <span class="token operator">/</span>bin<span class="token operator">/</span>cat</span>
<span class="line">chmod <span class="token number">0755</span> <span class="token operator">/</span>bin<span class="token operator">/</span>cat</span>
<span class="line">chmod u<span class="token operator">+</span>s <span class="token operator">/</span>bin<span class="token operator">/</span>cat</span>
<span class="line">chmod u<span class="token operator">-</span>s <span class="token operator">/</span>bin<span class="token operator">/</span>cat</span>
<span class="line"></span>
<span class="line">cat <span class="token operator">/</span>root<span class="token operator">/</span>uid<span class="token punctuation">.</span>txt</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>因为 /usr/bin/locate是可执行二进制程序，可以赋予SGID</li><li>执行用户对 /usr/bin/locate 命令拥有执行权限</li><li>执行 /usr/bin/locate 命令时组身份会升级为slocate组，而slocate组对/var/lib/mlocate/mlocate.db文件拥有读权限，所以普通用户也可以使用locate命令</li><li>当命令执行结束，普通用户的组身份切换回自己的组身份</li></ul><h5 id="_6-2-2-2-针对目录" tabindex="-1"><a class="header-anchor" href="#_6-2-2-2-针对目录"><span>6.2.2.2 针对目录</span></a></h5><ul><li>可以针对文件或者目录设置GID权限</li><li>普通用户必须对此目录拥有<code>r</code>和<code>x</code>权限，才能进入此目录</li><li>普通用户在此目录中的组会变成此目录的所属组</li><li>如果普通用户对此目录拥有<code>w</code>权限时，新建的文件的默认属组是这个目录的所属组</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mkdir test3</span>
<span class="line"><span class="token comment">//设置SetGID</span></span>
<span class="line">chmod <span class="token number">2755</span> test3</span>
<span class="line">chmod g<span class="token operator">+</span>s test3</span>
<span class="line">ll <span class="token operator">-</span>d test3</span>
<span class="line">chmod <span class="token number">777</span> test3</span>
<span class="line"></span>
<span class="line">touch <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line">ll <span class="token operator">-</span>h <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line"></span>
<span class="line">取消 SetGID</span>
<span class="line">chmod <span class="token number">0755</span>  文件名</span>
<span class="line">chmod g<span class="token operator">-</span>s 文件名</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-3-sticky-bit" tabindex="-1"><a class="header-anchor" href="#_6-3-sticky-bit"><span>6.3 Sticky BIT</span></a></h3><ul><li>粘着位目前只针对目录有效</li><li>普通用户对该目录拥有w和x权限，即普通用户可以在此目录拥有写入权限</li><li>如果没有粘着位，因为普通用户拥有w权限，所以可以删除此目录下的所有文件，包括其它用户的文件。但一旦赋予了粘着位，除了root之外，普通用户就算拥有了w权限，也只能删除自己建立的文件，不能删除其它用户的文件</li><li>必须给其它人赋完整权限</li></ul><h4 id="_6-3-1-设置和取消" tabindex="-1"><a class="header-anchor" href="#_6-3-1-设置和取消"><span>6.3.1 设置和取消</span></a></h4><h5 id="_6-3-1-1-设置sticky" tabindex="-1"><a class="header-anchor" href="#_6-3-1-1-设置sticky"><span>6.3.1.1 设置Sticky</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">1755</span>  目录名</span>
<span class="line">chmod o<span class="token operator">+</span>t 目录名</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_6-3-1-2-取消sticky" tabindex="-1"><a class="header-anchor" href="#_6-3-1-2-取消sticky"><span>6.3.1.2 取消Sticky</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">chmod <span class="token number">0755</span>  目录名</span>
<span class="line">chmod o<span class="token operator">-</span>t 目录名</span>
<span class="line"></span>
<span class="line">ll <span class="token operator">-</span>d <span class="token operator">/</span>tmp</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-4-不可改变位权限" tabindex="-1"><a class="header-anchor" href="#_6-4-不可改变位权限"><span>6.4 不可改变位权限</span></a></h3><ul><li>chattr [+-=] [选项] 文件或目录名</li></ul><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">文件</th><th style="text-align:left;">目录</th></tr></thead><tbody><tr><td style="text-align:left;">+i</td><td style="text-align:left;">不允许对文件进行删除、改名，也不能添加和修改数据</td><td style="text-align:left;">只能修改目录下文件的数据，但不允许建立和删除文件</td></tr><tr><td style="text-align:left;">+a</td><td style="text-align:left;">只能在文件中增加属性，但不能删除也不能修改数据</td><td style="text-align:left;">只允许在目录中建立和修改文件，不能删除</td></tr></tbody></table><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">chattr +i folder</span>
<span class="line">lsattr folder</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div>`,118)])])}const c=a(i,[["render",t]]),r=JSON.parse('{"path":"/strong/61.4.devops-auth.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/61.4.devops-auth.md"}');export{c as comp,r as data};
