import{_ as s,c as a,a as p,o as t}from"./app-CD1YpnS1.js";const e={};function o(l,n){return t(),a("div",null,[...n[0]||(n[0]=[p(`<h2 id="_1-react-transition-group" tabindex="-1"><a class="header-anchor" href="#_1-react-transition-group"><span>1. react-transition-group</span></a></h2><ul><li>React官方提供了<a href="http://reactcommunity.org/react-transition-group/" target="_blank" rel="noopener noreferrer">react-transition-group</a>给一个组件的显示和消失添加过渡动画</li><li>提供了用于定义进入和退出转换的简单组件</li></ul><h3 id="_1-1-主要组件" tabindex="-1"><a class="header-anchor" href="#_1-1-主要组件"><span>1.1 主要组件</span></a></h3><table><thead><tr><th style="text-align:left;">组件</th><th style="text-align:left;">介绍</th></tr></thead><tbody><tr><td style="text-align:left;">Transition</td><td style="text-align:left;">该组件与平台⽆关(不⼀定要结合CSS)</td></tr><tr><td style="text-align:left;">CSSTransition</td><td style="text-align:left;">结合CSS，比较常⽤</td></tr><tr><td style="text-align:left;">SwitchTransition</td><td style="text-align:left;">两个组件显⽰和隐藏切换时使⽤该组件</td></tr><tr><td style="text-align:left;">TransitionGroup</td><td style="text-align:left;">将多个动画组件包裹在其中，⼀般⽤于列表中元素的动画</td></tr></tbody></table><h3 id="_1-2-安装" tabindex="-1"><a class="header-anchor" href="#_1-2-安装"><span>1.2 安装</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">npm install react-transition-group react-bootstrap bootstrap --save</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_2-transition" tabindex="-1"><a class="header-anchor" href="#_2-transition"><span>2. Transition</span></a></h2><ul><li><a href="http://reactcommunity.org/react-transition-group/transition" target="_blank" rel="noopener noreferrer">Transition</a>组件允许您使用简单的声明式 API描述随时间从一个组件状态到另一个组件状态的转换</li><li>默认情况下，<code>Transition</code>组件不会改变它呈现的组件的行为，它只跟踪组件的<code>进入</code>和<code>退出</code>状态。赋予这些状态以意义和效果取决于您</li><li>转换可以处于<code>4</code>种主要状态 <ul><li><code>entering</code> 进入中</li><li><code>entered</code> 进入后</li><li><code>exiting</code> 离开中</li><li><code>exited</code> 离开后</li></ul></li><li>过渡状态通过<code>in</code>属性切换。当为<code>true</code>时组件开始<code>进入</code>阶段。在此阶段，组件将从其当前的过渡状态转移到<code>entering</code>过渡期间，然后在<code>entered</code>完成后进入该阶段</li><li><code>in</code>改为<code>false</code>进行同样的事情，状态从移动<code>exiting</code>到<code>exited</code></li></ul><h3 id="_2-1-属性" tabindex="-1"><a class="header-anchor" href="#_2-1-属性"><span>2.1 属性</span></a></h3><table><thead><tr><th style="text-align:left;">属性名</th><th style="text-align:left;">类型</th><th style="text-align:left;">默认</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">in</td><td style="text-align:left;">boolean</td><td style="text-align:left;">false</td><td style="text-align:left;">显示组件；触发进入或退出状态</td></tr><tr><td style="text-align:left;">children</td><td style="text-align:left;">Function或element</td><td style="text-align:left;">必需</td><td style="text-align:left;">function可以使用子元素代替 React 元素。此函数使用当前转换状态(entering, entered, exiting,exited)调用,可用于将特定于上下文的属性应用于组件</td></tr><tr><td style="text-align:left;">timeout</td><td style="text-align:left;">number</td><td style="text-align:left;">无</td><td style="text-align:left;">过渡的持续时间，以毫秒为单位</td></tr></tbody></table><h3 id="_2-2-实现原理" tabindex="-1"><a class="header-anchor" href="#_2-2-实现原理"><span>2.2 实现原理</span></a></h3><ul><li>我们可以向<code>Transition</code>传递<code>in</code>和<code>timeout</code>属性，通过<code>in</code>来控制组件是否显示，通过<code>timeout</code>来控制显示或消失的时间间隔</li><li><code>Transition</code>会自动帮我们管理过渡状态(entering, entered, exiting,exited)</li><li><code>Transition</code>组件的<code>children</code>是一个函数，当状态发生改变时，会把新的状态传递给<code>children</code>函数参数，从而可以根据不同的状态渲染不同的样式</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">//第1次点击按钮 inProp从false变为true</span></span>
<span class="line"><span class="token parameter">exited</span><span class="token operator">=&gt;</span><span class="token parameter">entering</span><span class="token operator">=&gt;</span>entered</span>
<span class="line"><span class="token comment">//第2次点击按钮 inProp从true变为false</span></span>
<span class="line"><span class="token parameter">entered</span><span class="token operator">=&gt;</span><span class="token parameter">exiting</span><span class="token operator">=&gt;</span>exited</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://static.zhufengpeixun.com/Transition_1653035942886.jpg" alt=""></p><h3 id="_2-3-src-index-js" tabindex="-1"><a class="header-anchor" href="#_2-3-src-index-js"><span>2.3 src\\index.js</span></a></h3><p>src\\index.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&#39;react-dom/client&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token string">&#39;bootstrap/dist/css/bootstrap.min.css&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> TransitionPage <span class="token keyword">from</span> <span class="token string">&#39;./TransitionPage&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> root <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span></span>
<span class="line">  <span class="token operator">&lt;</span>TransitionPage <span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-transitionpage-index-js" tabindex="-1"><a class="header-anchor" href="#_2-4-transitionpage-index-js"><span>2.4 TransitionPage/index.js</span></a></h3><p>src\\TransitionPage\\index.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Container<span class="token punctuation">,</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-bootstrap&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Transition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../react-transition-group&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//动画的持续时间</span></span>
<span class="line"><span class="token keyword">const</span> duration <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//默认样式</span></span>
<span class="line"><span class="token keyword">const</span> defaultStyle <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">transition</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">opacity </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>duration<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ms</span><span class="token template-punctuation string">\`</span></span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> transitionStyles <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">entering</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//进入动画的展示状态</span></span>
<span class="line">  <span class="token literal-property property">entered</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//进入动画的最终状态</span></span>
<span class="line">  <span class="token literal-property property">exiting</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//离开动画的展示状态</span></span>
<span class="line">  <span class="token literal-property property">exited</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0.1</span> <span class="token punctuation">}</span><span class="token comment">//离开动画的最终状态</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">TransitionPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>inProp<span class="token punctuation">,</span> setInProp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token operator">&lt;</span>Container<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>Transition <span class="token keyword">in</span><span class="token operator">=</span><span class="token punctuation">{</span>inProp<span class="token punctuation">}</span> timeout<span class="token operator">=</span><span class="token punctuation">{</span>duration<span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">{</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span></span>
<span class="line">          <span class="token operator">&lt;</span>Button style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token operator">...</span>defaultStyle<span class="token punctuation">,</span> <span class="token operator">...</span>transitionStyles<span class="token punctuation">[</span>state<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line">            <span class="token punctuation">{</span>state<span class="token punctuation">}</span></span>
<span class="line">          <span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>Transition<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setInProp</span><span class="token punctuation">(</span><span class="token operator">!</span>inProp<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">{</span>inProp <span class="token operator">?</span> <span class="token string">&#39;hide&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;show&#39;</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>Container<span class="token operator">&gt;</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> TransitionPage<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-5-react-transition-group-index-js" tabindex="-1"><a class="header-anchor" href="#_2-5-react-transition-group-index-js"><span>2.5 react-transition-group\\index.js</span></a></h3><p>src\\react-transition-group\\index.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> Transition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./Transition&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-6-transition-js" tabindex="-1"><a class="header-anchor" href="#_2-6-transition-js"><span>2.6 Transition.js</span></a></h3><p>src\\react-transition-group\\Transition.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ENTERING</span> <span class="token operator">=</span> <span class="token string">&#39;entering&#39;</span><span class="token comment">//进入中</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ENTERED</span> <span class="token operator">=</span> <span class="token string">&#39;entered&#39;</span><span class="token comment">//进入后</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">EXITING</span> <span class="token operator">=</span> <span class="token string">&#39;exiting&#39;</span><span class="token comment">//退出中</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">EXITED</span> <span class="token operator">=</span> <span class="token string">&#39;exited&#39;</span><span class="token comment">//退出后</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Transition</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">//过渡的状态</span></span>
<span class="line">      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>in <span class="token operator">?</span> <span class="token constant">ENTERED</span> <span class="token operator">:</span> <span class="token constant">EXITED</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token punctuation">{</span> status <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//更新后当属性发生改变时更改状态</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>in<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//in为true时执行进场动画</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">!==</span> <span class="token constant">ENTERING</span> <span class="token operator">&amp;&amp;</span> status <span class="token operator">!==</span> <span class="token constant">ENTERED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token constant">ENTERING</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">//in为false时执行离场动画</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">===</span> <span class="token constant">ENTERING</span> <span class="token operator">||</span> status <span class="token operator">===</span> <span class="token constant">ENTERED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token constant">EXITING</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">onTransitionEnd</span><span class="token punctuation">(</span><span class="token parameter">timeout<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">setTimeout</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">performEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> timeout <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props</span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">ENTERING</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onTransitionEnd</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">ENTERED</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">performExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> timeout <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props</span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">EXITING</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onTransitionEnd</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">EXITED</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token parameter">nextStatus</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextStatus<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>nextStatus <span class="token operator">===</span> <span class="token constant">ENTERING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">performEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">performExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props</span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> status <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state</span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">      <span class="token function">children</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> Transition</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-csstransition" tabindex="-1"><a class="header-anchor" href="#_3-csstransition"><span>3. CSSTransition</span></a></h2><ul><li>如果您使用 <code>CSS</code> 过渡或动画，则应该使用它。它建立在<a href="http://reactcommunity.org/react-transition-group/css-transition" target="_blank" rel="noopener noreferrer">Transition</a> 组件之上，因此它继承了它的所有属性</li><li><code>CSSTransition</code>应用了一对类名在过渡的进场和离场状态</li></ul><h3 id="_3-1-动画钩子" tabindex="-1"><a class="header-anchor" href="#_3-1-动画钩子"><span>3.1 动画钩子</span></a></h3><ul><li><code>Transition</code>在管理组件的生命周期的时候给我们提供了动画钩子</li><li><code>CSSTransition</code>可以利用这些钩子函数为DOM节点添加类名</li></ul><table><thead><tr><th style="text-align:left;">钩子名称</th><th style="text-align:left;">钩子含义</th></tr></thead><tbody><tr><td style="text-align:left;">onEnter</td><td style="text-align:left;">进场动画开始执行时调用</td></tr><tr><td style="text-align:left;">onEntering</td><td style="text-align:left;">进场动画执行中调用</td></tr><tr><td style="text-align:left;">onEntered</td><td style="text-align:left;">进场动画执行完毕调用</td></tr><tr><td style="text-align:left;">onExit</td><td style="text-align:left;">退场动画开始执行时调用</td></tr><tr><td style="text-align:left;">onExiting</td><td style="text-align:left;">退场动画执行中时调用</td></tr><tr><td style="text-align:left;">onExited</td><td style="text-align:left;">退场动画执行完毕调用</td></tr></tbody></table><h3 id="_3-2-classnames" tabindex="-1"><a class="header-anchor" href="#_3-2-classnames"><span>3.2 classNames</span></a></h3><ul><li>在组件出现、进入、退出或完成过渡时应用于组件的动画类名</li><li>可以提供一个名称，每个阶段都会加上后缀</li><li>例如<code>classNames=&quot;fade&quot;</code></li><li>进场时 fade-enter=&gt;(马上)=&gt;fade-enter fade-enter-active=&gt;(1s后)=&gt;fade-enter-done <ul><li>enter 表示开始动画的初始阶段</li><li>enter-active 表示开始动画的激活阶段</li><li>enter-done 表示开始动画的结束阶段，也是样式的持久化展示阶段</li></ul></li><li>退场时 fade-exit=&gt;(马上)=&gt;fade-exit fade-exit-active=&gt;(1s后)=&gt;fade-exit-done <ul><li>exit 表示开始动画的初始阶段</li><li>exit-active 表示开始动画的激活阶段</li><li>exit-done 表示开始动画的结束阶段，也是样式的持久化展示阶段</li></ul></li></ul><h3 id="_3-3-src-index-js" tabindex="-1"><a class="header-anchor" href="#_3-3-src-index-js"><span>3.3 src\\index.js</span></a></h3><p>src\\index.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">import React from &#39;react&#39;;</span>
<span class="line">import ReactDOM from &#39;react-dom/client&#39;;</span>
<span class="line">import &#39;bootstrap/dist/css/bootstrap.min.css&#39;;</span>
<span class="line">import TransitionPage from &#39;./TransitionPage&#39;;</span>
<span class="line">+import CSSTransitionPage from &#39;./CSSTransitionPage&#39;;</span>
<span class="line">const root = ReactDOM.createRoot(document.getElementById(&#39;root&#39;));</span>
<span class="line">root.render(</span>
<span class="line">+ &lt;CSSTransitionPage /&gt;</span>
<span class="line">);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-4-csstransitionpage-index-js" tabindex="-1"><a class="header-anchor" href="#_3-4-csstransitionpage-index-js"><span>3.4 CSSTransitionPage\\index.js</span></a></h3><p>src\\CSSTransitionPage\\index.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Container<span class="token punctuation">,</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-bootstrap&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> CSSTransition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../react-transition-group&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token string">&#39;./index.css&#39;</span></span>
<span class="line"><span class="token keyword">const</span> duration <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">CSSTransitionPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>inProp<span class="token punctuation">,</span> setInProp<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token operator">&lt;</span>Container<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>CSSTransition <span class="token keyword">in</span><span class="token operator">=</span><span class="token punctuation">{</span>inProp<span class="token punctuation">}</span> timeout<span class="token operator">=</span><span class="token punctuation">{</span>duration<span class="token punctuation">}</span> classNames<span class="token operator">=</span><span class="token string">&quot;fade&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">        <span class="token operator">&lt;</span>Button className<span class="token operator">=</span><span class="token string">&#39;fade&#39;</span><span class="token operator">&gt;</span></span>
<span class="line">          fade</span>
<span class="line">        <span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>CSSTransition<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>br <span class="token operator">/</span><span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setInProp</span><span class="token punctuation">(</span><span class="token operator">!</span>inProp<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">{</span>inProp <span class="token operator">?</span> <span class="token string">&#39;hide&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;show&#39;</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>Container<span class="token operator">&gt;</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> CSSTransitionPage<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-4-csstransitionpage-index-css" tabindex="-1"><a class="header-anchor" href="#_3-4-csstransitionpage-index-css"><span>3.4 CSSTransitionPage\\index.css</span></a></h3><p>src\\CSSTransitionPage\\index.css</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">.</span>fade <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">.1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>fade<span class="token punctuation">.</span>fade<span class="token operator">-</span>enter <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">.1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>fade<span class="token punctuation">.</span>fade<span class="token operator">-</span>enter<span class="token operator">-</span>active <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">transition</span><span class="token operator">:</span> opacity 1000ms<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>fade<span class="token punctuation">.</span>fade<span class="token operator">-</span>enter<span class="token operator">-</span>done <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>fade<span class="token punctuation">.</span>fade<span class="token operator">-</span>exit <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>fade<span class="token punctuation">.</span>fade<span class="token operator">-</span>exit<span class="token operator">-</span>active <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">.1</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">transition</span><span class="token operator">:</span> opacity 1000ms<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>fade<span class="token punctuation">.</span>fade<span class="token operator">-</span>exit<span class="token operator">-</span>done <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">.1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-6-react-transition-group-index-js" tabindex="-1"><a class="header-anchor" href="#_3-6-react-transition-group-index-js"><span>3.6 react-transition-group\\index.js</span></a></h3><p>src\\react-transition-group\\index.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">export { default as Transition } from &#39;./Transition&#39;;</span>
<span class="line">+export { default as CSSTransition } from &#39;./CSSTransition&#39;;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-7-csstransition-js" tabindex="-1"><a class="header-anchor" href="#_3-7-csstransition-js"><span>3.7 CSSTransition.js</span></a></h3><p>src\\react-transition-group\\CSSTransition.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"><span class="token keyword">import</span> Transition <span class="token keyword">from</span> <span class="token string">&#39;./Transition&#39;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">CSSTransition</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token function-variable function">getClassNames</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> classNames <span class="token punctuation">}</span> <span class="token operator">=</span> props</span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">base</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>classNames<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">active</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>classNames<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-active</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">done</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>classNames<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-done</span><span class="token template-punctuation string">\`</span></span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token function-variable function">onEnter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> exitClassNames <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;exit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//[&#39;fade-exit&#39;,&#39;fade-exit-active&#39;,&#39;fade-exit-done&#39;]</span></span>
<span class="line">    <span class="token function">reflowAndRemoveClass</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> exitClassNames<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">const</span> enterClassName <span class="token operator">=</span> <span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;enter&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>base<span class="token punctuation">;</span><span class="token comment">//fade-enter</span></span>
<span class="line">    <span class="token function">reflowAndAddClass</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> enterClassName<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token function-variable function">onEntering</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> enteringClassName <span class="token operator">=</span> <span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;enter&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>active<span class="token comment">//fade-enter-active</span></span>
<span class="line">    <span class="token function">reflowAndAddClass</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> enteringClassName<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token function-variable function">onEntered</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> enteringClassName <span class="token operator">=</span> <span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;enter&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>active<span class="token comment">//fade-enter-active</span></span>
<span class="line">    <span class="token keyword">const</span> enterClassName <span class="token operator">=</span> <span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;enter&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>base<span class="token comment">//fade-enter</span></span>
<span class="line">    <span class="token function">reflowAndRemoveClass</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> <span class="token punctuation">[</span>enterClassName<span class="token punctuation">,</span> enteringClassName<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">const</span> enteredClassName <span class="token operator">=</span> <span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;enter&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>done<span class="token comment">//fade-enter-done</span></span>
<span class="line">    <span class="token function">reflowAndAddClass</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> enteredClassName<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">const</span> <span class="token function-variable function">onExit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> enteredClassNames <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;enter&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token function">reflowAndRemoveClass</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> enteredClassNames<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">const</span> exitClassName <span class="token operator">=</span> <span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;exit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>base</span>
<span class="line">    <span class="token function">reflowAndAddClass</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> exitClassName<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">const</span> <span class="token function-variable function">onExiting</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> exitingClassName <span class="token operator">=</span> <span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;exit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>active</span>
<span class="line">    <span class="token function">reflowAndAddClass</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> exitingClassName<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token function-variable function">onExited</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> exitingClassName <span class="token operator">=</span> <span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;exit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>active</span>
<span class="line">    <span class="token keyword">const</span> exitClassName <span class="token operator">=</span> <span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;exit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>base</span>
<span class="line">    <span class="token function">reflowAndRemoveClass</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> <span class="token punctuation">[</span>exitClassName<span class="token punctuation">,</span> exitingClassName<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">const</span> exitedClassName <span class="token operator">=</span> <span class="token function">getClassNames</span><span class="token punctuation">(</span><span class="token string">&#39;exit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>done</span>
<span class="line">    <span class="token function">reflowAndAddClass</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> exitedClassName<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token operator">&lt;</span>Transition</span>
<span class="line">      onEnter<span class="token operator">=</span><span class="token punctuation">{</span>onEnter<span class="token punctuation">}</span></span>
<span class="line">      onEntering<span class="token operator">=</span><span class="token punctuation">{</span>onEntering<span class="token punctuation">}</span></span>
<span class="line">      onEntered<span class="token operator">=</span><span class="token punctuation">{</span>onEntered<span class="token punctuation">}</span></span>
<span class="line">      onExit<span class="token operator">=</span><span class="token punctuation">{</span>onExit<span class="token punctuation">}</span></span>
<span class="line">      onExiting<span class="token operator">=</span><span class="token punctuation">{</span>onExiting<span class="token punctuation">}</span></span>
<span class="line">      onExited<span class="token operator">=</span><span class="token punctuation">{</span>onExited<span class="token punctuation">}</span></span>
<span class="line">      <span class="token keyword">in</span><span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>in<span class="token punctuation">}</span></span>
<span class="line">      timeout<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>timeout<span class="token punctuation">}</span></span>
<span class="line">    <span class="token operator">&gt;</span></span>
<span class="line">      <span class="token punctuation">{</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span></span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>Transition<span class="token operator">&gt;</span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> CSSTransition<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">reflowAndAddClass</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> classes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  node<span class="token punctuation">.</span>offsetWidth <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>classes<span class="token punctuation">)</span> <span class="token operator">?</span> classes <span class="token operator">:</span> <span class="token punctuation">[</span>classes<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">className</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> node<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">reflowAndRemoveClass</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> classes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  node<span class="token punctuation">.</span>offsetWidth <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>classes<span class="token punctuation">)</span> <span class="token operator">?</span> classes <span class="token operator">:</span> <span class="token punctuation">[</span>classes<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">className</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> node<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-8-transition-js" tabindex="-1"><a class="header-anchor" href="#_3-8-transition-js"><span>3.8 Transition.js</span></a></h3><p>src\\react-transition-group\\Transition.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"><span class="token operator">+</span><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&#39;react-dom&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ENTERING</span> <span class="token operator">=</span> <span class="token string">&#39;entering&#39;</span><span class="token comment">//进入中</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ENTERED</span> <span class="token operator">=</span> <span class="token string">&#39;entered&#39;</span><span class="token comment">//进入后</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">EXITING</span> <span class="token operator">=</span> <span class="token string">&#39;exiting&#39;</span><span class="token comment">//退出中</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">EXITED</span> <span class="token operator">=</span> <span class="token string">&#39;exited&#39;</span><span class="token comment">//退出后</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Transition</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">//过渡的状态</span></span>
<span class="line">      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>in <span class="token operator">?</span> <span class="token constant">ENTERED</span> <span class="token operator">:</span> <span class="token constant">EXITED</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token punctuation">{</span> status <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//更新后当属性发生改变时更改状态</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>in<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//in为true时执行进场动画</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">!==</span> <span class="token constant">ENTERING</span> <span class="token operator">&amp;&amp;</span> status <span class="token operator">!==</span> <span class="token constant">ENTERED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token constant">ENTERING</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">//in为false时执行离场动画</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">===</span> <span class="token constant">ENTERING</span> <span class="token operator">||</span> status <span class="token operator">===</span> <span class="token constant">ENTERED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token constant">EXITING</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">onTransitionEnd</span><span class="token punctuation">(</span><span class="token parameter">timeout<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">setTimeout</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">performEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token operator">+</span>   <span class="token keyword">const</span> <span class="token punctuation">{</span> timeout<span class="token punctuation">,</span> onEnter<span class="token punctuation">,</span> onEntering<span class="token punctuation">,</span> onEntered <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props</span>
<span class="line"><span class="token operator">+</span>   <span class="token keyword">const</span> node <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">findDOMNode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token operator">+</span>   onEnter<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">ENTERING</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token operator">+</span>     onEntering<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onTransitionEnd</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token operator">+</span>       <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">ENTERED</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> onEntered<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">performExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token operator">+</span>   <span class="token keyword">const</span> <span class="token punctuation">{</span> timeout<span class="token punctuation">,</span> onExit<span class="token punctuation">,</span> onExiting<span class="token punctuation">,</span> onExited <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props</span>
<span class="line"><span class="token operator">+</span>   <span class="token keyword">const</span> node <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">findDOMNode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token operator">+</span>   onExit<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">EXITING</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token operator">+</span>     onExiting<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onTransitionEnd</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token operator">+</span>       <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">EXITED</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> onExited<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token parameter">nextStatus</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextStatus<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>nextStatus <span class="token operator">===</span> <span class="token constant">ENTERING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">performEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">performExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props</span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> status <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state</span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line"><span class="token operator">+</span>      <span class="token keyword">typeof</span> children <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span> <span class="token operator">?</span> <span class="token function">children</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token operator">:</span> children</span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> Transition</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-switchtransition" tabindex="-1"><a class="header-anchor" href="#_4-switchtransition"><span>4. SwitchTransition</span></a></h2><ul><li>当您想控制状态转换之间的渲染时，可以使用它</li><li>在两个组件切换的时候会等待上一个组件离场以后再触发另一个组件的进场动画</li></ul><h3 id="_4-1-实现原理" tabindex="-1"><a class="header-anchor" href="#_4-1-实现原理"><span>4.1 实现原理</span></a></h3><ul><li>首次渲染把<code>children</code>保存到<code>state</code>的<code>current</code>属性上并进行渲染</li><li>当组件从A切换到B的时候，在getDerivedStateFromProps把状态更新为<code>EXITING</code>,此时继续渲染A组件并触发A组件的离场动画</li><li>当A组件离场对画结束后修改状态为<code>ENTERING</code>并且清空<code>state.current</code>,再次渲染B组件，并触发B组件的进场动画,动画结束后状态变为<code>ENTERED</code></li><li>getDerivedStateFromProps <ul><li><code>getDerivedStateFromProps</code> 的作用就是为了让 <code>props</code> 能更新到组件内部 <code>state</code> 中</li><li>首次挂载顺序 constructor=&gt;getDerivedStateFromProps=&gt;render=&gt;componentDidMount</li><li>更新时顺序 getDerivedStateFromProps=&gt;render=&gt;componentDidUpdate</li></ul></li></ul><p><img src="https://static.zhufengpeixun.com/SwitchTransition_1653137819481.jpg" alt=""></p><h3 id="_4-2-src-index-js" tabindex="-1"><a class="header-anchor" href="#_4-2-src-index-js"><span>4.2 src\\index.js</span></a></h3><p>src\\index.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">import React from &#39;react&#39;;</span>
<span class="line">import ReactDOM from &#39;react-dom/client&#39;;</span>
<span class="line">import &#39;bootstrap/dist/css/bootstrap.min.css&#39;;</span>
<span class="line">import TransitionPage from &#39;./TransitionPage&#39;;</span>
<span class="line">import CSSTransitionPage from &#39;./CSSTransitionPage&#39;;</span>
<span class="line">+import SwitchTransitionPage from &#39;./SwitchTransitionPage&#39;;</span>
<span class="line">const root = ReactDOM.createRoot(document.getElementById(&#39;root&#39;));</span>
<span class="line">root.render(</span>
<span class="line">+ &lt;SwitchTransitionPage /&gt;</span>
<span class="line">);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-3-switchtransitionpage-index-js" tabindex="-1"><a class="header-anchor" href="#_4-3-switchtransitionpage-index-js"><span>4.3 SwitchTransitionPage/index.js</span></a></h3><p>src\\SwitchTransitionPage/index.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> SwitchTransition<span class="token punctuation">,</span> CSSTransition <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../react-transition-group&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token string">&#39;./index.css&#39;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">SwitchTransitionPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">const</span> buttonStyle <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token string">&#39;200px&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">&#39;80px&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">fontSize</span><span class="token operator">:</span> <span class="token string">&#39;40px&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">border</span><span class="token operator">:</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">&#39;green&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&#39;white&#39;</span> <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token operator">&lt;</span>SwitchTransition<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>CSSTransition</span>
<span class="line">        key<span class="token operator">=</span><span class="token punctuation">{</span>state<span class="token punctuation">}</span></span>
<span class="line">        timeout<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">2000</span><span class="token punctuation">}</span></span>
<span class="line">        classNames<span class="token operator">=</span><span class="token string">&quot;panel&quot;</span></span>
<span class="line">      <span class="token operator">&gt;</span></span>
<span class="line">        <span class="token operator">&lt;</span>button style<span class="token operator">=</span><span class="token punctuation">{</span>buttonStyle<span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>state<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line">          <span class="token punctuation">{</span>state <span class="token operator">?</span> <span class="token string">&quot;A&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>CSSTransition<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>SwitchTransition<span class="token operator">&gt;</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> SwitchTransitionPage<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-4-switchtransitionpage-index-css" tabindex="-1"><a class="header-anchor" href="#_4-4-switchtransitionpage-index-css"><span>4.4 SwitchTransitionPage\\index.css</span></a></h3><p>src\\SwitchTransitionPage\\index.css</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">.</span>panel <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>panel<span class="token operator">-</span>enter <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>panel<span class="token operator">-</span>enter<span class="token operator">-</span>active <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">transition</span><span class="token operator">:</span> opacity 2000ms<span class="token punctuation">,</span> transform 2000ms<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>panel<span class="token operator">-</span>enter<span class="token operator">-</span>done <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>panel<span class="token operator">-</span>exit <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>panel<span class="token operator">-</span>exit<span class="token operator">-</span>active <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">transform</span><span class="token operator">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">transition</span><span class="token operator">:</span> opacity 2000ms<span class="token punctuation">,</span> transform 2000ms<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>panel<span class="token operator">-</span>exit<span class="token operator">-</span>done <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-5-react-transition-group-index-js" tabindex="-1"><a class="header-anchor" href="#_4-5-react-transition-group-index-js"><span>4.5 react-transition-group\\index.js</span></a></h3><p>src\\react-transition-group\\index.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">export { default as Transition } from &#39;./Transition&#39;;</span>
<span class="line">export { default as CSSTransition } from &#39;./CSSTransition&#39;;</span>
<span class="line">+export { default as SwitchTransition } from &#39;./SwitchTransition&#39;;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-7-switchtransition-js" tabindex="-1"><a class="header-anchor" href="#_4-7-switchtransition-js"><span>4.7 SwitchTransition.js</span></a></h3><p>src\\react-transition-group\\SwitchTransition.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> isValidElement<span class="token punctuation">,</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">ENTERING</span><span class="token punctuation">,</span> <span class="token constant">ENTERED</span><span class="token punctuation">,</span> <span class="token constant">EXITING</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./Transition&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> TransitionGroupContext <span class="token keyword">from</span> <span class="token string">&#39;./TransitionGroupContext&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">SwitchTransition</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">ENTERED</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">current</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>mounted <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>mounted <span class="token operator">=</span> <span class="token boolean">true</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>current <span class="token operator">&amp;&amp;</span> <span class="token function">areChildrenDifferent</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>current<span class="token punctuation">,</span> props<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">EXITING</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">current</span><span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">in</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token function-variable function">changeState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">status<span class="token punctuation">,</span> current <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>current</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> status<span class="token punctuation">,</span> current <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> status<span class="token punctuation">,</span> current <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">let</span> component</span>
<span class="line">    <span class="token keyword">switch</span> <span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">case</span> <span class="token constant">ENTERING</span><span class="token operator">:</span></span>
<span class="line">        component <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token keyword">in</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token function-variable function">onEntered</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token constant">ENTERED</span><span class="token punctuation">)</span></span>
<span class="line">          <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">break</span></span>
<span class="line">      <span class="token keyword">case</span> <span class="token constant">EXITING</span><span class="token operator">:</span></span>
<span class="line">        component <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token keyword">in</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token function-variable function">onExited</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">changeState</span><span class="token punctuation">(</span><span class="token constant">ENTERING</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">          <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">break</span></span>
<span class="line">      <span class="token keyword">case</span> <span class="token constant">ENTERED</span><span class="token operator">:</span></span>
<span class="line">        component <span class="token operator">=</span> current</span>
<span class="line">        <span class="token keyword">break</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">      <span class="token operator">&lt;</span>TransitionGroupContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mounted <span class="token operator">?</span> <span class="token constant">ENTERING</span> <span class="token operator">:</span> <span class="token constant">ENTERED</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">{</span>component<span class="token punctuation">}</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>TransitionGroupContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">areChildrenDifferent</span><span class="token punctuation">(</span><span class="token parameter">oldChildren<span class="token punctuation">,</span> newChildren</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>oldChildren <span class="token operator">===</span> newChildren<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token function">isValidElement</span><span class="token punctuation">(</span>oldChildren<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span></span>
<span class="line">    <span class="token function">isValidElement</span><span class="token punctuation">(</span>newChildren<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span></span>
<span class="line">    oldChildren<span class="token punctuation">.</span>key <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span></span>
<span class="line">    oldChildren<span class="token punctuation">.</span>key <span class="token operator">===</span> newChildren<span class="token punctuation">.</span>key</span>
<span class="line">  <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> SwitchTransition<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-8-csstransition-js" tabindex="-1"><a class="header-anchor" href="#_4-8-csstransition-js"><span>4.8 CSSTransition.js</span></a></h3><p>src\\react-transition-group\\CSSTransition.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">import React from &#39;react&#39;</span>
<span class="line">import Transition from &#39;./Transition&#39;</span>
<span class="line">function CSSTransition(props) {</span>
<span class="line">  const getClassNames = (status) =&gt; {</span>
<span class="line">    const { classNames } = props</span>
<span class="line">    return {</span>
<span class="line">      base: \`\${classNames}-\${status}\`,</span>
<span class="line">      active: \`\${classNames}-\${status}-active\`,</span>
<span class="line">      done: \`\${classNames}-\${status}-done\`</span>
<span class="line">    }</span>
<span class="line">  }</span>
<span class="line">  const onEnter = (node) =&gt; {</span>
<span class="line">    const exitClassNames = Object.values(getClassNames(&#39;exit&#39;));//[&#39;fade-exit&#39;,&#39;fade-exit-active&#39;,&#39;fade-exit-done&#39;]</span>
<span class="line">    reflowAndRemoveClass(node, exitClassNames)</span>
<span class="line">    const enterClassName = getClassNames(&#39;enter&#39;).base;//fade-enter</span>
<span class="line">    reflowAndAddClass(node, enterClassName)</span>
<span class="line">  }</span>
<span class="line">  const onEntering = (node) =&gt; {</span>
<span class="line">    const enteringClassName = getClassNames(&#39;enter&#39;).active//fade-enter-active</span>
<span class="line">    reflowAndAddClass(node, enteringClassName)</span>
<span class="line">  }</span>
<span class="line">  const onEntered = (node) =&gt; {</span>
<span class="line">    const enteringClassName = getClassNames(&#39;enter&#39;).active//fade-enter-active</span>
<span class="line">    const enterClassName = getClassNames(&#39;enter&#39;).base//fade-enter</span>
<span class="line">    reflowAndRemoveClass(node, [enterClassName, enteringClassName])</span>
<span class="line">    const enteredClassName = getClassNames(&#39;enter&#39;).done//fade-enter-done</span>
<span class="line">    reflowAndAddClass(node, enteredClassName)</span>
<span class="line">+   props.onEntered?.(node)</span>
<span class="line">  }</span>
<span class="line"></span>
<span class="line">  const onExit = (node) =&gt; {</span>
<span class="line">    const enteredClassNames = Object.values(getClassNames(&#39;enter&#39;))</span>
<span class="line">    reflowAndRemoveClass(node, enteredClassNames)</span>
<span class="line">    const exitClassName = getClassNames(&#39;exit&#39;).base</span>
<span class="line">    reflowAndAddClass(node, exitClassName)</span>
<span class="line">  }</span>
<span class="line"></span>
<span class="line">  const onExiting = (node) =&gt; {</span>
<span class="line">    const exitingClassName = getClassNames(&#39;exit&#39;).active</span>
<span class="line">    reflowAndAddClass(node, exitingClassName, true)</span>
<span class="line">  }</span>
<span class="line">  const onExited = (node) =&gt; {</span>
<span class="line">    const exitingClassName = getClassNames(&#39;exit&#39;).active</span>
<span class="line">    const exitClassName = getClassNames(&#39;exit&#39;).base</span>
<span class="line">    reflowAndRemoveClass(node, [exitClassName, exitingClassName])</span>
<span class="line">    const exitedClassName = getClassNames(&#39;exit&#39;).done</span>
<span class="line">    reflowAndAddClass(node, exitedClassName)</span>
<span class="line">+   props.onExited?.(node)</span>
<span class="line">  }</span>
<span class="line">  return (</span>
<span class="line">    &lt;Transition</span>
<span class="line">      onEnter={onEnter}</span>
<span class="line">      onEntering={onEntering}</span>
<span class="line">      onEntered={onEntered}</span>
<span class="line">      onExit={onExit}</span>
<span class="line">      onExiting={onExiting}</span>
<span class="line">      onExited={onExited}</span>
<span class="line">      in={props.in}</span>
<span class="line">      timeout={props.timeout}</span>
<span class="line">    &gt;</span>
<span class="line">      {props.children}</span>
<span class="line">    &lt;/Transition&gt;</span>
<span class="line">  )</span>
<span class="line">}</span>
<span class="line">export default CSSTransition;</span>
<span class="line"></span>
<span class="line">function reflowAndAddClass(node, classes) {</span>
<span class="line">  //强制浏览器重绘</span>
<span class="line">  node.offsetLeft &amp;&amp; (Array.isArray(classes) ? classes : [classes]).forEach((className) =&gt; node.classList.add(className))</span>
<span class="line">}</span>
<span class="line">function reflowAndRemoveClass(node, classes) {</span>
<span class="line">  node.offsetLeft &amp;&amp; (Array.isArray(classes) ? classes : [classes]).forEach((className) =&gt; node.classList.remove(className))</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-9-transition-js" tabindex="-1"><a class="header-anchor" href="#_4-9-transition-js"><span>4.9 Transition.js</span></a></h3><p>src\\react-transition-group\\Transition.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&#39;react-dom&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">+</span><span class="token keyword">import</span> TransitionGroupContext <span class="token keyword">from</span> <span class="token string">&#39;./TransitionGroupContext&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ENTERING</span> <span class="token operator">=</span> <span class="token string">&#39;entering&#39;</span><span class="token comment">//进入中</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ENTERED</span> <span class="token operator">=</span> <span class="token string">&#39;entered&#39;</span><span class="token comment">//进入后</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">EXITING</span> <span class="token operator">=</span> <span class="token string">&#39;exiting&#39;</span><span class="token comment">//退出中</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">EXITED</span> <span class="token operator">=</span> <span class="token string">&#39;exited&#39;</span><span class="token comment">//退出后</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Transition</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token operator">+</span> <span class="token keyword">static</span> contextType <span class="token operator">=</span> TransitionGroupContext</span>
<span class="line">  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">//过渡的状态</span></span>
<span class="line">      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>in <span class="token operator">?</span> <span class="token constant">ENTERED</span> <span class="token operator">:</span> <span class="token constant">EXITED</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token operator">+</span> <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token operator">+</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token operator">+</span>     <span class="token keyword">const</span> <span class="token punctuation">{</span> status <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context</span>
<span class="line"><span class="token operator">+</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">===</span> <span class="token constant">ENTERING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token operator">+</span>       <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateStatus</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span></span>
<span class="line"><span class="token operator">+</span>     <span class="token punctuation">}</span></span>
<span class="line"><span class="token operator">+</span>   <span class="token punctuation">}</span></span>
<span class="line"><span class="token operator">+</span> <span class="token punctuation">}</span></span>
<span class="line">  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token punctuation">{</span> status <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//更新后当属性发生改变时更改状态</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>in<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//in为true时执行进场动画</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">!==</span> <span class="token constant">ENTERING</span> <span class="token operator">&amp;&amp;</span> status <span class="token operator">!==</span> <span class="token constant">ENTERED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token constant">ENTERING</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment">//in为false时执行离场动画</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">===</span> <span class="token constant">ENTERING</span> <span class="token operator">||</span> status <span class="token operator">===</span> <span class="token constant">ENTERED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token constant">EXITING</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">onTransitionEnd</span><span class="token punctuation">(</span><span class="token parameter">timeout<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">setTimeout</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">performEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> timeout<span class="token punctuation">,</span> onEnter<span class="token punctuation">,</span> onEntering<span class="token punctuation">,</span> onEntered <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props</span>
<span class="line">    <span class="token keyword">const</span> node <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">findDOMNode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span></span>
<span class="line">    onEnter<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">ENTERING</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      onEntering<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onTransitionEnd</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">ENTERED</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> onEntered<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">performExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> timeout<span class="token punctuation">,</span> onExit<span class="token punctuation">,</span> onExiting<span class="token punctuation">,</span> onExited <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props</span>
<span class="line">    <span class="token keyword">const</span> node <span class="token operator">=</span> ReactDOM<span class="token punctuation">.</span><span class="token function">findDOMNode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span></span>
<span class="line">    onExit<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">EXITING</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      onExiting<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onTransitionEnd</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">EXITED</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> onExited<span class="token operator">?.</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">updateStatus</span><span class="token punctuation">(</span><span class="token parameter">nextStatus</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>nextStatus<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>nextStatus <span class="token operator">===</span> <span class="token constant">ENTERING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">performEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">performExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> children <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props</span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> status <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state</span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">      <span class="token keyword">typeof</span> children <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span> <span class="token operator">?</span> <span class="token function">children</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token operator">:</span> children</span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> Transition</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-10-transitiongroupcontext-js" tabindex="-1"><a class="header-anchor" href="#_4-10-transitiongroupcontext-js"><span>4.10 TransitionGroupContext.js</span></a></h3><p>src\\react-transition-group\\TransitionGroupContext.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-transitiongroup" tabindex="-1"><a class="header-anchor" href="#_5-transitiongroup"><span>5. TransitionGroup</span></a></h2><ul><li><a href="http://reactcommunity.org/react-transition-group/transition-group" target="_blank" rel="noopener noreferrer">TransitionGroup</a>组件管理列表中的一组转换组件Transition和CSSTransition</li><li>与过渡组件一样，<code>TransitionGroup</code>它是一个状态机，用于随时间管理组件的安装和卸载</li></ul><h3 id="_5-1-原理" tabindex="-1"><a class="header-anchor" href="#_5-1-原理"><span>5.1 原理</span></a></h3><ul><li>该组件主要用来给一组元素添加进场和离场动画</li><li>原理是用新的<code>children</code>和上次的<code>children</code>进行对比，如果是增加元素就先添加进场动画，如果是删除元素就添加离场动画，等动画结束后再去进行真正的挂载和卸载操作</li></ul><p><img src="https://static.zhufengpeixun.com/TransitionGroup_1653140160213.jpg" alt=""></p><h3 id="_5-2-src-index-js" tabindex="-1"><a class="header-anchor" href="#_5-2-src-index-js"><span>5.2 src\\index.js</span></a></h3><p>src\\index.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">import React from &#39;react&#39;;</span>
<span class="line">import ReactDOM from &#39;react-dom/client&#39;;</span>
<span class="line">import &#39;bootstrap/dist/css/bootstrap.min.css&#39;;</span>
<span class="line">import TransitionPage from &#39;./TransitionPage&#39;;</span>
<span class="line">import CSSTransitionPage from &#39;./CSSTransitionPage&#39;;</span>
<span class="line">import SwitchTransitionPage from &#39;./SwitchTransitionPage&#39;;</span>
<span class="line">+import TransitionGroupPage from &#39;./TransitionGroupPage&#39;;</span>
<span class="line">const root = ReactDOM.createRoot(document.getElementById(&#39;root&#39;));</span>
<span class="line">root.render(</span>
<span class="line">+ &lt;TransitionGroupPage /&gt;</span>
<span class="line">);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-transitiongrouppage-index-js" tabindex="-1"><a class="header-anchor" href="#_5-3-transitiongrouppage-index-js"><span>5.3 TransitionGroupPage\\index.js</span></a></h3><p>src\\TransitionGroupPage\\index.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Container<span class="token punctuation">,</span> ListGroup<span class="token punctuation">,</span> Button<span class="token punctuation">,</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-bootstrap&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> CSSTransition<span class="token punctuation">,</span> TransitionGroup<span class="token punctuation">,</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../react-transition-group&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token string">&#39;./index.css&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">TransitionGroupPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>items<span class="token punctuation">,</span> setItems<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;吃饭&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;睡觉&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;3&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;打豆豆&#39;</span> <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token operator">&lt;</span>Container<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>ListGroup<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token operator">&lt;</span>TransitionGroup<span class="token operator">&gt;</span></span>
<span class="line">          <span class="token punctuation">{</span>items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id<span class="token punctuation">,</span> text <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span></span>
<span class="line">            <span class="token operator">&lt;</span>CSSTransition</span>
<span class="line">              key<span class="token operator">=</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span></span>
<span class="line">              timeout<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1000</span><span class="token punctuation">}</span></span>
<span class="line">              classNames<span class="token operator">=</span><span class="token string">&quot;item&quot;</span></span>
<span class="line">            <span class="token operator">&gt;</span></span>
<span class="line">              <span class="token operator">&lt;</span>ListGroup<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span>Button</span>
<span class="line">                  style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">marginRight</span><span class="token operator">:</span> <span class="token string">&#39;10px&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">                  onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span>
<span class="line">                    <span class="token function">setItems</span><span class="token punctuation">(</span><span class="token parameter">items</span> <span class="token operator">=&gt;</span></span>
<span class="line">                      items<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>id <span class="token operator">!==</span> id<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">)</span></span>
<span class="line">                  <span class="token punctuation">}</span></span>
<span class="line">                <span class="token operator">&gt;</span></span>
<span class="line">                  <span class="token operator">&amp;</span>times<span class="token punctuation">;</span></span>
<span class="line">                <span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span></span>
<span class="line">                <span class="token punctuation">{</span>text<span class="token punctuation">}</span></span>
<span class="line">              <span class="token operator">&lt;</span><span class="token operator">/</span>ListGroup<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span></span>
<span class="line">            <span class="token operator">&lt;</span><span class="token operator">/</span>CSSTransition<span class="token operator">&gt;</span></span>
<span class="line">          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="line">        <span class="token operator">&lt;</span><span class="token operator">/</span>TransitionGroup<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>ListGroup<span class="token operator">&gt;</span></span>
<span class="line">      <span class="token operator">&lt;</span>Button</span>
<span class="line">        onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token function">setItems</span><span class="token punctuation">(</span><span class="token parameter">items</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span></span>
<span class="line">            <span class="token operator">...</span>items<span class="token punctuation">,</span></span>
<span class="line">            <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> items<span class="token punctuation">.</span>length <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token operator">&gt;</span></span>
<span class="line">        Add Item</span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span><span class="token operator">/</span>Container<span class="token operator">&gt;</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> TransitionGroupPage<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-4-transitiongrouppage-index-css" tabindex="-1"><a class="header-anchor" href="#_5-4-transitiongrouppage-index-css"><span>5.4 TransitionGroupPage\\index.css</span></a></h3><p>src\\TransitionGroupPage\\index.css</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">.</span>item<span class="token operator">-</span>enter <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>item<span class="token operator">-</span>enter<span class="token operator">-</span>active <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">transition</span><span class="token operator">:</span> opacity 1000ms<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>item<span class="token operator">-</span>exit <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span>item<span class="token operator">-</span>exit<span class="token operator">-</span>active <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">opacity</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token literal-property property">transition</span><span class="token operator">:</span> opacity 1000ms<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-5-react-transition-group-index-js" tabindex="-1"><a class="header-anchor" href="#_5-5-react-transition-group-index-js"><span>5.5 react-transition-group\\index.js</span></a></h3><p>src\\react-transition-group\\index.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">export { default as Transition } from &#39;./Transition&#39;;</span>
<span class="line">export { default as CSSTransition } from &#39;./CSSTransition&#39;;</span>
<span class="line">export { default as SwitchTransition } from &#39;./SwitchTransition&#39;;</span>
<span class="line">+export { default as TransitionGroup } from &#39;./TransitionGroup&#39;;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-6-transitiongroup-js" tabindex="-1"><a class="header-anchor" href="#_5-6-transitiongroup-js"><span>5.6 TransitionGroup.js</span></a></h3><p>src\\react-transition-group\\TransitionGroup.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> cloneElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> TransitionGroupContext <span class="token keyword">from</span> <span class="token string">&#39;./TransitionGroupContext&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">ENTERING</span><span class="token punctuation">,</span> <span class="token constant">ENTERED</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./Transition&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">TransitionGroup</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">ENTERED</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">firstRender</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">handleExited</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleExited</span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span> <span class="token punctuation">{</span> children<span class="token punctuation">,</span> firstRender<span class="token punctuation">,</span> handleExited <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">children</span><span class="token operator">:</span> firstRender</span>
<span class="line">        <span class="token operator">?</span> <span class="token function">getInitialChildrenMapping</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>children<span class="token punctuation">)</span></span>
<span class="line">        <span class="token operator">:</span> <span class="token function">getNextChildrenMapping</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> children<span class="token punctuation">,</span> handleExited<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">firstRender</span><span class="token operator">:</span> <span class="token boolean">false</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token constant">ENTERING</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function-variable function">handleExited</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">child</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">const</span> children <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">.</span>children <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token keyword">delete</span> children<span class="token punctuation">[</span>child<span class="token punctuation">.</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token keyword">return</span> <span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> <span class="token punctuation">{</span> children<span class="token punctuation">,</span> status <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">const</span> component <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">      <span class="token operator">&lt;</span>TransitionGroupContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> status <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">{</span>component<span class="token punctuation">}</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>TransitionGroupContext<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> TransitionGroup<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">getChildrenMapping</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token function-variable function">mapFn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> result <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    result<span class="token punctuation">[</span>c<span class="token punctuation">.</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">mapFn</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">return</span> result<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">getInitialChildrenMapping</span><span class="token punctuation">(</span><span class="token parameter">children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token function">getChildrenMapping</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">cloneElement</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">in</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">mergeChildMappings</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>prev<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&gt;</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">?</span> prev <span class="token operator">:</span> next<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">getNextChildrenMapping</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span> prevChildrenMapping<span class="token punctuation">,</span> handleExited</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> result <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">const</span> nextChildrenMapping <span class="token operator">=</span> <span class="token function">getChildrenMapping</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">const</span> mergeMappings <span class="token operator">=</span> <span class="token function">mergeChildMappings</span><span class="token punctuation">(</span>prevChildrenMapping<span class="token punctuation">,</span> nextChildrenMapping<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>mergeMappings<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> isNext <span class="token operator">=</span> key <span class="token keyword">in</span> nextChildrenMapping<span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">const</span> isPrev <span class="token operator">=</span> key <span class="token keyword">in</span> prevChildrenMapping<span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">//老没有，新的有，新增元素</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isPrev <span class="token operator">&amp;&amp;</span> isNext<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>nextChildrenMapping<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">in</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">//老的有，新的没有，先渲染老的，动画结束后删除元素</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>isPrev <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isNext<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>prevChildrenMapping<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">in</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token function">onExited</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token function">handleExited</span><span class="token punctuation">(</span>prevChildrenMapping<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">//新老都有，更新用新的</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>isNext <span class="token operator">&amp;&amp;</span> isPrev<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      result<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>nextChildrenMapping<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token keyword">in</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">return</span> result<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,100)])])}const i=s(e,[["render",o]]),u=JSON.parse('{"path":"/strong/153.transition.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/153.transition.md"}');export{i as comp,u as data};
