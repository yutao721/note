import{_ as a,c as n,a as e,o as p}from"./app-CD1YpnS1.js";const t={};function l(o,s){return p(),n("div",null,[...s[0]||(s[0]=[e(`<h2 id="_1-主从复制" tabindex="-1"><a class="header-anchor" href="#_1-主从复制"><span>1. 主从复制</span></a></h2><p>主从复制是一个简单的数据库同步备份的集群技术</p><ul><li>在数据库集群中要明确知道谁是主服务器，主服务器只有一台</li><li>从服务器要知道自己的数据源也就是知道自己的主服务器是谁</li><li>--master用来确定主服务器，--slave和--source 来控制从服务器</li></ul><p><img src="http://img.zhufengpeixun.cn/masterslave.jpg" alt="masterslave"></p><h3 id="_1-1-主服务器" tabindex="-1"><a class="header-anchor" href="#_1-1-主服务器"><span>1.1 主服务器</span></a></h3><p>master.conf</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\ms\\master</span>
<span class="line">port<span class="token operator">=</span><span class="token number">1000</span></span>
<span class="line">master<span class="token operator">=</span><span class="token boolean">true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>master.bat</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">mongod --config master.conf</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_1-2-从服务器" tabindex="-1"><a class="header-anchor" href="#_1-2-从服务器"><span>1.2 从服务器</span></a></h3><p>slave.conf</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\p\\slave</span>
<span class="line">port<span class="token operator">=</span><span class="token number">1001</span></span>
<span class="line">slave<span class="token operator">=</span><span class="token boolean">true</span></span>
<span class="line">source<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">1000</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>slave.bat</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">mongod --config slave.conf</span>
<span class="line">rs.slaveOk();</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-3-主从复制的其它设置项" tabindex="-1"><a class="header-anchor" href="#_1-3-主从复制的其它设置项"><span>1.3 主从复制的其它设置项</span></a></h3><ul><li>-only 从节点-&gt; 指定复制某个数据库默认是复制全部数据库</li><li>-slavedelay 从节点-&gt; 设置主数据库同步数据的延迟(单位是秒)</li><li>-fastsync 从节点-&gt; 以主数据库的节点快照为节点启动从数据库</li><li>-autoresync 从节点-&gt;如果不同步则重新同步数据库</li><li>-oplogSize 主节点-&gt;设置oplog的大小(主节点操作记录存储到local的oplog中)</li></ul><h3 id="_1-4-利用shell动态添加和删除主节点" tabindex="-1"><a class="header-anchor" href="#_1-4-利用shell动态添加和删除主节点"><span>1.4 利用shell动态添加和删除主节点</span></a></h3><p>登录从服务器</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">use local<span class="token punctuation">;</span></span>
<span class="line">show collections<span class="token punctuation">;</span></span>
<span class="line">db<span class="token punctuation">.</span>sources<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//{  &quot;host&quot; : &quot;127.0.0.1:8000&quot;, &quot;source&quot; : &quot;main&quot;, &quot;syncedTo&quot; : Timestamp(1524728329, 1) }</span></span>
<span class="line">db<span class="token punctuation">.</span>sources<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">host</span><span class="token operator">:</span><span class="token string">&#39;127.0.0.1:8000&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//挂载主节点</span></span>
<span class="line">db<span class="token punctuation">.</span>sources<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">host</span><span class="token operator">:</span><span class="token string">&#39;127.0.0.1:8000&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//删除已经挂载的主节点</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-副本集" tabindex="-1"><a class="header-anchor" href="#_2-副本集"><span>2. 副本集</span></a></h2><ul><li>MongoDB复制是将数据同步在多个服务器的过程。</li><li>复制提供了数据的冗余备份，并在多个服务器上存储数据副本，提高了数据的可用性， 并可以保证数据的安全性。</li><li>复制还允许您从硬件故障和服务中断中恢复数据。</li></ul><h3 id="_2-1-mongodb复制原理" tabindex="-1"><a class="header-anchor" href="#_2-1-mongodb复制原理"><span>2.1 MongoDB复制原理</span></a></h3><ul><li>mongodb的复制至少需要两个节点。其中一个是主节点，负责处理客户端请求，其余的都是从节点，负责复制主节点上的数据。</li><li>mongodb各个节点常见的搭配方式为：一主一从、一主多从。</li><li>主节点记录在其上的所有操作oplog，从节点定期轮询主节点获取这些操作，然后对自己的数据副本执行这些操作，从而保证从节点的数据与主节点一致。</li><li><img src="http://img.zhufengpeixun.cn/replication.png" alt="replication"></li></ul><h3 id="_2-1-流程" tabindex="-1"><a class="header-anchor" href="#_2-1-流程"><span>2.1 流程</span></a></h3><ol><li>一台活跃服务器和二个备份服务器</li><li>当活跃服务器出现故障，这时集群根据权重算法推选出出活跃服务器</li><li>当原来的主服务器恢复后又会变成从服务器</li></ol><h3 id="_2-2-配置副本集" tabindex="-1"><a class="header-anchor" href="#_2-2-配置副本集"><span>2.2 配置副本集</span></a></h3><p>A服务器</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\repl\\repl1</span>
<span class="line">port<span class="token operator">=</span><span class="token number">2001</span></span>
<span class="line">replSet<span class="token operator">=</span>group</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>B服务器</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\repl\\repl2</span>
<span class="line">port<span class="token operator">=</span><span class="token number">2002</span></span>
<span class="line">replSet<span class="token operator">=</span>group</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>C服务器</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\repl\\repl3</span>
<span class="line">port<span class="token operator">=</span><span class="token number">2003</span></span>
<span class="line">replSet<span class="token operator">=</span>group</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-初始化副本集" tabindex="-1"><a class="header-anchor" href="#_2-3-初始化副本集"><span>2.3 初始化副本集</span></a></h3><ul><li>rs.initiate() 启动一个新的副本集</li><li>rs.conf() 查看副本集的配置</li><li>rs.status() 命令</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">use admin<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> conf<span class="token operator">=</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;group&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string-property property">&quot;members&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token string-property property">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;127.0.0.1:2001&quot;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token string-property property">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;127.0.0.1:2002&quot;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token string-property property">&quot;host&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;127.0.0.1:2003&quot;</span>  <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">rs<span class="token punctuation">.</span><span class="token function">initiate</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">rs<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-高级参数" tabindex="-1"><a class="header-anchor" href="#_2-4-高级参数"><span>2.4 高级参数</span></a></h3><ul><li>standard 常规节点 参与投票有可能成为活跃节点</li><li>passive 副本节点 参与投票，但不能成为活跃节点</li><li>arbiter 仲裁节点 只参与投票，不复制节点，也不能成为活跃节点</li><li>priority 0到1000之间，0代表是副本节点，1到1000是常规节点</li><li>arbiterOnly:true 仲裁节点</li></ul><h3 id="_2-5-读写分离操作" tabindex="-1"><a class="header-anchor" href="#_2-5-读写分离操作"><span>2.5 读写分离操作</span></a></h3><p>一般情况下作为副本节点是不能进行数据库操作的，但是在读取密集的系统中读写分离是必要的</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> rs.slaveOk();</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-6-oplog" tabindex="-1"><a class="header-anchor" href="#_2-6-oplog"><span>2.6 Oplog</span></a></h3><p>它被存储在本地数据库local中，会记录每一个操作。 如果希望在故障恢复的时候尽可能更多，可以把这个size设置的大一点</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">--</span>oplogSize <span class="token number">1024</span></span>
<span class="line">use local<span class="token punctuation">;</span></span>
<span class="line"> db<span class="token punctuation">.</span>oplog<span class="token punctuation">.</span>rs<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-分片" tabindex="-1"><a class="header-anchor" href="#_3-分片"><span>3. 分片</span></a></h2><p>在Mongodb里面存在另一种集群，就是分片技术,可以满足MongoDB数据量大量增长的需求。 当MongoDB存储海量的数据时，一台机器可能不足以存储数据，也可能不足以提供可接受的读写吞吐量。这时，我们就可以通过在多台机器上分割数据，使得数据库系统能存储和处理更多的数据。</p><h3 id="_3-1-分片架构图" tabindex="-1"><a class="header-anchor" href="#_3-1-分片架构图"><span>3.1 分片架构图</span></a></h3><p><img src="http://img.zhufengpeixun.cn/sharding.png" alt="sharding"></p><h3 id="_3-2-片键" tabindex="-1"><a class="header-anchor" href="#_3-2-片键"><span>3.2 片键</span></a></h3><p>路由根据片键把不同的文档保存到不同的分片中</p><h3 id="_3-3-分片的应用场景" tabindex="-1"><a class="header-anchor" href="#_3-3-分片的应用场景"><span>3.3 分片的应用场景</span></a></h3><ol><li>单台机器无法存储</li><li>单台机器已经不能满足高并发操作</li><li>想把尽可能多的数据存放到内存中提高性能</li></ol><h3 id="_3-4-配置" tabindex="-1"><a class="header-anchor" href="#_3-4-配置"><span>3.4 配置</span></a></h3><h4 id="_3-4-1-创建sharding副本集" tabindex="-1"><a class="header-anchor" href="#_3-4-1-创建sharding副本集"><span>3.4.1 创建Sharding副本集</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mkdir <span class="token constant">E</span><span class="token operator">:</span>\\repl\\db2001</span>
<span class="line">mongod <span class="token operator">--</span>port <span class="token number">2001</span> <span class="token operator">--</span>dbpath<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>db2001  <span class="token operator">--</span>shardsvr <span class="token operator">--</span>replSet<span class="token operator">=</span>shard1</span>
<span class="line">mkdir <span class="token constant">E</span><span class="token operator">:</span>\\repl<span class="token operator">/</span>db2002</span>
<span class="line">mongod <span class="token operator">--</span>port <span class="token number">2002</span> <span class="token operator">--</span>dbpath<span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>db2002 <span class="token operator">--</span>shardsvr <span class="token operator">--</span>replSet<span class="token operator">=</span>shard1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">rs.initiate({_id: &#39;shard1&#39;, members: [{_id: 0, host: &#39;localhost:2001&#39;}, {_id: 1, host: &#39;localhost:2002&#39;}]})</span>
<span class="line"> rs.isMaster() </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mkdir <span class="token constant">E</span><span class="token operator">:</span>\\repl\\db2003</span>
<span class="line">mongod <span class="token operator">--</span>port <span class="token number">2003</span> <span class="token operator">--</span>dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\repl\\db2003  <span class="token operator">--</span>shardsvr <span class="token operator">--</span>replSet<span class="token operator">=</span>shard2</span>
<span class="line">mkdir <span class="token constant">E</span><span class="token operator">:</span>\\repl\\db2004</span>
<span class="line">mongod <span class="token operator">--</span>port <span class="token number">2004</span> <span class="token operator">--</span>dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\repl\\db2004 <span class="token operator">--</span>shardsvr <span class="token operator">--</span>replSet<span class="token operator">=</span>shard2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">rs.initiate({_id: &#39;shard2&#39;, members: [{_id: 0, host: &#39;localhost:2003&#39;}, {_id: 1, host: &#39;localhost:2004&#39;}]})</span>
<span class="line"> rs.isMaster() </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-4-2-创建一个配置服务器" tabindex="-1"><a class="header-anchor" href="#_3-4-2-创建一个配置服务器"><span>3.4.2 创建一个配置服务器</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mkdir <span class="token constant">E</span><span class="token operator">:</span>\\repl\\db2005</span>
<span class="line">mongod <span class="token operator">--</span>port <span class="token number">2005</span> <span class="token operator">--</span>dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\repl\\db2005  <span class="token operator">--</span>shardsvr <span class="token operator">--</span>replSet<span class="token operator">=</span>config</span>
<span class="line">mkdir <span class="token constant">E</span><span class="token operator">:</span>\\repl\\db2006</span>
<span class="line">mongod <span class="token operator">--</span>port <span class="token number">2006</span> <span class="token operator">--</span>dbpath<span class="token operator">=</span><span class="token constant">E</span><span class="token operator">:</span>\\repl\\db2006  <span class="token operator">--</span>shardsvr <span class="token operator">--</span>replSet<span class="token operator">=</span>config</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">rs.initiate({_id: &#39;config&#39;, members: [{_id: 0, host: &#39;localhost:2005&#39;}, {_id: 1, host: &#39;localhost:2006&#39;}]})</span>
<span class="line"> rs.isMaster() </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-4-2-创建路由服务器-并且连接配置服务器" tabindex="-1"><a class="header-anchor" href="#_3-4-2-创建路由服务器-并且连接配置服务器"><span>3.4.2 创建路由服务器，并且连接配置服务器</span></a></h4><p>路由器调用mongos命令</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mongos <span class="token operator">--</span>port <span class="token number">2006</span> <span class="token operator">--</span>configdb config<span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">2005</span><span class="token punctuation">,</span><span class="token literal-property property">localhost</span><span class="token operator">:</span><span class="token number">2006</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-4-3-添加分片数据库" tabindex="-1"><a class="header-anchor" href="#_3-4-3-添加分片数据库"><span>3.4.3 添加分片数据库</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mongo localhost<span class="token operator">:</span><span class="token number">2006</span></span>
<span class="line">use admin</span>
<span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">addshard</span><span class="token operator">:</span> <span class="token string">&#39;shard1/localhost:2001,localhost:2002&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">addshard</span><span class="token operator">:</span> <span class="token string">&#39;shard2/localhost:2003,localhost:2004&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-4-5-在路由服务器打开数据分片功能" tabindex="-1"><a class="header-anchor" href="#_3-4-5-在路由服务器打开数据分片功能"><span>3.4.5 在路由服务器打开数据分片功能</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">use admin<span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">enablesharding</span><span class="token operator">:</span> <span class="token string">&#39;school&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">shardcollection</span><span class="token operator">:</span> <span class="token string">&#39;school.students&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-参考" tabindex="-1"><a class="header-anchor" href="#_4-参考"><span>4. 参考</span></a></h2><ul><li><a href="https://docs.mongodb.com/manual/reference/configuration-options/" target="_blank" rel="noopener noreferrer">configuration-options</a></li></ul>`,69)])])}const r=a(t,[["render",l]]),c=JSON.parse('{"path":"/strong/29.mongodb-4.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/29.mongodb-4.md"}');export{r as comp,c as data};
