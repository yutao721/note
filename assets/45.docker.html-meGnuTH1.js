import{_ as c,c as d,a as e,b as s,e as n,d as t,w as l,r as p,o as u}from"./app-CD1YpnS1.js";const k={},m={style:{"text-align":"left"}};function v(g,a){const r=p("container"),i=p("dest"),o=p("src");return u(),d("div",null,[a[22]||(a[22]=e(`<h2 id="_1-布署软件的问题" tabindex="-1"><a class="header-anchor" href="#_1-布署软件的问题"><span>1. 布署软件的问题</span></a></h2><ul><li>如果想让软件运行起来要保证操作系统的设置，各种库和组件的安装都是正确的</li><li>热带鱼&amp;冷水鱼 冷水鱼适应的水温在5-30度，而热带鱼只能适应22-30度水温，低于22度半小时就冻死了</li></ul><h2 id="_2-虚拟机" tabindex="-1"><a class="header-anchor" href="#_2-虚拟机"><span>2. 虚拟机</span></a></h2><ul><li>虚拟机（virtual machine）就是带环境安装的一种解决方案。它可以在一种操作系统里面运行另一种操作系统 <ul><li>资源占用多</li><li>冗余步骤多</li><li>启动速度慢</li></ul></li></ul><h2 id="_3-linux-容器" tabindex="-1"><a class="header-anchor" href="#_3-linux-容器"><span>3. Linux 容器</span></a></h2><ul><li>由于虚拟机存在这些缺点，Linux 发展出了另一种虚拟化技术：Linux 容器（Linux Containers，缩写为 LXC）。</li><li>Linux 容器不是模拟一个完整的操作系统，而是对进程进行隔离。或者说，在正常进程的外面套了一个保护层。对于容器里面的进程来说，它接触到的各种资源都是虚拟的，从而实现与底层系统的隔离。 <ul><li>启动快</li><li>资源占用少</li><li>体积小</li></ul></li></ul><h2 id="_4-docker-是什么" tabindex="-1"><a class="header-anchor" href="#_4-docker-是什么"><span>4. Docker 是什么</span></a></h2><ul><li>Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。它是目前最流行的 Linux 容器解决方案。</li><li>Docker 将应用程序与该程序的依赖，打包在一个文件里面。运行这个文件，就会生成一个虚拟容器。程序在这个虚拟容器里运行，就好像在真实的物理机上运行一样</li></ul><h2 id="_5-docker和kvm" tabindex="-1"><a class="header-anchor" href="#_5-docker和kvm"><span>5. docker和KVM</span></a></h2><ul><li>启动时间 <ul><li>Docker秒级启动</li><li>KVM分钟级启动</li></ul></li><li>轻量级 容器镜像通常以M为单位，虚拟机以G为单位，容器资源占用小，要比虚拟要部署更快速 <ul><li>容器共享宿主机内核，系统级虚拟化，占用资源少，容器性能基本接近物理机</li><li>虚拟机需要虚拟化一些设备，具有完整的OS,虚拟机开销大，因而降低性能，没有容器性能好</li></ul></li><li>安全性 <ul><li>由于共享宿主机内核，只是进程隔离，因此隔离性和稳定性不如虚拟机，容器具有一定权限访问宿主机内核，存在一下安全隐患</li></ul></li><li>使用要求 <ul><li>KVM基于硬件的完全虚拟化，需要硬件CPU虚拟化技术支持</li><li>容器共享宿主机内核，可运行在主机的Linux的发行版，不用考虑CPU是否支持虚拟化技术</li></ul></li></ul><h2 id="_6-docker应用场景" tabindex="-1"><a class="header-anchor" href="#_6-docker应用场景"><span>6. docker应用场景</span></a></h2><ul><li>节省项目环境部署时间 <ul><li>单项目打包</li><li>整套项目打包</li><li>新开源技术</li></ul></li><li>环境一致性</li><li>持续集成</li><li>微服务</li><li>弹性伸缩</li></ul><h2 id="_7-docker-体系结构" tabindex="-1"><a class="header-anchor" href="#_7-docker-体系结构"><span>7. Docker 体系结构</span></a></h2><ul><li>containerd 是一个守护进程，使用runc管理容器，向Docker Engine提供接口</li><li>shim 只负责管理一个容器</li><li>runC是一个轻量级工具，只用来运行容器</li></ul><p><img src="http://img.zhufengpeixun.cn/dockerarch.png" alt="dockerarch"></p><h2 id="_8-docker内部组件" tabindex="-1"><a class="header-anchor" href="#_8-docker内部组件"><span>8. Docker内部组件</span></a></h2><ul><li><code>namespaces</code> 命名空间，Linux内核提供的一种对进程资源隔离的机制，例如进程、网络、挂载等资源</li><li><code>cgroups</code> 控制组,linux内核提供的一种限制进程资源的机制，例如cpu 内存等资源</li><li><code>unonFS</code> 联合文件系统，支持将不同位置的目录挂载到同一虚拟文件系统，形成一种分层的模型</li></ul><h2 id="_9-docker安装" tabindex="-1"><a class="header-anchor" href="#_9-docker安装"><span>9. docker安装</span></a></h2><ul><li>docker分为企业版(EE)和社区版(CE)</li><li><a href="https://docs.docker.com/install/linux/docker-ce/centos/" target="_blank" rel="noopener noreferrer">docker-ce</a></li><li><a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">hub.docker</a></li></ul><h3 id="_9-1-安装" tabindex="-1"><a class="header-anchor" href="#_9-1-安装"><span>9.1 安装</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">yum install -y yum-utils   device-mapper-persistent-data   lvm2</span>
<span class="line">yum-config-manager     --add-repo     https://download.docker.com/linux/centos/docker-ce.repo</span>
<span class="line"> yum-config-manager --enable docker-ce-nightly </span>
<span class="line">yum-config-manager --enable docker-ce-test  </span>
<span class="line">yum install docker-ce docker-ce-cli containerd.io</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-2-启动" tabindex="-1"><a class="header-anchor" href="#_9-2-启动"><span>9.2 启动</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">systemctl start docker</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_9-3-查看docker版本" tabindex="-1"><a class="header-anchor" href="#_9-3-查看docker版本"><span>9.3 查看docker版本</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ docker version</span>
<span class="line">$ docker info</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-4-卸载" tabindex="-1"><a class="header-anchor" href="#_9-4-卸载"><span>9.4 卸载</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker info</span>
<span class="line">yum remove docker</span>
<span class="line">rm <span class="token operator">-</span>rf <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>docker</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_10-docker架构" tabindex="-1"><a class="header-anchor" href="#_10-docker架构"><span>10. Docker架构</span></a></h2><p><img src="http://img.zhufengpeixun.cn/docker-arch.jpg" alt="docker"></p><h2 id="_11-阿里云加速" tabindex="-1"><a class="header-anchor" href="#_11-阿里云加速"><span>11.阿里云加速</span></a></h2><ul><li><a href="https://dev.aliyun.com/search.html" target="_blank" rel="noopener noreferrer">镜像仓库</a></li><li><a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors" target="_blank" rel="noopener noreferrer">镜像加速器</a></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">sudo mkdir <span class="token operator">-</span>p <span class="token operator">/</span>etc<span class="token operator">/</span>docker</span>
<span class="line">sudo tee <span class="token operator">/</span>etc<span class="token operator">/</span>docker<span class="token operator">/</span>daemon<span class="token punctuation">.</span>json <span class="token operator">&lt;&lt;</span><span class="token operator">-</span><span class="token string">&#39;EOF&#39;</span></span>
<span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token string-property property">&quot;registry-mirrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://fwvjnv59.mirror.aliyuncs.com&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token constant">EOF</span></span>
<span class="line">sudo systemctl daemon<span class="token operator">-</span>reload</span>
<span class="line">sudo systemctl restart docker</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_12-image镜像" tabindex="-1"><a class="header-anchor" href="#_12-image镜像"><span>12. image镜像</span></a></h2><ul><li>Docker 把应用程序及其依赖，打包在 image 文件里面。只有通过这个文件，才能生成 Docker 容器</li><li>image 文件可以看作是容器的模板</li><li>Docker 根据 image 文件生成容器的实例</li><li>同一个 image 文件，可以生成多个同时运行的容器实例</li><li>镜像不是一个单一的文件，而是有多层</li><li>容器其实就是在镜像的最上面加了一层读写层，在运行容器里做的任何文件改动，都会写到这个读写层里。如果容器删除了，最上面的读写层也就删除了，改动也就丢失了</li><li>我们可以通过<code>docker history &lt;ID/NAME&gt;</code> 查看镜像中各层内容及大小，每层对应着<code>Dockerfile</code>中的一条指令</li></ul><table><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">含义</th><th style="text-align:left;">案例</th></tr></thead><tbody><tr><td style="text-align:left;">ls</td><td style="text-align:left;">查看全部镜像</td><td style="text-align:left;">docker image ls</td></tr><tr><td style="text-align:left;">search</td><td style="text-align:left;">查找镜像</td><td style="text-align:left;">docker search [imageName]</td></tr><tr><td style="text-align:left;">history</td><td style="text-align:left;">查看镜像历史</td><td style="text-align:left;">docker history [imageName]</td></tr><tr><td style="text-align:left;">inspect</td><td style="text-align:left;">显示一个或多个镜像详细信息</td><td style="text-align:left;">docker inspect [imageName]</td></tr><tr><td style="text-align:left;">pull</td><td style="text-align:left;">拉取镜像</td><td style="text-align:left;">docker pull [imageName]</td></tr><tr><td style="text-align:left;">push</td><td style="text-align:left;">推送一个镜像到镜像仓库</td><td style="text-align:left;">docker push [imageName]</td></tr><tr><td style="text-align:left;">rmi</td><td style="text-align:left;">删除镜像</td><td style="text-align:left;">docker rmi [imageName] docker image rmi 2</td></tr><tr><td style="text-align:left;">prune</td><td style="text-align:left;">移除未使用的镜像，没有被标记或补任何容器引用</td><td style="text-align:left;">docker image prune</td></tr><tr><td style="text-align:left;">tag</td><td style="text-align:left;">标记本地镜像，将其归入某一仓库</td><td style="text-align:left;">docker image tag [imageName] [username]/[repository]:[tag]</td></tr><tr><td style="text-align:left;">export</td><td style="text-align:left;">导出容器文件系统tar归档文件创建镜像</td><td style="text-align:left;">docker export -o mysqlv1.tar a404c6c174a2</td></tr><tr><td style="text-align:left;">import</td><td style="text-align:left;">导入容器快照文件系统tar归档文件创建镜像</td><td style="text-align:left;">docker import mysqlv1.tar zf/mysql:v2</td></tr><tr><td style="text-align:left;">save</td><td style="text-align:left;">保存一个或多个镜像到一个tar归档文件</td><td style="text-align:left;">docker save -o mysqlv2.tar zf/mysqlv2:v3</td></tr><tr><td style="text-align:left;">load</td><td style="text-align:left;">加载镜像存储文件来自tar归档或标准输入</td><td style="text-align:left;">docker load -i mysqlv2.tar</td></tr><tr><td style="text-align:left;">build</td><td style="text-align:left;">根据Dockerfile构建镜像</td><td style="text-align:left;"></td></tr></tbody></table><blockquote><p>用户既可以使用 <code>docker load</code> 来导入镜像存储文件到本地镜像库，也可以使用 <code>docker import</code> 来导入一个容器快照到本地镜像库。这两者的区别在于容器快照文件将丢弃所有的历史记录和元数据信息（即仅保存容器当时的快照状态），而镜像存储文件将保存完整记录，体积也要大。此外，从容器快照文件导入时可以重新指定标签等元数据信息。</p></blockquote><h3 id="_12-1-查看镜像" tabindex="-1"><a class="header-anchor" href="#_12-1-查看镜像"><span>12.1 查看镜像</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker image ls</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><table><thead><tr><th style="text-align:left;">字段</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">REPOSITORY</td><td style="text-align:left;">仓库地址</td></tr><tr><td style="text-align:left;">TAG</td><td style="text-align:left;">标签</td></tr><tr><td style="text-align:left;">IMAGE_ID</td><td style="text-align:left;">镜像ID</td></tr><tr><td style="text-align:left;">CREATED</td><td style="text-align:left;">创建时间</td></tr><tr><td style="text-align:left;">SIZE</td><td style="text-align:left;">镜像大小</td></tr></tbody></table><h3 id="_12-2-查找镜像" tabindex="-1"><a class="header-anchor" href="#_12-2-查找镜像"><span>12.2 查找镜像</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker search ubuntu</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><table><thead><tr><th style="text-align:left;">字段</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">NAME</td><td style="text-align:left;">名称</td></tr><tr><td style="text-align:left;">DESCRIPTION</td><td style="text-align:left;">描述</td></tr><tr><td style="text-align:left;">STARTS</td><td style="text-align:left;">星星的数量</td></tr><tr><td style="text-align:left;">OFFICIAL</td><td style="text-align:left;">是否官方源</td></tr></tbody></table><h3 id="_12-3-拉取镜像" tabindex="-1"><a class="header-anchor" href="#_12-3-拉取镜像"><span>12.3 拉取镜像</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker  pull docker.io/hello-world</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>docker image pull是抓取 image 文件的命令</li><li>docker.io/hello-world是 image 文件在仓库里面的位置，其中<code>docker.io</code>是 image的作者，hello-world是 image 文件的名字</li><li>Docker 官方提供的 image 文件，都放在<code>docker.io</code>组里面，所以它的是默认组，可以省略 <code>docker image pull hello-world</code></li></ul><h3 id="_12-4-删除镜像" tabindex="-1"><a class="header-anchor" href="#_12-4-删除镜像"><span>12.4 删除镜像</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker rmi  hello-world</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_13-容器" tabindex="-1"><a class="header-anchor" href="#_13-容器"><span>13. 容器</span></a></h2><ul><li><code>docker run</code> 命令会从 <code>image</code> 文件，生成一个正在运行的容器实例。</li><li><code>docker container run</code>命令具有自动抓取 image 文件的功能。如果发现本地没有指定的 image 文件，就会从仓库自动抓取</li><li>输出提示以后，hello world就会停止运行，容器自动终止。</li><li>有些容器不会自动终止</li><li>image 文件生成的容器实例，本身也是一个文件，称为容器文件</li><li>容器生成，就会同时存在两个文件： image 文件和容器文件</li><li>关闭容器并不会删除容器文件，只是容器停止运行</li></ul><h3 id="_13-1-命令" tabindex="-1"><a class="header-anchor" href="#_13-1-命令"><span>13.1 命令</span></a></h3><table><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">含义</th><th style="text-align:left;">案例</th></tr></thead><tbody><tr><td style="text-align:left;">run</td><td style="text-align:left;">从镜像运行一个容器</td><td style="text-align:left;">docker run ubuntu /bin/echo &#39;hello-world&#39;</td></tr><tr><td style="text-align:left;">ls</td><td style="text-align:left;">列出容器</td><td style="text-align:left;">docker container ls</td></tr><tr><td style="text-align:left;">inspect</td><td style="text-align:left;">显示一个或多个容器详细信息</td><td style="text-align:left;">docker inspect</td></tr><tr><td style="text-align:left;">attach</td><td style="text-align:left;">要attach上去的容器必须正在运行，可以同时连接上同一个container来共享屏幕</td><td style="text-align:left;">docker attach</td></tr><tr><td style="text-align:left;">stats</td><td style="text-align:left;">显示容器资源使用统计</td><td style="text-align:left;">docker container stats</td></tr><tr><td style="text-align:left;">top</td><td style="text-align:left;">显示一个容器运行的进程</td><td style="text-align:left;">docker container top</td></tr><tr><td style="text-align:left;">update</td><td style="text-align:left;">显示一个容器运行的进程</td><td style="text-align:left;">docker container update</td></tr><tr><td style="text-align:left;">port</td><td style="text-align:left;">更新一个或多个容器配置</td><td style="text-align:left;">docker container port</td></tr><tr><td style="text-align:left;">ps</td><td style="text-align:left;">查看当前运行的容器</td><td style="text-align:left;">docker ps -a -l</td></tr><tr><td style="text-align:left;">kill [containerId]</td><td style="text-align:left;">终止容器(发送SIGKILL )</td><td style="text-align:left;">docker kill [containerId]</td></tr><tr><td style="text-align:left;">rm [containerId]</td><td style="text-align:left;">删除容器</td><td style="text-align:left;">docker rm [containerId]</td></tr><tr><td style="text-align:left;">start [containerId]</td><td style="text-align:left;">启动已经生成、已经停止运行的容器文件</td><td style="text-align:left;">docker start [containerId]</td></tr><tr><td style="text-align:left;">stop [containerId]</td><td style="text-align:left;">终止容器运行 (发送 SIGTERM )</td><td style="text-align:left;">docker stop [containerId]</td></tr><tr><td style="text-align:left;">logs [containerId]</td><td style="text-align:left;">查看 docker 容器的输出</td><td style="text-align:left;">docker logs [containerId]</td></tr><tr><td style="text-align:left;">exec [containerId]</td><td style="text-align:left;">进入一个正在运行的 docker 容器执行命令</td><td style="text-align:left;">docker container exec -it [containerID] /bin/bash</td></tr><tr><td style="text-align:left;">cp [containerId]</td><td style="text-align:left;">从正在运行的 Docker 容器里面，将文件拷贝到本机</td><td style="text-align:left;">docker container cp [containID]:app/package.json .</td></tr><tr><td style="text-align:left;">commit [containerId]</td><td style="text-align:left;">创建一个新镜像来自一个容器</td><td style="text-align:left;">docker commit -a &quot;zhufeng&quot; -m &quot;mysql&quot; a404c6c174a2 mynginx:v1</td></tr></tbody></table><h3 id="_13-2-启动容器" tabindex="-1"><a class="header-anchor" href="#_13-2-启动容器"><span>13.2 启动容器</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker run ubuntu <span class="token operator">/</span>bin<span class="token operator">/</span>echo <span class="token string">&quot;Hello world&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>docker: Docker 的二进制执行文件。</li><li>run:与前面的 docker 组合来运行一个容器。</li><li>ubuntu指定要运行的镜像，Docker首先从本地主机上查找镜像是否存在，如果不存在，Docker 就会从镜像仓库 Docker Hub 下载公共镜像。</li><li>/bin/echo &quot;Hello world&quot;: 在启动的容器里执行的命令</li></ul><blockquote><p>Docker以ubuntu镜像创建一个新容器，然后在容器里执行 bin/echo &quot;Hello world&quot;，然后输出结果</p></blockquote><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-i --interactive</td><td style="text-align:left;">交互式</td></tr><tr><td style="text-align:left;">-t --tty</td><td style="text-align:left;">分配一个伪终端</td></tr><tr><td style="text-align:left;">-d --detach</td><td style="text-align:left;">运行容器到后台</td></tr><tr><td style="text-align:left;">-a --attach list</td><td style="text-align:left;">附加到运行的容器</td></tr><tr><td style="text-align:left;">-e --env list</td><td style="text-align:left;">设置环境变量</td></tr><tr><td style="text-align:left;">-p --publish list</td><td style="text-align:left;">发布容器端口到主机</td></tr><tr><td style="text-align:left;">-P</td><td style="text-align:left;">--publish-all</td></tr><tr><td style="text-align:left;">--mount mount</td><td style="text-align:left;">挂载宿主机分区到容器</td></tr><tr><td style="text-align:left;">-v,--volumn list</td><td style="text-align:left;">挂载宿主机分区到容器</td></tr></tbody></table><h3 id="_13-3-查看容器" tabindex="-1"><a class="header-anchor" href="#_13-3-查看容器"><span>13.3 查看容器</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker ps</span>
<span class="line">docker -a</span>
<span class="line">docker -l</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>-a 显示所有的容器，包括已停止的</li><li>-l 显示最新的那个容器</li></ul><table><thead><tr><th style="text-align:left;">字段</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">CONTAINER ID</td><td style="text-align:left;">容器ID</td></tr><tr><td style="text-align:left;">IMAGE</td><td style="text-align:left;">使用的镜像</td></tr><tr><td style="text-align:left;">COMMAND</td><td style="text-align:left;">使用的命令</td></tr><tr><td style="text-align:left;">CREATED</td><td style="text-align:left;">创建时间</td></tr><tr><td style="text-align:left;">STATUS</td><td style="text-align:left;">状态</td></tr><tr><td style="text-align:left;">PORTS</td><td style="text-align:left;">端口号</td></tr><tr><td style="text-align:left;">NAMES</td><td style="text-align:left;">自动分配的名称</td></tr></tbody></table><h3 id="_13-4-运行交互式的容器" tabindex="-1"><a class="header-anchor" href="#_13-4-运行交互式的容器"><span>13.4 运行交互式的容器</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker run -i -t ubuntu /bin/bash</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>-t=--interactive 在新容器内指定一个伪终端或终端。</li><li>-i=--tty 允许你对容器内的标准输入 (STDIN) 进行交互。</li></ul><blockquote><p>我们可以通过运行exit命令或者使用CTRL+D来退出容器。</p></blockquote><h3 id="_13-5-后台运行容器" tabindex="-1"><a class="header-anchor" href="#_13-5-后台运行容器"><span>13.5 后台运行容器</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker run --detach centos ping www.baidu.com</span>
<span class="line">docker ps </span>
<span class="line">docker logs --follow ad04d9acde94</span>
<span class="line">docker stop ad04d9acde94</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_13-6-kill" tabindex="-1"><a class="header-anchor" href="#_13-6-kill"><span>13.6 kill</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker kill 5a5c3a760f61</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>kill是不管容器同不同意，直接执行<code>kill -9</code>，强行终止；stop的话，首先给容器发送一个<code>TERM</code>信号，让容器做一些退出前必须的保护性、安全性操作，然后让容器自动停止运行，如果在一段时间内，容器还是没有停止，再进行kill -9，强行终止</p></blockquote><h3 id="_13-7-删除容器" tabindex="-1"><a class="header-anchor" href="#_13-7-删除容器"><span>13.7 删除容器</span></a></h3>`,70)),s("ul",null,[s("li",null,[a[1]||(a[1]=n("docker rm ",-1)),t(r,null,{default:l(()=>[...a[0]||(a[0]=[n("删除容器",-1)])]),_:1})]),a[2]||(a[2]=s("li",null,[n("docker rmi "),s("img",{src:"",alt:""}),n(" 删除镜像")],-1)),a[3]||(a[3]=s("li",null,"docker rm $(docker ps -a -q)",-1))]),a[23]||(a[23]=e(`<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker rm 5a5c3a760f61</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_13-8-启动容器" tabindex="-1"><a class="header-anchor" href="#_13-8-启动容器"><span>13.8 启动容器</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker start [containerId]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_13-9-停止容器" tabindex="-1"><a class="header-anchor" href="#_13-9-停止容器"><span>13.9 停止容器</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker stop [containerId]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_13-10-进入一个容器" tabindex="-1"><a class="header-anchor" href="#_13-10-进入一个容器"><span>13.10 进入一个容器</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker attach [containerID]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_13-11-进入一个正在运行中的容器" tabindex="-1"><a class="header-anchor" href="#_13-11-进入一个正在运行中的容器"><span>13.11 进入一个正在运行中的容器</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker container -exec -it [containerID] /bin/bash</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_13-12-拷贝文件" tabindex="-1"><a class="header-anchor" href="#_13-12-拷贝文件"><span>13.12 拷贝文件</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker container cp [containerID] /readme.md .</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_13-13-自动删除" tabindex="-1"><a class="header-anchor" href="#_13-13-自动删除"><span>13.13 自动删除</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker run --rm ubuntu /bin/bash</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_14-制作个性化镜像" tabindex="-1"><a class="header-anchor" href="#_14-制作个性化镜像"><span>14. 制作个性化镜像</span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker commit <span class="token operator">-</span>m<span class="token string">&quot;hello&quot;</span> <span class="token operator">-</span>a <span class="token string">&quot;zhangrenyang&quot;</span> <span class="token punctuation">[</span>containerId<span class="token punctuation">]</span> zhangrenyang<span class="token operator">/</span>hello<span class="token operator">:</span>latest</span>
<span class="line">docker images</span>
<span class="line">docker run zhangrenyang<span class="token operator">/</span>hello <span class="token operator">/</span>bin<span class="token operator">/</span>bash</span>
<span class="line">docker rm b2839066c362</span>
<span class="line">docker rmi c79ef5b3f5fc</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_15-制作dockerfile" tabindex="-1"><a class="header-anchor" href="#_15-制作dockerfile"><span>15. 制作Dockerfile</span></a></h2><ul><li>Docker 的镜像是用一层一层的文件组成的</li><li><code>docker inspect</code>命令可以查看镜像或者容器</li><li>Layers就是镜像的层文件，只读不能修改。基于镜像创建的容器会共享这些文件层</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker inspect centos</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_15-1-编写dockerfile" tabindex="-1"><a class="header-anchor" href="#_15-1-编写dockerfile"><span>15.1 编写Dockerfile</span></a></h3><table><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">含义</th><th style="text-align:left;">案例</th></tr></thead><tbody><tr><td style="text-align:left;">FROM</td><td style="text-align:left;">继承的镜像</td><td style="text-align:left;">FROM node</td></tr><tr><td style="text-align:left;">COPY</td><td style="text-align:left;">拷贝</td><td style="text-align:left;">COPY ./app /app</td></tr><tr><td style="text-align:left;">WORKDIR</td><td style="text-align:left;">指定工作路径</td><td style="text-align:left;">WORKDIR /app</td></tr><tr><td style="text-align:left;">RUN</td><td style="text-align:left;">编译打包阶段运行命令</td><td style="text-align:left;">RUN npm install</td></tr><tr><td style="text-align:left;">EXPOSE</td><td style="text-align:left;">暴露端口</td><td style="text-align:left;">EXPOSE 3000</td></tr><tr><td style="text-align:left;">CMD</td><td style="text-align:left;">容器运行阶段运行命令</td><td style="text-align:left;">CMD npm run start</td></tr></tbody></table><h3 id="_15-2-dockerignore" tabindex="-1"><a class="header-anchor" href="#_15-2-dockerignore"><span>15.2 .dockerignore</span></a></h3><p>表示要排除，不要打包到image中的文件路径</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">.git</span>
<span class="line">node_modules</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_15-3-dockerfile" tabindex="-1"><a class="header-anchor" href="#_15-3-dockerfile"><span>15.3 Dockerfile</span></a></h3><h4 id="_15-3-1-安装node" tabindex="-1"><a class="header-anchor" href="#_15-3-1-安装node"><span>15.3.1 安装node</span></a></h4><ul><li><p><a href="https://github.com/creationix/nvm/blob/master/README.md" target="_blank" rel="noopener noreferrer">nvm</a></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">wget <span class="token operator">-</span>qO<span class="token operator">-</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>raw<span class="token punctuation">.</span>githubusercontent<span class="token punctuation">.</span>com<span class="token operator">/</span>creationix<span class="token operator">/</span>nvm<span class="token operator">/</span>v0<span class="token punctuation">.</span><span class="token number">33.11</span><span class="token operator">/</span>install<span class="token punctuation">.</span>sh <span class="token operator">|</span> bash</span>
<span class="line">nvm install stable</span>
<span class="line">node <span class="token operator">-</span>v</span>
<span class="line">npm i cnpm <span class="token operator">-</span>g</span>
<span class="line">npm i nrm <span class="token operator">-</span>g</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_15-3-2-安装express项目生成器" tabindex="-1"><a class="header-anchor" href="#_15-3-2-安装express项目生成器"><span>15.3.2 安装express项目生成器</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">npm install express-generator -g</span>
<span class="line">express app</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_15-3-3-dockerfile" tabindex="-1"><a class="header-anchor" href="#_15-3-3-dockerfile"><span>15.3.3 Dockerfile</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token constant">FROM</span> node</span>
<span class="line"><span class="token constant">COPY</span> <span class="token punctuation">.</span><span class="token operator">/</span>app <span class="token operator">/</span>app</span>
<span class="line"><span class="token constant">WORKDIR</span> <span class="token operator">/</span>app</span>
<span class="line"><span class="token constant">RUN</span> npm install</span>
<span class="line"><span class="token constant">EXPOSE</span> <span class="token number">3000</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>FROM 表示该镜像继承的镜像 :表示标签</li><li>COPY 是将当前目录下的app目录下面的文件都拷贝到image里的/app目录中</li><li>WORKDIR 指定工作路径，类似于执行 <code>cd</code> 命令</li><li>RUN npm install 在/app目录下安装依赖，安装后的依赖也会打包到image目录中</li><li>EXPOSE 暴露3000端口，允许外部连接这个端口</li></ul><h3 id="_15-4-创建image" tabindex="-1"><a class="header-anchor" href="#_15-4-创建image"><span>15.4 创建image</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker build -t express-demo .</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>-t用来指定image镜像的名称，后面还可以加冒号指定标签，如果不指定默认就是latest</li><li><code>.</code> 表示Dockerfile文件的所有路径,<code>.</code>就表示当前路径</li></ul><h3 id="_15-5-使用新的镜像运行容器" tabindex="-1"><a class="header-anchor" href="#_15-5-使用新的镜像运行容器"><span>15.5 使用新的镜像运行容器</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker container run <span class="token operator">-</span>p <span class="token number">3333</span><span class="token operator">:</span><span class="token number">3000</span> <span class="token operator">-</span>it express<span class="token operator">-</span>demo <span class="token operator">/</span>bin<span class="token operator">/</span>bash</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">npm start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>-p</code> 参数是将容器的3000端口映射为本机的3333端口</li><li><code>-it</code> 参数是将容器的shell容器映射为当前的shell,在本机容器中执行的命令都会发送到容器当中执行</li><li><code>express-demo</code> image的名称</li><li>/bin/bash 容器启动后执行的第一个命令,这里是启动了bash容器以便执行脚本</li><li><code>--rm</code> 在容器终止运行后自动删除容器文件</li></ul><h3 id="_15-6-cmd" tabindex="-1"><a class="header-anchor" href="#_15-6-cmd"><span>15.6 CMD</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">CMD npm start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>RUN命令在 image 文件的构建阶段执行，执行结果都会打包进入 image 文件；CMD命令则是在容器启动后执行</li><li>一个 Dockerfile 可以包含多个RUN命令，但是只能有一个CMD命令</li><li>指定了CMD命令以后，docker container run命令就不能附加命令了（比如前面的/bin/bash），否则它会覆盖CMD命令</li></ul><h3 id="_15-7-发布image" tabindex="-1"><a class="header-anchor" href="#_15-7-发布image"><span>15.7 发布image</span></a></h3><ul><li><a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">注册账户</a></li><li>docker tag SOURCE_IMAGE[:TAG] TARGET_IMAGE[:TAG]</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker login</span>
<span class="line">docker image tag <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span> <span class="token punctuation">[</span>username<span class="token punctuation">]</span><span class="token operator">/</span><span class="token punctuation">[</span>repository<span class="token punctuation">]</span><span class="token operator">:</span><span class="token punctuation">[</span>tag<span class="token punctuation">]</span></span>
<span class="line">docker image build <span class="token operator">-</span>t <span class="token punctuation">[</span>username<span class="token punctuation">]</span><span class="token operator">/</span><span class="token punctuation">[</span>repository<span class="token punctuation">]</span><span class="token operator">:</span><span class="token punctuation">[</span>tag<span class="token punctuation">]</span> <span class="token punctuation">.</span></span>
<span class="line"></span>
<span class="line">docker tag express<span class="token operator">-</span>demo zhangrenyang<span class="token operator">/</span>express<span class="token operator">-</span>demo<span class="token operator">:</span><span class="token number">1.0</span><span class="token number">.0</span></span>
<span class="line">docker push zhangrenyang<span class="token operator">/</span>express<span class="token operator">-</span>demo<span class="token operator">:</span><span class="token number">1.0</span><span class="token number">.0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_16-数据盘" tabindex="-1"><a class="header-anchor" href="#_16-数据盘"><span>16. 数据盘</span></a></h2><ul><li>删除容器的时候，容器层里创建的文件也会被删除掉，如果有些数据你想永久保存，比如Web服务器的日志，数据库管理系统中的数据，可以为容器创建一个数据盘</li></ul><p><img src="http://img.zhufengpeixun.cn/bindmount.png" alt="bindmount"></p><h3 id="_16-1-volume" tabindex="-1"><a class="header-anchor" href="#_16-1-volume"><span>16.1 volume</span></a></h3><ul><li>volumes Docker管理宿主机文件系统的一部分(/var/lib/docker/volumes)</li><li>如果没有指定卷，则会自动创建</li><li>建议使用--mount ,更通用</li></ul><h3 id="_16-1-1-创建数据卷" tabindex="-1"><a class="header-anchor" href="#_16-1-1-创建数据卷"><span>16.1.1 创建数据卷</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker volume --help</span>
<span class="line">docker volume create nginx-vol</span>
<span class="line">docker volume ls</span>
<span class="line">docker volume inspect nginx-vol</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">docker run -d -it --name=nginx1 --mount src=nginx-vol,dst=/usr/share/nginx/html nginx</span>
<span class="line">docker run -d -it --name=nginx2 -v nginx-vol:/usr/share/nginx/html nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_16-1-2-删除数据卷" tabindex="-1"><a class="header-anchor" href="#_16-1-2-删除数据卷"><span>16.1.2 删除数据卷</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker container stop nginx1 停止容器</span>
<span class="line">docker container rm nginx1 删除容器</span>
<span class="line">docker volume rm nginx-vol  删除数据库</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_16-1-3-管理数据盘" tabindex="-1"><a class="header-anchor" href="#_16-1-3-管理数据盘"><span>16.1.3 管理数据盘</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> docker volume ls </span>
<span class="line"> docker volume ls -f dangling=true </span>
<span class="line"> docker volume rm xxxx </span>
<span class="line"> docker volume ls      </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_16-2-bind-mounts" tabindex="-1"><a class="header-anchor" href="#_16-2-bind-mounts"><span>16.2 Bind mounts</span></a></h3><ul><li>此方式与Linux系统的mount方式很相似，即是会覆盖容器内已存在的目录或文件，但并不会改变容器内原有的文件，当umount后容器内原有的文件就会还原</li><li>创建容器的时候我们可以通过<code>-v</code>或<code>--volumn</code>给它指定一下数据盘</li><li><code>bind mounts</code> 可以存储在宿主机系统的任意位置</li><li>如果源文件/目录不存在，不会自动创建，会抛出一个错误</li><li>如果挂载目标在容器中非空目录，则该目录现有内容将被隐藏</li></ul><h4 id="_16-2-1-默认数据盘" tabindex="-1"><a class="header-anchor" href="#_16-2-1-默认数据盘"><span>16.2.1 默认数据盘</span></a></h4><ul><li>-v 参数两种挂载数据方式都可以用</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker run -v /mnt:/mnt -it --name logs centos bash</span>
<span class="line">cd /mnt</span>
<span class="line">echo 1 &gt; 1.txt</span>
<span class="line">exit</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker inspect logs</span>
<span class="line"><span class="token string-property property">&quot;Mounts&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;Source&quot;</span><span class="token operator">:</span><span class="token string">&quot;/mnt/sda1/var/lib/docker/volumes/dea6a8b3aefafa907d883895bbf931a502a51959f83d63b7ece8d7814cf5d489/_data&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;Destination&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/mnt&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>Source</code>的值就是我们给容器指定的数据盘在主机上的位置</li><li><code>Destination</code>的值是这个数据盘在容器上的位置</li></ul><h4 id="_16-2-2-指定数据盘" tabindex="-1"><a class="header-anchor" href="#_16-2-2-指定数据盘"><span>16.2.2 指定数据盘</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">mkdir ~/data</span>
<span class="line">docker run -v ~/data:/mnt -ti --name logs2 centos bash</span>
<span class="line">cd /mnt</span>
<span class="line">echo 3 &gt; 3.txt</span>
<span class="line">exit</span>
<span class="line">cat ~/data/3.txt</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>~/data:/mnt 把当前用户目录中的<code>data</code>目录映射到<code>/mnt</code>上</li></ul><h4 id="_16-2-3-指定数据盘容器" tabindex="-1"><a class="header-anchor" href="#_16-2-3-指定数据盘容器"><span>16.2.3 指定数据盘容器</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker create <span class="token operator">-</span>v <span class="token operator">/</span>mnt <span class="token operator">--</span>name logger centos</span>
<span class="line">docker run <span class="token operator">--</span>volumes<span class="token operator">-</span>from logger <span class="token operator">--</span>name logger3 <span class="token operator">-</span>i <span class="token operator">-</span>t centos bash</span>
<span class="line">cd <span class="token operator">/</span>mnt </span>
<span class="line">touch logger3</span>
<span class="line">docker run <span class="token operator">--</span>volumes<span class="token operator">-</span>from logger <span class="token operator">--</span>name logger4 <span class="token operator">-</span>i <span class="token operator">-</span>t centos bash</span>
<span class="line">cd <span class="token operator">/</span>mnt</span>
<span class="line">touch logger4</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_17-网络" tabindex="-1"><a class="header-anchor" href="#_17-网络"><span>17. 网络</span></a></h2><p>docker里面有一个DNS服务，可以通过容器名称访问主机 网络类型</p><ul><li>none 无网络，对外界完全隔离</li><li>host 主机网络</li><li>bridge 桥接网络，默认网络</li></ul><h3 id="_17-1-bridge" tabindex="-1"><a class="header-anchor" href="#_17-1-bridge"><span>17.1 bridge</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker network ls</span>
<span class="line">docker inspect bridge</span>
<span class="line">docker run -d --name server1 nginx</span>
<span class="line">docker run -d --name server2 nginx</span>
<span class="line">docker exec -it server1 bash</span>
<span class="line">ping server2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_17-2-none" tabindex="-1"><a class="header-anchor" href="#_17-2-none"><span>17.2 none</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker run -d --name server_none --net none nginx</span>
<span class="line">docker inspect none</span>
<span class="line">docker exec -it server_none bash</span>
<span class="line">ip addr</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_17-3-host" tabindex="-1"><a class="header-anchor" href="#_17-3-host"><span>17.3 host</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker run -d --name server_host --net host nginx</span>
<span class="line">docker inspect none</span>
<span class="line">docker exec -it server_host bash</span>
<span class="line">ip addr</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_17-4-访问桥接网络里面的服务" tabindex="-1"><a class="header-anchor" href="#_17-4-访问桥接网络里面的服务"><span>17.4 访问桥接网络里面的服务</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker inspect nginx</span>
<span class="line"><span class="token number">443</span> <span class="token number">80</span></span>
<span class="line">docker run <span class="token operator">-</span>d <span class="token operator">--</span>name server_nginx <span class="token operator">-</span>p <span class="token string">&quot;8080:80&quot;</span>  nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>访问主机的8080端口会被定向到容器的80端口</li></ul><h3 id="_17-5-查看主机绑定的端口" tabindex="-1"><a class="header-anchor" href="#_17-5-查看主机绑定的端口"><span>17.5 查看主机绑定的端口</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker inspect [容器名称]</span>
<span class="line">docker port server_nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_17-6-指向主机的随机端口" tabindex="-1"><a class="header-anchor" href="#_17-6-指向主机的随机端口"><span>17.6 指向主机的随机端口</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker run <span class="token operator">-</span>d <span class="token operator">--</span>name webserver <span class="token operator">--</span>publish <span class="token number">80</span> nginx</span>
<span class="line">docker port webserver</span>
<span class="line"></span>
<span class="line">docker run <span class="token operator">-</span>d <span class="token operator">--</span>name webserver <span class="token operator">--</span>publish<span class="token operator">-</span>all nginx</span>
<span class="line">docker run <span class="token operator">-</span>d <span class="token operator">--</span>name webserver <span class="token operator">--</span><span class="token constant">P</span> nginx</span>
<span class="line">\`</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_17-7-创建自定义网络" tabindex="-1"><a class="header-anchor" href="#_17-7-创建自定义网络"><span>17.7 创建自定义网络</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker network create --driver bridge web</span>
<span class="line">docker network inspect web</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_17-8-制定网络" tabindex="-1"><a class="header-anchor" href="#_17-8-制定网络"><span>17.8 制定网络</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker run -d --name webserver  --net web nginx</span>
<span class="line">docker network connect  web webserver1</span>
<span class="line">docker network disconnect web webserver2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_18-compose" tabindex="-1"><a class="header-anchor" href="#_18-compose"><span>18.compose</span></a></h2><ul><li>Compose 通过一个配置文件来管理多个Docker容器，在配置文件中，所有的容器通过services来定义，然后使用docker-compose脚本来启动，停止和重启应用，和应用中的服务以及所有依赖服务的容器，非常适合组合使用多个容器进行开发的场景 步骤：</li><li>在 <code>docker-compose.yml</code> 中定义组成应用程序的服务，以便它们可以在隔离的环境中一起运行。</li><li>最后，运行<code>docker-compose up</code>，Compose 将启动并运行整个应用程序。 配置文件组成</li><li>services 可以定义需要的服务，每个服务都有自己的名字、使用的镜像、挂载的数据卷所属的网络和依赖的其它服务。</li><li>networks 是应用的网络，在它下面可以定义使用的网络名称，类性。</li><li>volumes是数据卷，可以在此定义数据卷，然后挂载到不同的服务上面使用。<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">pip install docker-compose</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h3 id="_18-1-docker-compose-yml" tabindex="-1"><a class="header-anchor" href="#_18-1-docker-compose-yml"><span>18.1 docker-compose.yml</span></a></h3><ul><li>空格缩进表示层次</li><li>冒号空格后面有空格</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span></span>
<span class="line"><span class="token literal-property property">services</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">zfpx1</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">image</span><span class="token operator">:</span> nginx</span>
<span class="line">    <span class="token literal-property property">port</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;8080:80&quot;</span></span>
<span class="line">  <span class="token literal-property property">zfpx2</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">image</span><span class="token operator">:</span> nginx</span>
<span class="line">    <span class="token literal-property property">port</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;8081:80&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_18-2-nginx工具包" tabindex="-1"><a class="header-anchor" href="#_18-2-nginx工具包"><span>18.2 nginx工具包</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">apt update</span>
<span class="line"> </span>
<span class="line">apt install inetutils-ping </span>
<span class="line"> </span>
<span class="line">apt install dnsutils   </span>
<span class="line"> </span>
<span class="line">apt install net-tools    </span>
<span class="line"> </span>
<span class="line">apt install iproute2     </span>
<span class="line"> </span>
<span class="line">apt install curl</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_18-3-启动" tabindex="-1"><a class="header-anchor" href="#_18-3-启动"><span>18.3 启动</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker-compose up 启动所有的服务</span>
<span class="line">docker-compose -d 后台启动所有的服务</span>
<span class="line">docker-compose ps 打印所有的容器</span>
<span class="line">docker-compose stop 停止所有服务</span>
<span class="line">docker-compose logs -f 持续跟踪日志</span>
<span class="line">docker-compose exec zfpx1 bash 进入zfpx服务系统</span>
<span class="line">docker-compose rm 删除服务容器</span>
<span class="line">docker network ls 网络不会删除</span>
<span class="line">docker-compose down 删除网路</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>docker会创建默认的网络</li></ul><h3 id="_18-4-配置网络" tabindex="-1"><a class="header-anchor" href="#_18-4-配置网络"><span>18.4 配置网络</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker-compose up -d</span>
<span class="line">docker-compose exec zfpx1 bash</span>
<span class="line">ping zfpx2 可以通过服务的名字连接到对方</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_18-5-配置数据卷" tabindex="-1"><a class="header-anchor" href="#_18-5-配置数据卷"><span>18.5 配置数据卷</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span></span>
<span class="line"><span class="token literal-property property">services</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">zfpx1</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">image</span><span class="token operator">:</span> nginx</span>
<span class="line">    <span class="token literal-property property">ports</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;8080:80&quot;</span></span>
<span class="line">    <span class="token literal-property property">networks</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;zfpx&quot;</span></span>
<span class="line">    <span class="token literal-property property">volumes</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;access:/mnt&quot;</span></span>
<span class="line">  <span class="token literal-property property">zfpx2</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">image</span><span class="token operator">:</span> nginx</span>
<span class="line">    <span class="token literal-property property">ports</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;8081:80&quot;</span></span>
<span class="line">    <span class="token literal-property property">networks</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;zfpx&quot;</span></span>
<span class="line">    <span class="token literal-property property">volumes</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;access:/mnt&quot;</span></span>
<span class="line">  <span class="token literal-property property">zfpx3</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">image</span><span class="token operator">:</span> nginx</span>
<span class="line">    <span class="token literal-property property">ports</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;8082:80&quot;</span></span>
<span class="line">    <span class="token literal-property property">networks</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;default&quot;</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;zfpx&quot;</span></span>
<span class="line"><span class="token literal-property property">networks</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">zfpx</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">driver</span><span class="token operator">:</span> bridge</span>
<span class="line"><span class="token literal-property property">volumes</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">access</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">driver</span><span class="token operator">:</span> local</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_18-6-配置根目录" tabindex="-1"><a class="header-anchor" href="#_18-6-配置根目录"><span>18.6 配置根目录</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span></span>
<span class="line"><span class="token literal-property property">services</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">zfpx1</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">image</span><span class="token operator">:</span> nginx</span>
<span class="line">    <span class="token literal-property property">ports</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;8080:80&quot;</span></span>
<span class="line">    <span class="token literal-property property">networks</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;zfpx&quot;</span></span>
<span class="line">    <span class="token literal-property property">volumes</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;access:/mnt&quot;</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;./zfpx1:/usr/share/nginx/html&quot;</span></span>
<span class="line">  <span class="token literal-property property">zfpx2</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">image</span><span class="token operator">:</span> nginx</span>
<span class="line">    <span class="token literal-property property">ports</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;8081:80&quot;</span></span>
<span class="line">    <span class="token literal-property property">networks</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;zfpx&quot;</span></span>
<span class="line">    <span class="token literal-property property">volumes</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;access:/mnt&quot;</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;./zfpx2:/usr/share/nginx/html&quot;</span></span>
<span class="line">  <span class="token literal-property property">zfpx3</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">image</span><span class="token operator">:</span> nginx</span>
<span class="line">    <span class="token literal-property property">ports</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;8082:80&quot;</span></span>
<span class="line">    <span class="token literal-property property">networks</span><span class="token operator">:</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;default&quot;</span></span>
<span class="line">      <span class="token operator">-</span> <span class="token string">&quot;zfpx&quot;</span></span>
<span class="line"><span class="token literal-property property">networks</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">zfpx</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">driver</span><span class="token operator">:</span> bridge</span>
<span class="line"><span class="token literal-property property">volumes</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">access</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">driver</span><span class="token operator">:</span> local</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_19-nodeapp" tabindex="-1"><a class="header-anchor" href="#_19-nodeapp"><span>19. nodeapp</span></a></h2><p>nodeapp 是一个用 Docker 搭建的本地 Node.js 应用开发与运行环境。</p><h3 id="_19-1-服务" tabindex="-1"><a class="header-anchor" href="#_19-1-服务"><span>19.1 服务</span></a></h3><ul><li>db：使用 <code>mariadb</code> 作为应用的数据库</li><li>node：启动<code>node</code>服务</li><li>web：使用 <code>nginx</code> 作为应用的 web 服务器</li></ul><h3 id="_19-2-结构" tabindex="-1"><a class="header-anchor" href="#_19-2-结构"><span>19.2 结构</span></a></h3><ul><li>app：这个目录存储应用 <ul><li>web 放应用的代码</li></ul></li><li>services： 环境里定义的服务需要的一些服务</li><li>images: 方式一些贬义的脚本和镜像</li><li>docker-compose.yml：定义本地开发环境需要的服务</li><li>images/nginx/config/default.conf 放置nginx 配置文件</li><li>node 的Dockfile配置文件</li></ul><h3 id="_19-3-docker-compose-yml" tabindex="-1"><a class="header-anchor" href="#_19-3-docker-compose-yml"><span>19.3 docker-compose.yml</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">&#39;2&#39;</span></span>
<span class="line"><span class="token literal-property property">services</span><span class="token operator">:</span></span>
<span class="line"> <span class="token literal-property property">node</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">build</span><span class="token operator">:</span></span>
<span class="line">    <span class="token literal-property property">context</span><span class="token operator">:</span> <span class="token punctuation">.</span><span class="token operator">/</span>images<span class="token operator">/</span>node</span>
<span class="line">    <span class="token literal-property property">dockerfile</span><span class="token operator">:</span> Dockerfile</span>
<span class="line">  <span class="token literal-property property">volumes</span><span class="token operator">:</span></span>
<span class="line">    <span class="token operator">-</span> <span class="token punctuation">.</span><span class="token operator">/</span>app<span class="token operator">/</span>web<span class="token operator">:</span><span class="token operator">/</span>web</span>
<span class="line">  <span class="token literal-property property">depends_on</span><span class="token operator">:</span></span>
<span class="line">   <span class="token operator">-</span> db</span>
<span class="line"> <span class="token literal-property property">web</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">image</span><span class="token operator">:</span> nginx</span>
<span class="line">  <span class="token literal-property property">ports</span><span class="token operator">:</span></span>
<span class="line">   <span class="token operator">-</span> <span class="token string">&quot;8080:80&quot;</span></span>
<span class="line">  <span class="token literal-property property">volumes</span><span class="token operator">:</span></span>
<span class="line">   <span class="token operator">-</span> <span class="token punctuation">.</span><span class="token operator">/</span>images<span class="token operator">/</span>nginx<span class="token operator">/</span>config<span class="token operator">:</span><span class="token operator">/</span>etc<span class="token operator">/</span>nginx<span class="token operator">/</span>conf<span class="token punctuation">.</span>d</span>
<span class="line">   <span class="token operator">-</span> <span class="token punctuation">.</span><span class="token operator">/</span>app<span class="token operator">/</span>web<span class="token operator">/</span>views<span class="token operator">:</span><span class="token operator">/</span>mnt<span class="token operator">/</span>views  </span>
<span class="line">  <span class="token literal-property property">depends_on</span><span class="token operator">:</span></span>
<span class="line">   <span class="token operator">-</span> node</span>
<span class="line"> <span class="token literal-property property">db</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">image</span><span class="token operator">:</span> mariadb</span>
<span class="line">  <span class="token literal-property property">environment</span><span class="token operator">:</span></span>
<span class="line">   <span class="token constant">MYSQL_ROOT_PASSWORD</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span></span>
<span class="line">   <span class="token constant">MYSQL_DATABASE</span><span class="token operator">:</span> <span class="token string">&quot;node&quot;</span></span>
<span class="line">   <span class="token constant">MYSQL_USER</span><span class="token operator">:</span> <span class="token string">&quot;zfpx&quot;</span></span>
<span class="line">   <span class="token constant">MYSQL_PASSWORD</span><span class="token operator">:</span> <span class="token string">&quot;123456&quot;</span></span>
<span class="line">  <span class="token literal-property property">volumes</span><span class="token operator">:</span></span>
<span class="line">    <span class="token operator">-</span> db<span class="token operator">:</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>mysql</span>
<span class="line"><span class="token literal-property property">volumes</span><span class="token operator">:</span></span>
<span class="line"> <span class="token literal-property property">db</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">driver</span><span class="token operator">:</span> local</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_19-4-其它文件" tabindex="-1"><a class="header-anchor" href="#_19-4-其它文件"><span>19.4 其它文件</span></a></h3><h4 id="_19-4-1-app-web-server-js" tabindex="-1"><a class="header-anchor" href="#_19-4-1-app-web-server-js"><span>19.4.1 app/web/server.js</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> http<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> mysql  <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mysql&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> connection <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">host</span>     <span class="token operator">:</span> <span class="token string">&#39;db&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">user</span>     <span class="token operator">:</span> <span class="token string">&#39;zfpx&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">password</span> <span class="token operator">:</span> <span class="token string">&#39;123456&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">database</span> <span class="token operator">:</span> <span class="token string">&#39;node&#39;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">connection<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> server<span class="token operator">=</span>http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    connection<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">&#39;SELECT 2 + 2 AS solution&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> results<span class="token punctuation">,</span> fields</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token keyword">throw</span> error<span class="token punctuation">;</span></span>
<span class="line">        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token operator">+</span>results<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>solution<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_19-4-2-package-json" tabindex="-1"><a class="header-anchor" href="#_19-4-2-package-json"><span>19.4.2 package.json</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">&quot;scripts&quot;: {</span>
<span class="line">    &quot;start&quot;: &quot;node server.js&quot;</span>
<span class="line">  },</span>
<span class="line">&quot;dependencies&quot;: {</span>
<span class="line">    &quot;mysql&quot;: &quot;^2.16.0&quot;</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_19-4-3-images-node-dockerfile" tabindex="-1"><a class="header-anchor" href="#_19-4-3-images-node-dockerfile"><span>19.4.3 images/node/Dockerfile</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token constant">FROM</span> node</span>
<span class="line"><span class="token constant">MAINTAINER</span> zhangrenyang <span class="token operator">&lt;</span>zhang_renyang@<span class="token number">126</span><span class="token punctuation">.</span>com<span class="token operator">&gt;</span></span>
<span class="line"><span class="token constant">WORKDIR</span> <span class="token operator">/</span>web</span>
<span class="line"><span class="token constant">RUN</span> npm install</span>
<span class="line"><span class="token constant">CMD</span> npm start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_19-4-4-images-nginx-config-default-conf" tabindex="-1"><a class="header-anchor" href="#_19-4-4-images-nginx-config-default-conf"><span>19.4.4 images/nginx/config/default.conf</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">upstream backend <span class="token punctuation">{</span></span>
<span class="line">    server node<span class="token operator">:</span><span class="token number">3000</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">server <span class="token punctuation">{</span></span>
<span class="line">    listen <span class="token number">80</span><span class="token punctuation">;</span></span>
<span class="line">    server_name localhost<span class="token punctuation">;</span></span>
<span class="line">    root <span class="token operator">/</span>mnt<span class="token operator">/</span>views<span class="token punctuation">;</span></span>
<span class="line">    index index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    location <span class="token operator">/</span>api <span class="token punctuation">{</span></span>
<span class="line">        proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>backend<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_20-搭建lnmp网站" tabindex="-1"><a class="header-anchor" href="#_20-搭建lnmp网站"><span>20. 搭建LNMP网站</span></a></h2><h3 id="_20-1-关闭防火墙" tabindex="-1"><a class="header-anchor" href="#_20-1-关闭防火墙"><span>20.1 关闭防火墙</span></a></h3><table><thead><tr><th style="text-align:left;">功能</th><th style="text-align:left;">命令</th></tr></thead><tbody><tr><td style="text-align:left;">停止防火墙</td><td style="text-align:left;">systemctl stop firewalld.service</td></tr><tr><td style="text-align:left;">永久关闭防火墙</td><td style="text-align:left;">systemctl disable firewalld.service</td></tr></tbody></table><h3 id="_20-2-创建自定义网络" tabindex="-1"><a class="header-anchor" href="#_20-2-创建自定义网络"><span>20.2 创建自定义网络</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker network create lnmp</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_20-3-创建mysql数据库容器" tabindex="-1"><a class="header-anchor" href="#_20-3-创建mysql数据库容器"><span>20.3 创建mysql数据库容器</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> docker run <span class="token operator">-</span>itd <span class="token operator">--</span>name lnmp_mysql <span class="token operator">--</span>net lnmp <span class="token operator">-</span>p <span class="token number">3306</span><span class="token operator">:</span><span class="token number">3306</span> <span class="token operator">--</span>mount src<span class="token operator">=</span>mysql<span class="token operator">-</span>vol<span class="token punctuation">,</span>dst<span class="token operator">=</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>mysql <span class="token operator">-</span>e <span class="token constant">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> <span class="token literal-property property">mysql</span><span class="token operator">:</span><span class="token number">5.6</span> <span class="token operator">--</span>character<span class="token operator">-</span>set<span class="token operator">-</span>server<span class="token operator">=</span>utf8</span>
<span class="line"> yum install <span class="token operator">-</span>y mysql</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_20-4-创建所需数据库" tabindex="-1"><a class="header-anchor" href="#_20-4-创建所需数据库"><span>20.4 创建所需数据库</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker exec lnmp_mysql bash <span class="token operator">-</span>c <span class="token string">&#39;exec mysql -uroot  -p&quot;$MYSQL_ROOT_PASSWORD&quot; -e&quot;create database wordpress&quot;&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_20-5-创建php容器" tabindex="-1"><a class="header-anchor" href="#_20-5-创建php容器"><span>20.5 创建PHP容器</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">mkdir <span class="token operator">-</span>p <span class="token operator">/</span>app<span class="token operator">/</span>wwwroot</span>
<span class="line">docker run <span class="token operator">-</span>itd <span class="token operator">--</span>name lnmp_web <span class="token operator">--</span>net lnmp <span class="token operator">-</span>p <span class="token number">8888</span><span class="token operator">:</span><span class="token number">80</span> <span class="token operator">--</span>mount type<span class="token operator">=</span>bind<span class="token punctuation">,</span>src<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>wwwroot<span class="token punctuation">,</span>dst<span class="token operator">=</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www<span class="token operator">/</span>html richarvey<span class="token operator">/</span>nginx<span class="token operator">-</span>php<span class="token operator">-</span>fpm</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_20-6-wordpress" tabindex="-1"><a class="header-anchor" href="#_20-6-wordpress"><span>20.6 wordpress</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">cd <span class="token operator">/</span>opt<span class="token operator">/</span>src</span>
<span class="line">wget https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>wordpress<span class="token punctuation">.</span>org<span class="token operator">/</span>latest<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line">tar <span class="token operator">-</span>xzvf latest<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">-</span><span class="token constant">C</span> <span class="token operator">/</span>app<span class="token operator">/</span>wwwroot</span>
<span class="line"><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token constant">IP</span><span class="token operator">:</span><span class="token number">88</span><span class="token operator">/</span>wordpress</span>
<span class="line"><span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">192.168</span><span class="token number">.20</span><span class="token number">.129</span><span class="token operator">:</span><span class="token number">8888</span><span class="token operator">/</span>wordpress<span class="token operator">/</span>wp<span class="token operator">-</span>admin<span class="token operator">/</span>setup<span class="token operator">-</span>config<span class="token punctuation">.</span>php</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_21-dockerfile" tabindex="-1"><a class="header-anchor" href="#_21-dockerfile"><span>21. Dockerfile</span></a></h2><h3 id="_21-1-语法" tabindex="-1"><a class="header-anchor" href="#_21-1-语法"><span>21.1 语法</span></a></h3>`,136)),s("table",null,[a[21]||(a[21]=s("thead",null,[s("tr",null,[s("th",{style:{"text-align":"left"}},"指令"),s("th",{style:{"text-align":"left"}},"含义"),s("th",{style:{"text-align":"left"}},"示例")])],-1)),s("tbody",null,[a[8]||(a[8]=s("tr",null,[s("td",{style:{"text-align":"left"}},"FROM"),s("td",{style:{"text-align":"left"}},"构建的新镜像是基于哪个镜像"),s("td",{style:{"text-align":"left"}},"FROM centos:6")],-1)),a[9]||(a[9]=s("tr",null,[s("td",{style:{"text-align":"left"}},"MAINTAINER"),s("td",{style:{"text-align":"left"}},"镜像维护者姓名或邮箱地址"),s("td",{style:{"text-align":"left"}},"MAINTAINER zhufengjiagou")],-1)),a[10]||(a[10]=s("tr",null,[s("td",{style:{"text-align":"left"}},"RUN"),s("td",{style:{"text-align":"left"}},"构建镜像时运行的shell命令"),s("td",{style:{"text-align":"left"}},"RUN yum install httpd")],-1)),a[11]||(a[11]=s("tr",null,[s("td",{style:{"text-align":"left"}},"CMD"),s("td",{style:{"text-align":"left"}},"CMD 设置容器启动后默认执行的命令及其参数，但 CMD 能够被 docker run 后面跟的命令行参数替换"),s("td",{style:{"text-align":"left"}},"CMD /usr/sbin/sshd -D")],-1)),a[12]||(a[12]=s("tr",null,[s("td",{style:{"text-align":"left"}},"EXPOSE"),s("td",{style:{"text-align":"left"}},"声明容器运行的服务器端口"),s("td",{style:{"text-align":"left"}},"EXPOSE 80 443")],-1)),a[13]||(a[13]=s("tr",null,[s("td",{style:{"text-align":"left"}},"ENV"),s("td",{style:{"text-align":"left"}},"设置容器内的环境变量"),s("td",{style:{"text-align":"left"}},"ENV MYSQL_ROOT_PASSWORD 123456")],-1)),s("tr",null,[a[6]||(a[6]=s("td",{style:{"text-align":"left"}},"ADD",-1)),a[7]||(a[7]=s("td",{style:{"text-align":"left"}},"拷贝文件或目录到镜像中，如果是URL或者压缩包会自动下载和解压",-1)),s("td",m,[a[5]||(a[5]=n("ADD ",-1)),t(o,null,{default:l(()=>[t(i,null,{default:l(()=>[...a[4]||(a[4]=[n(",ADD ",-1),s("a",{href:"https://xxx.com/html.tar.gz",target:"_blank",rel:"noopener noreferrer"},"https://xxx.com/html.tar.gz",-1),n(" /var/",-1),s("a",{href:"http://www.html",target:"_blank",rel:"noopener noreferrer"},"www.html",-1),n(", ADD html.tar.gz /var/www/html",-1)])]),_:1})]),_:1})])]),a[14]||(a[14]=s("tr",null,[s("td",{style:{"text-align":"left"}},"COPY"),s("td",{style:{"text-align":"left"}},"拷贝文件或目录到镜像"),s("td",{style:{"text-align":"left"}},"COPY ./start.sh /start.sh")],-1)),a[15]||(a[15]=s("tr",null,[s("td",{style:{"text-align":"left"}},"ENTRYPOINT"),s("td",{style:{"text-align":"left"}},"配置容器启动时运行的命令"),s("td",{style:{"text-align":"left"}},"ENTRYPOINT /bin/bash -c '/start.sh'")],-1)),a[16]||(a[16]=s("tr",null,[s("td",{style:{"text-align":"left"}},"VOLUME"),s("td",{style:{"text-align":"left"}},"指定容器挂载点到宿主自动生成的目录或其它容器"),s("td",{style:{"text-align":"left"}},'VOLUME ["/var/lib/mysql"]')],-1)),a[17]||(a[17]=s("tr",null,[s("td",{style:{"text-align":"left"}},"USER"),s("td",{style:{"text-align":"left"}},"为 RUN CMD和ENTRYPOINT执行命令指定运行用户"),s("td",{style:{"text-align":"left"}},"USER zhufengjiagou")],-1)),a[18]||(a[18]=s("tr",null,[s("td",{style:{"text-align":"left"}},"WORKDIR"),s("td",{style:{"text-align":"left"}},"为RUN CMD ENTRYPOINT COPY ADD 设置工作目录"),s("td",{style:{"text-align":"left"}},"WORKDIR /data")],-1)),a[19]||(a[19]=s("tr",null,[s("td",{style:{"text-align":"left"}},"HEALTHCHECK"),s("td",{style:{"text-align":"left"}},"健康检查"),s("td",{style:{"text-align":"left"}},"HEALTHCHECK --interval=5m --timeout=3s --retries=3 CMS curl -f htp://localhost")],-1)),a[20]||(a[20]=s("tr",null,[s("td",{style:{"text-align":"left"}},"ARG"),s("td",{style:{"text-align":"left"}},"在构建镜像时指定一些参数"),s("td",{style:{"text-align":"left"}},"ARG user")],-1))])]),a[24]||(a[24]=e(`<h3 id="_21-2-build镜像命令" tabindex="-1"><a class="header-anchor" href="#_21-2-build镜像命令"><span>21.2 build镜像命令</span></a></h3><ul><li>-t --tag list 镜像名称</li><li>-f --file string 指定Dockerfile文件的位置</li></ul><h3 id="_21-3-搭建nginx镜像" tabindex="-1"><a class="header-anchor" href="#_21-3-搭建nginx镜像"><span>21.3 搭建nginx镜像</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">mkdir /usr/local/src</span>
<span class="line">cd /usr/local/src</span>
<span class="line">wget http://nginx.org/download/nginx-1.12.1.tar.gz</span>
<span class="line"> </span>
<span class="line">systemctl restart docker </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token constant">FROM</span> centos</span>
<span class="line"><span class="token constant">MAINTAINER</span> zhufengjiagou</span>
<span class="line"><span class="token constant">RUN</span> yum install <span class="token operator">-</span>y gcc gcc<span class="token operator">-</span>c<span class="token operator">++</span> make openssl<span class="token operator">-</span>devel pcre<span class="token operator">-</span>devel</span>
<span class="line"><span class="token constant">ADD</span> nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.1</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">/</span>tmp</span>
<span class="line"><span class="token constant">RUN</span> cd <span class="token operator">/</span>tmp<span class="token operator">/</span>nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.1</span> <span class="token operator">&amp;&amp;</span> \\</span>
<span class="line">    <span class="token punctuation">.</span><span class="token operator">/</span>configure <span class="token operator">--</span>prefix<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx <span class="token operator">&amp;&amp;</span> \\</span>
<span class="line">    make <span class="token operator">-</span>j <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> \\</span>
<span class="line">    make install</span>
<span class="line"><span class="token constant">RUN</span> rm <span class="token operator">-</span>rf <span class="token operator">/</span>tmp<span class="token operator">/</span>nginx<span class="token operator">-</span><span class="token number">1.12</span><span class="token number">.1</span> <span class="token operator">&amp;&amp;</span> yum clean all</span>
<span class="line"><span class="token constant">COPY</span> nginx<span class="token punctuation">.</span>conf <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>conf</span>
<span class="line"><span class="token constant">WORKDIR</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx</span>
<span class="line"><span class="token constant">EXPOSE</span> <span class="token number">80</span></span>
<span class="line"><span class="token constant">CMD</span> <span class="token punctuation">[</span><span class="token string">&quot;./sbin/nginx&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;-g&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;daemon off;&quot;</span><span class="token punctuation">]</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker image build -t nginx:v1 -f Dockerfile .</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_21-4-搭建php镜像" tabindex="-1"><a class="header-anchor" href="#_21-4-搭建php镜像"><span>21.4 搭建php镜像</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">wget http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>nchc<span class="token punctuation">.</span>dl<span class="token punctuation">.</span>sourceforge<span class="token punctuation">.</span>net<span class="token operator">/</span>project<span class="token operator">/</span>mcrypt<span class="token operator">/</span>Libmcrypt<span class="token operator">/</span><span class="token number">2.5</span><span class="token number">.8</span><span class="token operator">/</span>libmcrypt<span class="token operator">-</span><span class="token number">2.5</span><span class="token number">.8</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line">wget http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>cn<span class="token punctuation">.</span>php<span class="token punctuation">.</span>net<span class="token operator">/</span>distributions<span class="token operator">/</span>php<span class="token operator">-</span><span class="token number">5.6</span><span class="token number">.30</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token constant">FROM</span> centos</span>
<span class="line"><span class="token constant">MAINTAINER</span> zhufengjiagou</span>
<span class="line"><span class="token constant">RUN</span> yum <span class="token operator">-</span>y install gcc gcc<span class="token operator">-</span>c<span class="token operator">++</span> make automake autoconf libtool openssl<span class="token operator">-</span>devel pcre<span class="token operator">-</span>devel libxml2 libxml2<span class="token operator">-</span>devel bzip2 bzip2<span class="token operator">-</span>devel libjpeg<span class="token operator">-</span>turbo libjpeg<span class="token operator">-</span>turbo<span class="token operator">-</span>devel libpng libpng<span class="token operator">-</span>devel freetype freetype<span class="token operator">-</span>devel zlib zlib<span class="token operator">-</span>devel libcurl libcurl<span class="token operator">-</span>devel</span>
<span class="line"><span class="token constant">ADD</span> libmcrypt<span class="token operator">-</span><span class="token number">2.5</span><span class="token number">.8</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">/</span>tmp</span>
<span class="line"><span class="token constant">RUN</span> cd <span class="token operator">/</span>tmp<span class="token operator">/</span>libmcrypt<span class="token operator">-</span><span class="token number">2.5</span><span class="token number">.8</span> <span class="token operator">&amp;&amp;</span> \\</span>
<span class="line">    <span class="token punctuation">.</span><span class="token operator">/</span>configure <span class="token operator">&amp;&amp;</span> \\</span>
<span class="line">    make <span class="token operator">-</span>j <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> \\</span>
<span class="line">    make install</span>
<span class="line"><span class="token constant">ADD</span> php<span class="token operator">-</span><span class="token number">5.6</span><span class="token number">.30</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">/</span>tmp</span>
<span class="line"><span class="token constant">RUN</span> cd <span class="token operator">/</span>tmp<span class="token operator">/</span>php<span class="token operator">-</span><span class="token number">5.6</span><span class="token number">.30</span> <span class="token operator">&amp;&amp;</span> \\</span>
<span class="line">    <span class="token punctuation">.</span><span class="token operator">/</span>configure <span class="token operator">--</span>prefix<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>php <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>pdo<span class="token operator">-</span>mysql<span class="token operator">=</span>mysqlnd <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>mysqli<span class="token operator">=</span>mysqlnd <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>mysql<span class="token operator">=</span>mysqlnd <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>openssl <span class="token operator">--</span>enable<span class="token operator">-</span>mbstring <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>freetype<span class="token operator">-</span>dir <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>jpeg<span class="token operator">-</span>dir <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>png<span class="token operator">-</span>dir <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>mcrypt <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>zlib <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>libxml<span class="token operator">-</span>dir<span class="token operator">=</span><span class="token operator">/</span>usr <span class="token operator">--</span>enable<span class="token operator">-</span>xml  <span class="token operator">--</span>enable<span class="token operator">-</span>sockets <span class="token operator">--</span>enable<span class="token operator">-</span>fpm <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>config<span class="token operator">-</span>file<span class="token operator">-</span>path<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>php<span class="token operator">/</span>etc <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>bz2 <span class="token operator">--</span><span class="token keyword">with</span><span class="token operator">-</span>gd <span class="token operator">&amp;&amp;</span> \\</span>
<span class="line">    make <span class="token operator">-</span>j <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> \\</span>
<span class="line">    make install</span>
<span class="line"><span class="token constant">RUN</span> cp <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>php<span class="token operator">/</span>etc<span class="token operator">/</span>php<span class="token operator">-</span>fpm<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>default <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>php<span class="token operator">/</span>etc<span class="token operator">/</span>php<span class="token operator">-</span>fpm<span class="token punctuation">.</span>conf</span>
<span class="line"><span class="token constant">RUN</span> sed <span class="token operator">-</span>i <span class="token string">&#39;s/127.0.0.1/0.0.0.0/g&#39;</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>php<span class="token operator">/</span>etc<span class="token operator">/</span>php<span class="token operator">-</span>fpm<span class="token punctuation">.</span>conf</span>
<span class="line"><span class="token constant">RUN</span> sed <span class="token operator">-</span>i  <span class="token string">&#39;89a daemonize = no&#39;</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>php<span class="token operator">/</span>etc<span class="token operator">/</span>php<span class="token operator">-</span>fpm<span class="token punctuation">.</span>conf</span>
<span class="line"><span class="token constant">RUN</span> rm <span class="token operator">-</span>rf <span class="token operator">/</span>tmp<span class="token operator">/</span>php<span class="token operator">-</span><span class="token number">5.6</span><span class="token number">.30</span> <span class="token operator">&amp;&amp;</span> yum clean all </span>
<span class="line"><span class="token constant">WORKDIR</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>php </span>
<span class="line"><span class="token constant">EXPOSE</span> <span class="token number">9000</span></span>
<span class="line"><span class="token constant">CMD</span> <span class="token punctuation">[</span><span class="token string">&quot;/usr/local/php/sbin/php-fpm&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/usr/local/php/etc/php-fpm.conf&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker image build -t php:v1 -f Dockerfile .</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_22-布署php网站" tabindex="-1"><a class="header-anchor" href="#_22-布署php网站"><span>22. 布署PHP网站</span></a></h2><h3 id="_22-1-自定义网络" tabindex="-1"><a class="header-anchor" href="#_22-1-自定义网络"><span>22.1 自定义网络</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker network create lnmp</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_22-2-创建php容器" tabindex="-1"><a class="header-anchor" href="#_22-2-创建php容器"><span>22.2 创建PHP容器</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker run -itd \\</span>
<span class="line">--name lnmp_php</span>
<span class="line">--net lnmp \\</span>
<span class="line">--mount type=bind,src=/app/wwwroot,dst=/usr/local/nginx/html \\</span>
<span class="line">php:v1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_22-3-创建nginx容器" tabindex="-1"><a class="header-anchor" href="#_22-3-创建nginx容器"><span>22.3 创建nginx容器</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker run <span class="token operator">-</span>itd \\</span>
<span class="line"><span class="token operator">--</span>name lnmp_nginx</span>
<span class="line"><span class="token operator">--</span>net lnmp \\</span>
<span class="line"><span class="token operator">-</span>p <span class="token number">8888</span><span class="token operator">:</span><span class="token number">80</span> \\</span>
<span class="line"><span class="token operator">--</span>mount type<span class="token operator">=</span>bind<span class="token punctuation">,</span>src<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>wwwroot<span class="token punctuation">,</span>dst<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>nginx<span class="token operator">/</span>html \\</span>
<span class="line"><span class="token literal-property property">nginx</span><span class="token operator">:</span>v1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_22-4-创建mysql容器" tabindex="-1"><a class="header-anchor" href="#_22-4-创建mysql容器"><span>22.4 创建mysql容器</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker run <span class="token operator">-</span>itd \\</span>
<span class="line"><span class="token operator">--</span>name lnmp_mysql</span>
<span class="line"><span class="token operator">--</span>net lnmp \\</span>
<span class="line"><span class="token operator">--</span>mount type<span class="token operator">=</span>bind<span class="token punctuation">,</span>src<span class="token operator">=</span>mysql<span class="token operator">-</span>vol<span class="token punctuation">,</span>dst<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>lib<span class="token operator">/</span>mysql \\</span>
<span class="line"><span class="token operator">-</span>e <span class="token constant">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span></span>
<span class="line">mysql <span class="token operator">--</span>character<span class="token operator">-</span>set<span class="token operator">-</span>server<span class="token operator">=</span>utf8</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_23-布署java网站" tabindex="-1"><a class="header-anchor" href="#_23-布署java网站"><span>23. 布署Java网站</span></a></h2><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">wget  https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>download<span class="token punctuation">.</span>oracle<span class="token punctuation">.</span>com<span class="token operator">/</span>otn<span class="token operator">/</span>java<span class="token operator">/</span>jdk<span class="token operator">/</span>7u80<span class="token operator">-</span>b15<span class="token operator">/</span>jdk<span class="token operator">-</span>7u80<span class="token operator">-</span>linux<span class="token operator">-</span>x64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz<span class="token operator">?</span>AuthParam<span class="token operator">=</span>1555491494_9f57610fb0c84418f58ad1b9bc5a3be6</span>
<span class="line"></span>
<span class="line">wget http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mirrors<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>apache<span class="token operator">/</span>tomcat<span class="token operator">/</span>tomcat<span class="token operator">-</span><span class="token number">7</span><span class="token operator">/</span>v7<span class="token punctuation">.</span><span class="token number">0.94</span><span class="token operator">/</span>bin<span class="token operator">/</span>apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">7.0</span><span class="token number">.94</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="http://tomcat.apache.org/download-70.cgi" target="_blank" rel="noopener noreferrer">tomcat</a></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token constant">FROM</span> centos</span>
<span class="line"><span class="token constant">MAINTAINER</span> zhufengjiagou</span>
<span class="line"><span class="token constant">ADD</span>  jdk<span class="token operator">-</span>7u80<span class="token operator">-</span>linux<span class="token operator">-</span>x64<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">/</span>usr<span class="token operator">/</span>local</span>
<span class="line"><span class="token constant">ENV</span> <span class="token constant">JAVA_HOME</span> <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>jdk1<span class="token punctuation">.</span><span class="token number">7.0_80</span></span>
<span class="line"><span class="token constant">ADD</span> apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">7.0</span><span class="token number">.94</span><span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">/</span>usr<span class="token operator">/</span>local</span>
<span class="line"><span class="token constant">COPY</span> server<span class="token punctuation">.</span>xml <span class="token operator">/</span>user<span class="token operator">/</span>local<span class="token operator">/</span>apache<span class="token operator">/</span>conf</span>
<span class="line"><span class="token constant">RUN</span> rm <span class="token operator">-</span>f <span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token comment">/*.tar.gz</span>
<span class="line">WORKDIR /usr/local/apache-tomcat-7.0.94</span>
<span class="line">EXPOSE 8080</span>
<span class="line">ENTRYPOINT [&quot;./bin/catalina.sh&quot;,&quot;run&quot;]</span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">docker image build -t tomcat:v1 -f Dockerfile .</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">docker run <span class="token operator">-</span>itd \\</span>
<span class="line"><span class="token operator">--</span>name<span class="token operator">=</span>tomcat</span>
<span class="line"><span class="token operator">-</span>p <span class="token number">8080</span><span class="token operator">:</span><span class="token number">8080</span></span>
<span class="line"><span class="token operator">--</span>mount type<span class="token operator">=</span>bind<span class="token punctuation">,</span>src<span class="token operator">=</span><span class="token operator">/</span>app<span class="token operator">/</span>webapps<span class="token punctuation">,</span>dst<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>apache<span class="token operator">-</span>tomcat<span class="token operator">-</span><span class="token number">7.0</span><span class="token number">.94</span><span class="token operator">/</span>webapps \\</span>
<span class="line"><span class="token literal-property property">tomcat</span><span class="token operator">:</span>v1</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_23-发布" tabindex="-1"><a class="header-anchor" href="#_23-发布"><span>23. 发布</span></a></h2><p>注册账号 <a href="https://hub.docker.com" target="_blank" rel="noopener noreferrer">https://hub.docker.com</a></p><p>登录Docker Hub docker login</p><p>docker login --username=zhangrenyang --password=123456</p><p>镜像打标签 docker tag wordpress:v1 zhangrenyang/wordpress:v1</p><p>上传 docker push zhangrenyang/wordpress:v1</p><p>搜索测试 docker search zhangrenyang</p><p>下载 docker pull zhangrenyang/wordpress:v1</p><h2 id="_20-参考" tabindex="-1"><a class="header-anchor" href="#_20-参考"><span>20. 参考</span></a></h2><ul><li><a href="http://www.ruanyifeng.com/blog/2016/07/yaml.html" target="_blank" rel="noopener noreferrer">yaml</a></li><li><a href="https://www.npmjs.com/package/mysql" target="_blank" rel="noopener noreferrer">mysql</a></li></ul>`,35))])}const b=c(k,[["render",v]]),x=JSON.parse('{"path":"/strong/45.docker.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/45.docker.md"}');export{b as comp,x as data};
