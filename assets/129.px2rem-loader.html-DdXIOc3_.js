import{_ as n,c as a,a as e,o as p}from"./app-CD1YpnS1.js";const l={};function t(i,s){return p(),a("div",null,[...s[0]||(s[0]=[e(`<h2 id="_1-核心概念" tabindex="-1"><a class="header-anchor" href="#_1-核心概念"><span>1.核心概念</span></a></h2><h3 id="_1-1-设备物理像素" tabindex="-1"><a class="header-anchor" href="#_1-1-设备物理像素"><span>1.1 设备物理像素</span></a></h3><ul><li>是一个物理概念，是显示器显示的最小物理单位</li><li><code>iPhone6</code>的像素分辨率是750*1334\`</li><li><code>px</code>是一个相对单位，相对的是设备像素(device pixel)</li></ul><h3 id="_1-2-设备独立像素" tabindex="-1"><a class="header-anchor" href="#_1-2-设备独立像素"><span>1.2 设备独立像素</span></a></h3><ul><li>是一个逻辑概念,用于向CSS中的宽度、高度等提供信息</li><li>iPhone6的逻辑分辨率是<code>375*667</code></li><li>iPhone6: <code>window.screen.width=375,window.screen.height=667</code></li></ul><h3 id="_1-3-设备像素比" tabindex="-1"><a class="header-anchor" href="#_1-3-设备像素比"><span>1.3 设备像素比</span></a></h3><ul><li>DPR(设备像素比) = 设备像素/CSS像素</li><li>设备像素比 <code>window.devicePixelRatio</code></li></ul><p><img src="https://img.zhufengpeixun.com/8335aff90708c99fe6dd75a92e0cd787" alt="8335aff90708c99fe6dd75a92e0cd787"></p><h3 id="_1-4-移动端适配" tabindex="-1"><a class="header-anchor" href="#_1-4-移动端适配"><span>1.4 移动端适配</span></a></h3><ul><li>一般由设计师按照设备像素(device pixel)为单位制作设计稿</li><li>然后由前端工程师参照设备像素比(device pixel ratio)进行换算</li></ul><h4 id="_1-4-1-rem" tabindex="-1"><a class="header-anchor" href="#_1-4-1-rem"><span>1.4.1 rem</span></a></h4><ul><li>参照根元素的字体大小</li><li>适配就是让根元素的字体大小根据分辨率进行动态改变</li><li><a href="https://www.npmjs.com/package/px2rem-loader" target="_blank" rel="noopener noreferrer">px2rem-loader</a></li></ul><h4 id="_1-4-2-vw和vh" tabindex="-1"><a class="header-anchor" href="#_1-4-2-vw和vh"><span>1.4.2 vw和vh</span></a></h4><ul><li>参照的是viewport视口</li><li>vw参照的是视口的宽度(1vw=视口宽度/100)</li><li>vh参照的是视口的高度(1vh=视口高度/100)</li><li>iPhone6 1vw=3.75px</li><li><a href="https://www.npmjs.com/package/postcss-px-to-viewport" target="_blank" rel="noopener noreferrer">postcss-px-to-viewport</a></li></ul><table><thead><tr><th style="text-align:left;">型号</th><th style="text-align:left;">宽度</th><th style="text-align:left;">1vw</th></tr></thead><tbody><tr><td style="text-align:left;">iPhone6</td><td style="text-align:left;">375</td><td style="text-align:left;">3.75px</td></tr></tbody></table><p>750px 75px</p><p>1vw=7.5px 10vw=75px</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token number">75</span><span class="token operator">/</span><span class="token number">10</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_2-px2rem-loader实战" tabindex="-1"><a class="header-anchor" href="#_2-px2rem-loader实战"><span>2.px2rem-loader实战</span></a></h2><h3 id="_2-1-安装" tabindex="-1"><a class="header-anchor" href="#_2-1-安装"><span>2.1 安装</span></a></h3><ul><li><a href="https://github.com/amfe/lib-flexible" target="_blank" rel="noopener noreferrer">lib-flexible</a></li><li><a href="https://www.npmjs.com/package/px2rem-loader" target="_blank" rel="noopener noreferrer">px2rem-loader</a></li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">npm install webpack webpack-cli html-webpack-plugin style-loader css-loader amfe-flexible px2rem-loader --save-dev</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-2-src-index-js" tabindex="-1"><a class="header-anchor" href="#_2-2-src-index-js"><span>2.2 src\\index.js</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token string">&#39;./base.css&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-3-src-base-css" tabindex="-1"><a class="header-anchor" href="#_2-3-src-base-css"><span>2.3 src\\base.css</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">    <span class="token literal-property property">width</span><span class="token operator">:</span>750px<span class="token punctuation">;</span></span>
<span class="line">    <span class="token literal-property property">height</span><span class="token operator">:</span>750px<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-src-index-html" tabindex="-1"><a class="header-anchor" href="#_2-4-src-index-html"><span>2.4 src\\index.html</span></a></h3><p>src\\index.html</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">&quot;UTF-8&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>meta http<span class="token operator">-</span>equiv<span class="token operator">=</span><span class="token string">&quot;X-UA-Compatible&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;IE=edge&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">&quot;viewport&quot;</span> content<span class="token operator">=</span><span class="token string">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>webpack<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span>body<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;root&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-5-webpack-config-js" tabindex="-1"><a class="header-anchor" href="#_2-5-webpack-config-js"><span>2.5 webpack.config.js</span></a></h3><p>webpack.config.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;html-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].js&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span></span>
<span class="line">            <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span></span>
<span class="line">                <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&#39;style-loader&#39;</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&#39;css-loader&#39;</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&#39;px2rem-loader&#39;</span><span class="token punctuation">,</span></span>
<span class="line">                <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token literal-property property">remUni</span><span class="token operator">:</span> <span class="token number">75</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token literal-property property">remPrecision</span><span class="token operator">:</span> <span class="token number">8</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.html&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-6-package-json" tabindex="-1"><a class="header-anchor" href="#_2-6-package-json"><span>2.6 package.json</span></a></h3><p>package.json</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">   <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span></span>
<span class="line">   <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-loader" tabindex="-1"><a class="header-anchor" href="#_3-loader"><span>3. loader</span></a></h2><ul><li>loader 用于对模块的源代码进行转换</li><li>loader 可以使你在 <code>import</code> 模块时预处理文件</li><li>loader 可以将文件从不同的语言(如TypeScript)转换为 JavaScript</li></ul><p>loaders\\px2rem-loader.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">function</span> <span class="token function">loader</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;px2rem-loader&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> source<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> loader<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-使用自定义loader" tabindex="-1"><a class="header-anchor" href="#_4-使用自定义loader"><span>4. 使用自定义loader</span></a></h2><p>webpack.config.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">const path = require(&#39;path&#39;);</span>
<span class="line">const HtmlWebpackPlugin = require(&#39;html-webpack-plugin&#39;);</span>
<span class="line">module.exports = {</span>
<span class="line">    mode: &#39;development&#39;,</span>
<span class="line">    devtool: false,</span>
<span class="line">    entry: &#39;./src/index.js&#39;,</span>
<span class="line">    output: {</span>
<span class="line">        path: path.resolve(__dirname, &#39;dist&#39;),</span>
<span class="line">        filename: &#39;[name].js&#39;</span>
<span class="line">    },</span>
<span class="line">+   resolveLoader: {</span>
<span class="line">+       alias: {</span>
<span class="line">+           &quot;px2rem-loader&quot;: path.resolve(&#39;./loaders/px2rem-loader.js&#39;)</span>
<span class="line">+       },</span>
<span class="line">+       modules: [path.resolve(&#39;./loaders&#39;), &#39;node_modules&#39;]</span>
<span class="line">+   },</span>
<span class="line">    module: {</span>
<span class="line">        rules: [{</span>
<span class="line">            test: /\\.css$/,</span>
<span class="line">            use: [</span>
<span class="line">                { loader: &#39;style-loader&#39; },</span>
<span class="line">                { loader: &#39;css-loader&#39; },</span>
<span class="line">                {</span>
<span class="line">+                   loader: path.resolve(__dirname, &#39;loaders/px2rem-loader.js&#39;),</span>
<span class="line">                    options: {</span>
<span class="line">                        remUni: 75,</span>
<span class="line">                        remPrecision: 8</span>
<span class="line">                    }</span>
<span class="line">                }]</span>
<span class="line">        }]</span>
<span class="line">    },</span>
<span class="line">    plugins: [</span>
<span class="line">        new HtmlWebpackPlugin({ template: &#39;./src/index.html&#39; })</span>
<span class="line">    ]</span>
<span class="line">};</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-css" tabindex="-1"><a class="header-anchor" href="#_5-css"><span>5 css</span></a></h2><h3 id="_5-1-ast" tabindex="-1"><a class="header-anchor" href="#_5-1-ast"><span>5.1 AST</span></a></h3><ul><li><a href="https://astexplorer.net" target="_blank" rel="noopener noreferrer">astexplorer</a></li><li>JavaScript Parser可以把源代码转化为一颗抽象语法树（AST），这颗树定义了代码的结构</li></ul><p><img src="http://img.zhufengpeixun.cn/ast.jpg" alt="ast"></p><h3 id="_5-2-ast工作流" tabindex="-1"><a class="header-anchor" href="#_5-2-ast工作流"><span>5.2 AST工作流</span></a></h3><ul><li>Parse(解析) 将源代码转换成抽象语法树，树上有很多的estree节点</li><li>Transform(转换) 对抽象语法树进行转换</li><li>Generate(代码生成) 将上一步经过转换过的抽象语法树生成新的代码</li></ul><p><img src="https://img.zhufengpeixun.com/ast-compiler-flow.jpg" alt="ast-compiler-flow"></p><h3 id="_5-3-px2rem-js" tabindex="-1"><a class="header-anchor" href="#_5-3-px2rem-js"><span>5.3 px2rem.js</span></a></h3><ul><li><a href="https://www.npmjs.com/package/px2rem" target="_blank" rel="noopener noreferrer">px2rem</a></li></ul><p>px2rem.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> css <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;css&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> pxRegExp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\b(\\d+(\\.\\d+)?)px\\b</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> pxGlobalRegExp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>pxRegExp<span class="token punctuation">.</span>source<span class="token punctuation">,</span> <span class="token string">&#39;g&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">Px2rem</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> config<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">generateRem</span><span class="token punctuation">(</span><span class="token parameter">cssText</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">function</span> <span class="token function">processRules</span><span class="token punctuation">(</span><span class="token parameter">rules</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rules<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                <span class="token keyword">var</span> rule <span class="token operator">=</span> rules<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">var</span> declarations <span class="token operator">=</span> rule<span class="token punctuation">.</span>declarations<span class="token punctuation">;</span></span>
<span class="line">                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> declarations<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token keyword">var</span> declaration <span class="token operator">=</span> declarations<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token keyword">if</span> <span class="token punctuation">(</span>declaration<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&#39;declaration&#39;</span> <span class="token operator">&amp;&amp;</span> pxRegExp<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>declaration<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">                        declaration<span class="token punctuation">.</span>value <span class="token operator">=</span> self<span class="token punctuation">.</span><span class="token function">_getCalcValue</span><span class="token punctuation">(</span><span class="token string">&#39;rem&#39;</span><span class="token punctuation">,</span> declaration<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token punctuation">}</span></span>
<span class="line">                <span class="token punctuation">}</span></span>
<span class="line">            <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token keyword">var</span> astObj <span class="token operator">=</span> css<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>cssText<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">//console.log(JSON.stringify(astObj.stylesheet.rules, null, 2));</span></span>
<span class="line">        <span class="token function">processRules</span><span class="token punctuation">(</span>astObj<span class="token punctuation">.</span>stylesheet<span class="token punctuation">.</span>rules<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> css<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>astObj<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token function">_getCalcValue</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">var</span> <span class="token punctuation">{</span> remUnit<span class="token punctuation">,</span> remPrecision <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>pxGlobalRegExp<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> $1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>$1<span class="token punctuation">)</span> <span class="token operator">/</span> remUnit<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>remPrecision<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">return</span> val <span class="token operator">+</span> type<span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Px2rem<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-4-usepx2rem-js" tabindex="-1"><a class="header-anchor" href="#_5-4-usepx2rem-js"><span>5.4 usePx2rem.js</span></a></h3><p>usePx2rem.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> Px2rem <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./px2rem&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> px2rem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Px2rem</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">remUnit</span><span class="token operator">:</span> <span class="token number">75</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">remPrecision</span><span class="token operator">:</span> <span class="token number">8</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> cssText <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string"></span>
<span class="line"> </span>
<span class="line">    width:750px;</span>
<span class="line">    height:750px;</span>
<span class="line">}</span>
<span class="line"></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> newCSS <span class="token operator">=</span> px2rem<span class="token punctuation">.</span><span class="token function">generateRem</span><span class="token punctuation">(</span>cssText<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newCSS<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token doc-comment comment">/**</span>
<span class="line">[</span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    &quot;type&quot;: &quot;rule&quot;,</span>
<span class="line">     &quot;selectors&quot;: [&quot;</span>
<span class="line">    &quot;declarations&quot;: [</span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        &quot;type&quot;: &quot;declaration&quot;,</span>
<span class="line">        &quot;property&quot;: &quot;width&quot;,</span>
<span class="line">        &quot;value&quot;: &quot;750px&quot;</span>
<span class="line">      <span class="token punctuation">}</span>,</span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        &quot;type&quot;: &quot;declaration&quot;,</span>
<span class="line">        &quot;property&quot;: &quot;height&quot;,</span>
<span class="line">        &quot;value&quot;: &quot;750px&quot;</span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    ]</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">]</span>
<span class="line">*/</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-px2rem-loader-js" tabindex="-1"><a class="header-anchor" href="#_6-px2rem-loader-js"><span>6. px2rem-loader.js</span></a></h2><ul><li><a href="https://www.npmjs.com/package/loader-utils" target="_blank" rel="noopener noreferrer">loader-utils</a>是一个webpack工具类</li><li><a href="https://www.npmjs.com/package/px2rem-loader" target="_blank" rel="noopener noreferrer">px2rem-loader</a></li><li>直接写px，编译后会直接转化成rem <ul><li>在px后面添加/no/，不会转化px，会原样输出 一般border需用这个</li><li>在px后面添加/px/,会根据dpr的不同，生成三套代码 一般字体需用这个</li></ul></li></ul><p>loaders\\px2rem-loader.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> loaderUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;loader-utils&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> Px2rem <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./px2rem&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">loader</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">var</span> options <span class="token operator">=</span> loaderUtils<span class="token punctuation">.</span><span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">var</span> px2remIns <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Px2rem</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">let</span> targetSource <span class="token operator">=</span> px2remIns<span class="token punctuation">.</span><span class="token function">generateRem</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">return</span> targetSource<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> loader<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-lib-flexible" tabindex="-1"><a class="header-anchor" href="#_7-lib-flexible"><span>7. lib-flexible</span></a></h2><p>src\\index.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token string">&#39;./base.css&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token string">&#39;amfe-flexible/index.js&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span></span>
<span class="line">     <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">flexible</span> <span class="token punctuation">(</span><span class="token parameter">window<span class="token punctuation">,</span> document</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">         <span class="token keyword">var</span> docEl <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">;</span></span>
<span class="line">         <span class="token comment">// set 1rem = viewWidth / 10</span></span>
<span class="line">         <span class="token keyword">function</span> <span class="token function">setRemUnit</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">             <span class="token keyword">var</span> rem <span class="token operator">=</span> docEl<span class="token punctuation">.</span>clientWidth <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line">             docEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> rem <span class="token operator">+</span> <span class="token string">&#39;px&#39;</span><span class="token punctuation">;</span></span>
<span class="line">         <span class="token punctuation">}</span></span>
<span class="line">         <span class="token function">setRemUnit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">         window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;resize&#39;</span><span class="token punctuation">,</span> setRemUnit<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">         <span class="token punctuation">}</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> document<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"> <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-第三方框架样式问题" tabindex="-1"><a class="header-anchor" href="#_7-第三方框架样式问题"><span>7. 第三方框架样式问题</span></a></h2><ul><li>如果第三方组件已经是为移动端做了适配,<code>px2rem</code>又转成了<code>rem</code>就导致其样式变的很小</li></ul><h3 id="_7-1-index-js" tabindex="-1"><a class="header-anchor" href="#_7-1-index-js"><span>7.1 index.js</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&#39;react-dom&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token string">&#39;antd/dist/antd.css&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>Button<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;antd&#39;</span><span class="token punctuation">;</span></span>
<span class="line">ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token operator">&lt;</span>Button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span><span class="token operator">&gt;</span>按钮<span class="token operator">&lt;</span><span class="token operator">/</span>Button<span class="token operator">&gt;</span></span>
<span class="line"><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-2-webpack-config-js" tabindex="-1"><a class="header-anchor" href="#_7-2-webpack-config-js"><span>7.2 webpack.config.js</span></a></h3><p>webpack.config.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> {</span>
<span class="line">            test: /\\.css$/,</span>
<span class="line">            use: [</span>
<span class="line">                { loader: &#39;style-loader&#39; },</span>
<span class="line">                { loader: &#39;css-loader&#39; },</span>
<span class="line">                {</span>
<span class="line">                    loader: path.resolve(__dirname, &#39;loaders/px2rem-loader.js&#39;),</span>
<span class="line">                    options: {</span>
<span class="line">                        remUnit: 75,</span>
<span class="line">                        remPrecision: 8,</span>
<span class="line">+                       exclude:/antd\\.css/</span>
<span class="line">                    }</span>
<span class="line">                }],</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-3-px2rem-loader-js" tabindex="-1"><a class="header-anchor" href="#_7-3-px2rem-loader-js"><span>7.3 px2rem-loader.js</span></a></h3><p>loaders\\px2rem-loader.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">var loaderUtils = require(&#39;loader-utils&#39;);</span>
<span class="line">var Px2rem = require(&#39;./px2rem&#39;);</span>
<span class="line"></span>
<span class="line">module.exports = function (source) {</span>
<span class="line">  var options = loaderUtils.getOptions(this);</span>
<span class="line">+ if(options.exclude &amp;&amp; options.exclude.test(this.resource)){</span>
<span class="line">+   return source;</span>
<span class="line">+ }</span>
<span class="line">  var px2remIns = new Px2rem(options);</span>
<span class="line">  let targetSource = px2remIns.generateRem(source);</span>
<span class="line">  return targetSource;</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,74)])])}const o=n(l,[["render",t]]),r=JSON.parse('{"path":"/strong/129.px2rem-loader.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/129.px2rem-loader.md"}');export{o as comp,r as data};
