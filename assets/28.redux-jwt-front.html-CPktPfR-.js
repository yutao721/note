import{_ as n,c as a,a as e,o as p}from"./app-CD1YpnS1.js";const t={};function l(i,s){return p(),a("div",null,[...s[0]||(s[0]=[e(`<h2 id="_1-生成项目" tabindex="-1"><a class="header-anchor" href="#_1-生成项目"><span>1. 生成项目</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ create-react-app jwt-frontend</span>
<span class="line">cd jwt-frontend</span>
<span class="line">cnpm i redux react-redux redux-logger redux-saga react-router-dom react-router-redux@next history axios jsonwebtoken -S</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-跑通路由和仓库" tabindex="-1"><a class="header-anchor" href="#_2-跑通路由和仓库"><span>2.跑通路由和仓库</span></a></h2><h3 id="_2-1-history-js" tabindex="-1"><a class="header-anchor" href="#_2-1-history-js"><span>2.1 history.js</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> createHistory <span class="token keyword">from</span> <span class="token string">&#39;history/createBrowserHistory&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> history<span class="token operator">=</span><span class="token function">createHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> history<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-2-src-index-js" tabindex="-1"><a class="header-anchor" href="#_2-2-src-index-js"><span>2.2 src/index.js</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">+ import {Provider} from &#39;react-redux&#39;;</span>
<span class="line">+ import store from &#39;./store&#39;;</span>
<span class="line">+ import App from &#39;./containers/App&#39;;</span>
<span class="line">+ import {ConnectedRouter} from &#39;react-router-redux&#39;;</span>
<span class="line">+ import history from &#39;./history&#39;;</span>
<span class="line">+ import &#39;bootstrap/dist/css/bootstrap.css&#39;</span>
<span class="line">+ ReactDOM.render(&lt;Provider store={store}&gt;</span>
<span class="line">+     &lt;ConnectedRouter history={history}&gt;</span>
<span class="line">+         &lt;App /&gt;</span>
<span class="line">+     &lt;/ConnectedRouter&gt;</span>
<span class="line">+ &lt;/Provider&gt;, document.getElementById(&#39;root&#39;));</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-src-containers-app-js" tabindex="-1"><a class="header-anchor" href="#_2-3-src-containers-app-js"><span>2.3 src/containers/App.js</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>Component<span class="token punctuation">,</span>Fragment<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>Link<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-router-dom&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">            <span class="token operator">&lt;</span>Fragment<span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span>nav className<span class="token operator">=</span><span class="token string">&quot;navbar navbar-default&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;container-fluid&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;navbar-header&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                             <span class="token operator">&lt;</span>a className<span class="token operator">=</span><span class="token string">&quot;navbar-brand&quot;</span> href<span class="token operator">=</span>&quot;</span>
<span class="line">                        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span></span>
<span class="line">                            <span class="token operator">&lt;</span>ul className<span class="token operator">=</span><span class="token string">&quot;nav navbar-nav&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                                <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/&quot;</span><span class="token operator">&gt;</span>首页<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">                                <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/users/signup&quot;</span><span class="token operator">&gt;</span>注册<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">                                <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/users/signin&quot;</span><span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">                                <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/articles/add&quot;</span><span class="token operator">&gt;</span>发表文章<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">                            <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span></span>
<span class="line">                        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span><span class="token operator">/</span>nav<span class="token operator">&gt;</span></span>
<span class="line">            <span class="token operator">&lt;</span><span class="token operator">/</span>Fragment<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-4-store-index-js" tabindex="-1"><a class="header-anchor" href="#_2-4-store-index-js"><span>2.4 store/index.js</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;redux&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> reducers <span class="token keyword">from</span> <span class="token string">&#39;./reducers&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> store<span class="token operator">=</span><span class="token function">createStore</span><span class="token punctuation">(</span>reducers<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-5-store-reducers-index-js" tabindex="-1"><a class="header-anchor" href="#_2-5-store-reducers-index-js"><span>2.5 store/reducers/index.js</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>combineReducers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;redux&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> user <span class="token keyword">from</span> <span class="token string">&#39;./user&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  user</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-6-store-reducers-user-js" tabindex="-1"><a class="header-anchor" href="#_2-6-store-reducers-user-js"><span>2.6 store/reducers/user.js</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> initState<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token operator">=</span>initState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> state<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-连接组件和仓库" tabindex="-1"><a class="header-anchor" href="#_3-连接组件和仓库"><span>3. 连接组件和仓库</span></a></h2><h3 id="_3-1-navheader-js" tabindex="-1"><a class="header-anchor" href="#_3-1-navheader-js"><span>3.1 NavHeader.js</span></a></h3><p>src/components/NavHeader.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>Link<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-router-dom&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-redux&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">NavHeader</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">            <span class="token operator">&lt;</span>nav className<span class="token operator">=</span><span class="token string">&quot;navbar navbar-default&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;container-fluid&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;navbar-header&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                             <span class="token operator">&lt;</span>a className<span class="token operator">=</span><span class="token string">&quot;navbar-brand&quot;</span> href<span class="token operator">=</span>&quot;</span>
<span class="line">                        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span></span>
<span class="line">                            <span class="token operator">&lt;</span>ul className<span class="token operator">=</span><span class="token string">&quot;nav navbar-nav&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                                <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/&quot;</span><span class="token operator">&gt;</span>首页<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">                                <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/users/signup&quot;</span><span class="token operator">&gt;</span>注册<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">                                <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/users/signin&quot;</span><span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">                                <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/articles/add&quot;</span><span class="token operator">&gt;</span>发表文章<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">                            <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span></span>
<span class="line">                           <span class="token operator">&lt;</span>ul className<span class="token operator">=</span><span class="token string">&quot;nav navbar-nav navbar-right&quot;</span><span class="token operator">&gt;</span></span>
<span class="line">                           <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span></span>
<span class="line">                               <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/users/signout&quot;</span><span class="token operator">&gt;</span>欢迎<span class="token operator">:</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>username<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span></span>
<span class="line">                            <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">                            <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span></span>
<span class="line">                                <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">&quot;/users/signout&quot;</span><span class="token operator">&gt;</span>退出<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span></span>
<span class="line">                            <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span>
<span class="line">                            <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span></span>
<span class="line">                        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">                <span class="token operator">&lt;</span><span class="token operator">/</span>nav<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token operator">=&gt;</span>state<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">(</span>NavHeader<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-home-js" tabindex="-1"><a class="header-anchor" href="#_3-2-home-js"><span>3.2 Home.js</span></a></h3><p>src/containers/Home.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Home</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Home<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-signin-js" tabindex="-1"><a class="header-anchor" href="#_3-3-signin-js"><span>3.3 Signin.js</span></a></h3><p>src/containers/Signin.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Signin</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Signin<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-4-signup-js" tabindex="-1"><a class="header-anchor" href="#_3-4-signup-js"><span>3.4 Signup.js</span></a></h3><p>src/containers/Signup.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Signup</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Signup<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-5-article-add-js" tabindex="-1"><a class="header-anchor" href="#_3-5-article-add-js"><span>3.5 article/Add.js</span></a></h3><p>src/containers/article/Add.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Add</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Article Add<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-6-reducers-user-js" tabindex="-1"><a class="header-anchor" href="#_3-6-reducers-user-js"><span>3.6 reducers/user.js</span></a></h3><p>src/store/reducers/user.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">-let initState={};</span>
<span class="line">+let initState={username:&#39;张三&#39;};</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-用户登录" tabindex="-1"><a class="header-anchor" href="#_4-用户登录"><span>4. 用户登录</span></a></h2><h3 id="_4-1-navheader-js" tabindex="-1"><a class="header-anchor" href="#_4-1-navheader-js"><span>4.1 NavHeader.js</span></a></h3><p>src/components/NavHeader.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> import React,{Component} from &#39;react&#39;</span>
<span class="line"> import {Link} from &#39;react-router-dom&#39;;</span>
<span class="line"> import {connect} from &#39;react-redux&#39;;</span>
<span class="line">+import actions from &#39;../store/actions/user&#39;;</span>
<span class="line"> class NavHeader extends Component{</span>
<span class="line">+    componentDidMount() {</span>
<span class="line">+        this.props.loadUser();</span>
<span class="line">+    }</span>
<span class="line">     render() {</span>
<span class="line">         return (</span>
<span class="line">             &lt;nav className=&quot;navbar navbar-default&quot;&gt;</span>
<span class="line">                     &lt;div className=&quot;container-fluid&quot;&gt;</span>
<span class="line">                         &lt;div className=&quot;navbar-header&quot;&gt;</span>
<span class="line"> -                            &lt;a className=&quot;navbar-brand&quot; href=&quot;</span>
<span class="line">+                            &lt;a className=&quot;navbar-brand&quot; href=&quot;/&quot;&gt;珠峰博客&lt;/a&gt;</span>
<span class="line">                         &lt;/div&gt;</span>
<span class="line">                         &lt;div&gt;</span>
<span class="line">                             &lt;ul className=&quot;nav navbar-nav&quot;&gt;</span>
<span class="line">-                                &lt;li&gt;&lt;Link to=&quot;/&quot;&gt;首页&lt;/Link&gt;&lt;/li&gt;</span>
<span class="line">-                                &lt;li&gt;&lt;Link to=&quot;/users/signup&quot;&gt;注册&lt;/Link&gt;&lt;/li&gt;</span>
<span class="line">-                                &lt;li&gt;&lt;Link to=&quot;/users/signin&quot;&gt;登录&lt;/Link&gt;&lt;/li&gt;</span>
<span class="line">-                                &lt;li&gt;&lt;Link to=&quot;/articles/add&quot;&gt;发表文章&lt;/Link&gt;&lt;/li&gt;</span>
<span class="line">-                            &lt;/ul&gt;</span>
<span class="line">-                           &lt;ul className=&quot;nav navbar-nav navbar-right&quot;&gt;</span>
<span class="line">-                           &lt;li&gt;</span>
<span class="line">-                               &lt;Link to=&quot;/users/signout&quot;&gt;欢迎:{this.props.username}&lt;/Link&gt;</span>
<span class="line">-                            &lt;/li&gt;</span>
<span class="line">+                            &lt;li&gt;&lt;Link to=&quot;/&quot;&gt;首页&lt;/Link&gt;&lt;/li&gt;</span>
<span class="line">+                            {</span>
<span class="line">+                                !this.props.user&amp;&amp;(&lt;li&gt;&lt;Link to=&quot;/users/signup&quot;&gt;注册&lt;/Link&gt;&lt;/li&gt;</span>
<span class="line">+                                )</span>
<span class="line">+                            }</span>
<span class="line">+                            {</span>
<span class="line">+                                !this.props.user&amp;&amp;(&lt;li&gt;&lt;Link to=&quot;/users/signin&quot;&gt;登录&lt;/Link&gt;&lt;/li&gt;)</span>
<span class="line">+                            }</span>
<span class="line">+                            {</span>
<span class="line">+                                this.props.user&amp;&amp;this.props.user.admin&amp;&amp;&lt;li&gt;&lt;Link to=&quot;/articles/add&quot;&gt;发表文章&lt;/Link&gt;&lt;/li&gt;</span>
<span class="line">+                            }</span>
<span class="line">+                        &lt;/ul&gt;</span>
<span class="line">+                        {</span>
<span class="line">+                            this.props.user&amp;&amp;&lt;ul className=&quot;nav navbar-nav navbar-right&quot;&gt;</span>
<span class="line">                             &lt;li&gt;</span>
<span class="line">-                                &lt;Link to=&quot;/users/signout&quot;&gt;退出&lt;/Link&gt;</span>
<span class="line">-                            &lt;/li&gt;</span>
<span class="line">-                            &lt;/ul&gt;</span>
<span class="line">+                                &lt;Link to=&quot;/users/signout&quot;&gt;欢迎:{this.props.user.username}&lt;/Link&gt;</span>
<span class="line">+                             &lt;/li&gt;</span>
<span class="line">+                             &lt;li&gt;</span>
<span class="line">+                                    &lt;a onClick={this.props.logout}&gt;退出&lt;/a&gt;</span>
<span class="line">+                             &lt;/li&gt;</span>
<span class="line">+                             &lt;/ul&gt;</span>
<span class="line">+                        }</span>
<span class="line">                         &lt;/div&gt;</span>
<span class="line">                     &lt;/div&gt;</span>
<span class="line">                 &lt;/nav&gt;</span>
<span class="line">         )</span>
<span class="line">     }</span>
<span class="line"> }</span>
<span class="line">-export default connect(state=&gt;state.user)(NavHeader);</span>
<span class="line">+export default connect(state=&gt;state.user,actions)(NavHeader);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-app-js" tabindex="-1"><a class="header-anchor" href="#_4-2-app-js"><span>4.2 App.js</span></a></h3><p>src/containers/App.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">-import {Link,Route} from &#39;react-router-dom&#39;;</span>
<span class="line">+import {Route} from &#39;react-router-dom&#39;;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-3-signin-js" tabindex="-1"><a class="header-anchor" href="#_4-3-signin-js"><span>4.3 Signin.js</span></a></h3><p>src/containers/Signin.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> import React,{Component} from &#39;react&#39;</span>
<span class="line">-export default class Signin extends Component{</span>
<span class="line">+import actions from &#39;../store/actions/user&#39;;</span>
<span class="line">+import {connect} from &#39;react-redux&#39;;</span>
<span class="line">+class Signin extends Component{</span>
<span class="line">+    handleSubmit=(event) =&gt; {</span>
<span class="line">+        event.preventDefault();</span>
<span class="line">+        let username=this.username.value;</span>
<span class="line">+        let password=this.password.value;</span>
<span class="line">+        let user={username,password};</span>
<span class="line">+        this.props.login(user);</span>
<span class="line">+    }</span>
<span class="line">     render() {</span>
<span class="line">         return (</span>
<span class="line">-            &lt;div&gt;Signin&lt;/div&gt;</span>
<span class="line">+            &lt;form onSubmit={this.handleSubmit}&gt;</span>
<span class="line">+                &lt;div className=&quot;form-group&quot;&gt;</span>
<span class="line">+                    &lt;label htmlFor=&quot;username&quot;&gt;用户名&lt;/label&gt;</span>
<span class="line">+                    &lt;input className=&quot;form-control&quot; ref={input=&gt;this.username=input}/&gt;</span>
<span class="line">+                &lt;/div&gt;</span>
<span class="line">+                &lt;div className=&quot;form-group&quot;&gt;</span>
<span class="line">+                    &lt;label htmlFor=&quot;password&quot;&gt;密码&lt;/label&gt;</span>
<span class="line">+                    &lt;input className=&quot;form-control&quot; ref={input=&gt;this.password=input}/&gt;</span>
<span class="line">+                &lt;/div&gt;</span>
<span class="line">+                &lt;div className=&quot;form-group&quot;&gt;</span>
<span class="line">+                    &lt;input type=&quot;submit&quot; className=&quot;btn btn-primary&quot;/&gt;</span>
<span class="line">+                &lt;/div&gt;</span>
<span class="line">+                {</span>
<span class="line">+                    this.props.error&amp;&amp;(</span>
<span class="line">+                        &lt;div className=&quot;form-group&quot;&gt;</span>
<span class="line">+                                &lt;div className=&quot;alert alert-danger&quot;&gt;</span>
<span class="line">+                                    {this.props.error.toString()}</span>
<span class="line">+                                &lt;/div&gt;</span>
<span class="line">+                        &lt;/div&gt;</span>
<span class="line">+                    )</span>
<span class="line">+                }</span>
<span class="line">+                </span>
<span class="line">+            &lt;/form&gt;</span>
<span class="line">         )</span>
<span class="line">     }</span>
<span class="line">-}</span>
<span class="line">+}</span>
<span class="line">+export default connect(</span>
<span class="line">+    state =&gt; state.user,</span>
<span class="line">+    actions</span>
<span class="line">+)(Signin);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-4-action-types-js" tabindex="-1"><a class="header-anchor" href="#_4-4-action-types-js"><span>4.4 action-types.js</span></a></h3><p>src/store/action-types.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">export const LOGIN=&#39;LOGIN&#39;;</span>
<span class="line">export const LOGOUT=&#39;LOGOUT&#39;;</span>
<span class="line">export const LOGIN_SUCCESS=&#39;LOGIN_SUCCESS&#39;;</span>
<span class="line">export const LOGIN_ERROR=&#39;LOGIN_ERROR&#39;;</span>
<span class="line">export const LOGIN_OUT_SUCCESS=&#39;LOGIN_OUT_SUCCESS&#39;;</span>
<span class="line">export const LOAD_USER=&#39;LOAD_USER&#39;;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-5-index-js" tabindex="-1"><a class="header-anchor" href="#_4-5-index-js"><span>4.5 index.js</span></a></h3><p>src/store/index.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">-import {createStore} from &#39;redux&#39;;</span>
<span class="line">+import {createStore,applyMiddleware} from &#39;redux&#39;;</span>
<span class="line"> import reducers from &#39;./reducers&#39;;</span>
<span class="line">-let store=createStore(reducers);</span>
<span class="line">+import createSagaMiddelware from &#39;redux-saga&#39;;</span>
<span class="line">+import logger from &#39;redux-logger&#39;;</span>
<span class="line">+import rootSaga from &#39;./saga&#39;;</span>
<span class="line">+import {routerMiddleware} from &#39;react-router-redux&#39;;</span>
<span class="line">+import history from &#39;../history&#39;;</span>
<span class="line">+let router=routerMiddleware(history);</span>
<span class="line">+let sagaMiddleware=createSagaMiddelware();</span>
<span class="line">+let store=createStore(reducers,applyMiddleware(sagaMiddleware,router,logger));</span>
<span class="line">+sagaMiddleware.run(rootSaga);</span>
<span class="line"> export default store;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-6-saga-js" tabindex="-1"><a class="header-anchor" href="#_4-6-saga-js"><span>4.6 saga.js</span></a></h3><p>src/store/saga.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> types <span class="token keyword">from</span> <span class="token string">&#39;./action-types&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>put<span class="token punctuation">,</span>call<span class="token punctuation">,</span>take<span class="token punctuation">,</span>all<span class="token punctuation">,</span>takeEvery<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;redux-saga/effects&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>push<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react-router-redux&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> userApi <span class="token keyword">from</span> <span class="token string">&#39;./api/user&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>decode<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../utils/jwt&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter">action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">const</span> response<span class="token operator">=</span><span class="token keyword">yield</span> <span class="token function">call</span><span class="token punctuation">(</span>userApi<span class="token punctuation">.</span>login<span class="token punctuation">,</span>action<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">let</span> <span class="token punctuation">{</span><span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>token<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">=</span>response<span class="token punctuation">;</span></span>
<span class="line">        window<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">,</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">const</span> user<span class="token operator">=</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> types<span class="token punctuation">.</span><span class="token constant">LOGIN_SUCCESS</span><span class="token punctuation">,</span>user<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> types<span class="token punctuation">.</span><span class="token constant">LOGIN_ERROR</span><span class="token punctuation">,</span>error<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    window<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> types<span class="token punctuation">.</span><span class="token constant">LOGIN_OUT_SUCCESS</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">loginFlow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">yield</span> <span class="token function">takeEvery</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">LOGIN</span><span class="token punctuation">,</span>login<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">yield</span> <span class="token function">takeEvery</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">LOGOUT</span><span class="token punctuation">,</span>logout<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">loadUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> token <span class="token operator">=</span> window<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">const</span> user<span class="token operator">=</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> types<span class="token punctuation">.</span><span class="token constant">LOGIN_SUCCESS</span><span class="token punctuation">,</span>user<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&#39;/users/signin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">watchLoadUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">yield</span> <span class="token function">takeEvery</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token constant">LOAD_USER</span><span class="token punctuation">,</span>loadUser<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">rootSaga</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">yield</span> <span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">loginFlow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">watchLoadUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-7-user-js" tabindex="-1"><a class="header-anchor" href="#_4-7-user-js"><span>4.7 user.js</span></a></h3><p>src/store/actions/user.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> types <span class="token keyword">from</span> <span class="token string">&#39;../action-types&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span>types<span class="token punctuation">.</span><span class="token constant">LOGIN</span><span class="token punctuation">,</span>user<span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span>types<span class="token punctuation">.</span><span class="token constant">LOGOUT</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">loadUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span>types<span class="token punctuation">.</span><span class="token constant">LOAD_USER</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-8-index-js" tabindex="-1"><a class="header-anchor" href="#_4-8-index-js"><span>4.8 index.js</span></a></h3><p>src/store/api/index.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&#39;axios&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token constant">BASE_URL</span><span class="token operator">=</span><span class="token string">&#39;http://localhost:8080&#39;</span><span class="token punctuation">;</span></span>
<span class="line">axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> token<span class="token operator">=</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&#39;token&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>Authorization<span class="token operator">=</span>token<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">return</span> config<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span>body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token constant">BASE_URL</span><span class="token operator">+</span><span class="token string">&#39;/users/signin&#39;</span><span class="token punctuation">,</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-9-user-js" tabindex="-1"><a class="header-anchor" href="#_4-9-user-js"><span>4.9 user.js</span></a></h3><p>src/store/api/user.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>post<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./index&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter">body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/users/signin&#39;</span><span class="token punctuation">,</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">    login</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-10-index-js" tabindex="-1"><a class="header-anchor" href="#_4-10-index-js"><span>4.10 index.js</span></a></h3><p>src/store/reducers/index.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> import {combineReducers} from &#39;redux&#39;;</span>
<span class="line"> import user from &#39;./user&#39;;</span>
<span class="line">+import {routerReducer} from &#39;react-router-redux&#39;;</span>
<span class="line"> export default combineReducers({</span>
<span class="line">+  router:routerReducer</span>
<span class="line"> });</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-11-user-js" tabindex="-1"><a class="header-anchor" href="#_4-11-user-js"><span>4.11 user.js</span></a></h3><p>src/store/reducers/user.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">-let initState={username:&#39;张三&#39;};</span>
<span class="line">+import * as types from &#39;../action-types&#39;;</span>
<span class="line">+let initState={};</span>
<span class="line"> export default function (state=initState,action) {</span>
<span class="line">-    return state;</span>
<span class="line">+    switch (action.type) {</span>
<span class="line">+        case types.LOGIN_SUCCESS:</span>
<span class="line">+            return {...state,user:action.user,error: null};</span>
<span class="line">+        case types.LOGIN_ERROR:</span>
<span class="line">+            return {...state,user: null,error: action.error};</span>
<span class="line">+            case types.LOGIN_OUT_SUCCESS:</span>
<span class="line">+            return {...state,user: null,error: null};</span>
<span class="line">+        default:</span>
<span class="line">+            return state;</span>
<span class="line">+    }</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-12-jwt-js" tabindex="-1"><a class="header-anchor" href="#_4-12-jwt-js"><span>4.12 jwt.js</span></a></h3><p>src/utils/jwt.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> jwt <span class="token keyword">from</span> <span class="token string">&#39;jsonwebtoken&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token parameter">token</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> jwt<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-发表文章权限控制" tabindex="-1"><a class="header-anchor" href="#_5-发表文章权限控制"><span>5. 发表文章权限控制</span></a></h2><h3 id="_5-1-article-add-js" tabindex="-1"><a class="header-anchor" href="#_5-1-article-add-js"><span>5.1 article/Add.js</span></a></h3><p>src/containers/article/Add.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> import React,{Component} from &#39;react&#39;</span>
<span class="line">-export default class Add extends Component{</span>
<span class="line">+import actions from &#39;../../store/actions/article&#39;;</span>
<span class="line">+import {connect} from &#39;react-redux&#39;;</span>
<span class="line">+class Signin extends Component{</span>
<span class="line">+    handleSubmit=(event) =&gt; {</span>
<span class="line">+        event.preventDefault();</span>
<span class="line">+        let title=this.title.value;</span>
<span class="line">+        let content=this.content.value;</span>
<span class="line">+        let article={title,content};</span>
<span class="line">+        this.props.add(article);</span>
<span class="line">+    }</span>
<span class="line">     render() {</span>
<span class="line">         return (</span>
<span class="line">-            &lt;div&gt;Article Add&lt;/div&gt;</span>
<span class="line">+            &lt;form onSubmit={this.handleSubmit}&gt;</span>
<span class="line">+                &lt;div className=&quot;form-group&quot;&gt;</span>
<span class="line">+                    &lt;label htmlFor=&quot;title&quot;&gt;标题&lt;/label&gt;</span>
<span class="line">+                    &lt;input className=&quot;form-control&quot; ref={input=&gt;this.title=input}/&gt;</span>
<span class="line">+                &lt;/div&gt;</span>
<span class="line">+                &lt;div className=&quot;form-group&quot;&gt;</span>
<span class="line">+                    &lt;label htmlFor=&quot;content&quot;&gt;内容&lt;/label&gt;</span>
<span class="line">+                    &lt;textarea className=&quot;form-control&quot; ref={input=&gt;this.content=input}/&gt;</span>
<span class="line">+                &lt;/div&gt;</span>
<span class="line">+                &lt;div className=&quot;form-group&quot;&gt;</span>
<span class="line">+                    &lt;input type=&quot;submit&quot; className=&quot;btn btn-primary&quot;/&gt;</span>
<span class="line">+                &lt;/div&gt;</span>
<span class="line">+                {</span>
<span class="line">+                    this.props.error&amp;&amp;(</span>
<span class="line">+                        &lt;div className=&quot;form-group&quot;&gt;</span>
<span class="line">+                                &lt;div className=&quot;alert alert-danger&quot;&gt;</span>
<span class="line">+                                    {this.props.error.toString()}</span>
<span class="line">+                                &lt;/div&gt;</span>
<span class="line">+                        &lt;/div&gt;</span>
<span class="line">+                    )</span>
<span class="line">+                }</span>
<span class="line">+                </span>
<span class="line">+            &lt;/form&gt;</span>
<span class="line">         )</span>
<span class="line">     }</span>
<span class="line">-}</span>
<span class="line">+}</span>
<span class="line">+export default connect(</span>
<span class="line">+    state =&gt; state.article,</span>
<span class="line">+    actions</span>
<span class="line">+)(Signin);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2-action-types-js" tabindex="-1"><a class="header-anchor" href="#_5-2-action-types-js"><span>5.2 action-types.js</span></a></h3><p>src/store/action-types.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">-export const LOAD_USER=&#39;LOAD_USER&#39;;</span>
<span class="line">+export const LOAD_USER=&#39;LOAD_USER&#39;;</span>
<span class="line">+export const ADD_ARTICLE=&#39;ADD_ARTICLE&#39;;</span>
<span class="line">+export const ADD_ARTICLE_SUCCESS=&#39;ADD_ARTICLE_SUCCESS&#39;;</span>
<span class="line">+export const ADD_ARTICLE_ERROR=&#39;ADD_ARTICLE_ERROR&#39;;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-saga-js" tabindex="-1"><a class="header-anchor" href="#_5-3-saga-js"><span>5.3 saga.js</span></a></h3><p>src/store/saga.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">+function* addArticle(action) {</span>
<span class="line">+    try {</span>
<span class="line">+        debugger;</span>
<span class="line">+        yield call(articleApi.add,action.article);</span>
<span class="line">+        yield put(push(&#39;/&#39;));</span>
<span class="line">+    } catch (error) {</span>
<span class="line">+        yield put({type: types.ADD_ARTICLE_ERROR,error});</span>
<span class="line">+    }</span>
<span class="line">+}</span>
<span class="line">+</span>
<span class="line">+function* watchAddArticle() {</span>
<span class="line">+    yield takeEvery(types.ADD_ARTICLE,addArticle);</span>
<span class="line">+}</span>
<span class="line">+</span>
<span class="line"> export default function* rootSaga() {</span>
<span class="line">-    yield all([loginFlow(),watchLoadUser()]);</span>
<span class="line">+    yield all([loginFlow(),watchLoadUser(),watchAddArticle()]);</span>
<span class="line"> }</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-4-actions-article-js" tabindex="-1"><a class="header-anchor" href="#_5-4-actions-article-js"><span>5.4 actions/article.js</span></a></h3><p>src/store/actions/article.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">import * as types from &#39;../action-types&#39;;</span>
<span class="line">export default {</span>
<span class="line">    add(article) {</span>
<span class="line">        return {type:types.ADD_ARTICLE,article}</span>
<span class="line">    }</span>
<span class="line">}</span>
<span class="line">\`</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-5-article-js" tabindex="-1"><a class="header-anchor" href="#_5-5-article-js"><span>5.5 article.js</span></a></h3><p>src/store/api/article.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span>post<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;.&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/articles/add&#39;</span><span class="token punctuation">,</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">    add</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-6-api-index-js" tabindex="-1"><a class="header-anchor" href="#_5-6-api-index-js"><span>5.6 api/index.js</span></a></h3><p>src/store/api/index.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">-    return axios.post(BASE_URL+&#39;/users/signin&#39;,body);</span>
<span class="line">+    return axios.post(BASE_URL+url,body);</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-7-api-user-js" tabindex="-1"><a class="header-anchor" href="#_5-7-api-user-js"><span>5.7 api/user.js</span></a></h3><p>src/store/api/user.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">-</span><span class="token keyword">import</span> <span class="token punctuation">{</span>post<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./index&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">+</span><span class="token keyword">import</span> <span class="token punctuation">{</span>post<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;.&#39;</span><span class="token punctuation">;</span></span>
<span class="line"> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter">body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">     <span class="token keyword">return</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&#39;/users/signin&#39;</span><span class="token punctuation">,</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>    </span>
<span class="line"> <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-8-reducers-article-js" tabindex="-1"><a class="header-anchor" href="#_5-8-reducers-article-js"><span>5.8 reducers/article.js</span></a></h3><p>src/store/reducers/article.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> types <span class="token keyword">from</span> <span class="token string">&#39;../action-types&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> initState<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token operator">=</span>initState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">case</span> types<span class="token punctuation">.</span><span class="token constant">ADD_ARTICLE_ERROR</span><span class="token operator">:</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token operator">...</span>state<span class="token punctuation">,</span><span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span><span class="token literal-property property">error</span><span class="token operator">:</span> action<span class="token punctuation">.</span>error<span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">default</span><span class="token operator">:</span></span>
<span class="line">            <span class="token keyword">return</span> state<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-9-reducers-index-js" tabindex="-1"><a class="header-anchor" href="#_5-9-reducers-index-js"><span>5.9 reducers/index.js</span></a></h3><p>src/store/reducers/index.js</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">+ import {routerReducer} from &#39;react-router-redux&#39;;</span>
<span class="line">export default combineReducers({</span>
<span class="line">  user,</span>
<span class="line">+  article,</span>
<span class="line">  router:routerReducer</span>
<span class="line">});</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考仓库" tabindex="-1"><a class="header-anchor" href="#参考仓库"><span>参考仓库</span></a></h2><ul><li><a href="https://github.com/ReactTraining/react-router/tree/master/packages/react-router-redux" target="_blank" rel="noopener noreferrer">react-router-redux</a></li><li><a href="https://gitee.com/zhufengpeixun/jwt-frontend" target="_blank" rel="noopener noreferrer">jwt-frontend</a></li></ul>`,101)])])}const o=n(t,[["render",l]]),r=JSON.parse('{"path":"/strong/28.redux-jwt-front.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/28.redux-jwt-front.md"}');export{o as comp,r as data};
