import{_ as a,c as n,a as e,o as t}from"./app-CD1YpnS1.js";const l={};function i(p,s){return t(),n("div",null,[...s[0]||(s[0]=[e(`<h2 id="_1-shell基础" tabindex="-1"><a class="header-anchor" href="#_1-shell基础"><span>1. shell基础</span></a></h2><ul><li>shell是一个命令行解释器，它为用户提供了一个向Linux内核发送请求以便运行程序的界面系统级程序</li><li>用户可以用Shell来启动、挂起、停止或者编写一些程序</li><li>Shell还是一个功能相当强大的编程语言，易编写，易调试，灵活性较强。</li><li>Shell是解释执行的脚本语言，在Shell中可以直接调用Linux系统命令。</li></ul><h3 id="_1-1-查看支持的shell" tabindex="-1"><a class="header-anchor" href="#_1-1-查看支持的shell"><span>1.1 查看支持的shell</span></a></h3><ul><li><code>cat /etc/shells</code></li></ul><p>查看shell的帮助信息</p><table><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;">man bash</td><td style="text-align:left;">查看bash的命令帮助</td></tr><tr><td style="text-align:left;">info bash</td><td style="text-align:left;">查看bash的文档</td></tr><tr><td style="text-align:left;">help</td><td style="text-align:left;">命令显示bash支持的命令</td></tr><tr><td style="text-align:left;">help cd</td><td style="text-align:left;">如果想看某个命令的帮助可以 <code>help</code> 命令</td></tr></tbody></table><h3 id="_1-2-echo" tabindex="-1"><a class="header-anchor" href="#_1-2-echo"><span>1.2 echo</span></a></h3><ul><li>输出命令</li><li>--e 支持反斜线控制的字符转换</li></ul><table><thead><tr><th style="text-align:left;">控制字符</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;">\\n</td><td style="text-align:left;">换行符</td></tr><tr><td style="text-align:left;">\\r</td><td style="text-align:left;">回车键</td></tr><tr><td style="text-align:left;">\\t</td><td style="text-align:left;">制表符，也就是Tab键</td></tr><tr><td style="text-align:left;">\\v</td><td style="text-align:left;">垂直制表符</td></tr><tr><td style="text-align:left;">\\onnn</td><td style="text-align:left;">按照八进制ASCII码表输出字符，其中0为数字零，nnn是三位八进制数</td></tr><tr><td style="text-align:left;">\\xhh</td><td style="text-align:left;">按照十六进制ASCII码表输出字符，其中hh是两位十六进制数</td></tr></tbody></table><table><thead><tr><th style="text-align:left;">符号</th><th style="text-align:left;">颜色</th></tr></thead><tbody><tr><td style="text-align:left;"></td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;"></td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">echo <span class="token operator">-</span>e <span class="token string">&quot;12\\r\\n34\\t56\\v78&quot;</span></span>
<span class="line">echo <span class="token operator">-</span>e <span class="token string">&quot;\\0141&quot;</span></span>
<span class="line">echo <span class="token operator">-</span>e <span class="token string">&quot;\\x61&quot;</span></span>
<span class="line">echo <span class="token operator">-</span>e <span class="token string">&quot;\\e[1;31m warning \\e[0m&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-3-编写执行shell" tabindex="-1"><a class="header-anchor" href="#_1-3-编写执行shell"><span>1.3 编写执行shell</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">echo <span class="token operator">-</span>e <span class="token string">&quot;\\e[1;34m hello world \\e[0m&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>赋予执行权限，直接运行</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">chmod 755 hello.sh</span>
<span class="line">./hello.sh</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>通过Bash调用执行脚本</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">bash hello.sh</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_1-4-别名" tabindex="-1"><a class="header-anchor" href="#_1-4-别名"><span>1.4 别名</span></a></h3><ul><li>命令别名 == 小名</li><li>临时生效</li><li>alias</li><li>alias rm=&quot;rm -i&quot;</li><li>写入环境变量配置文件 vi ~/.bashrc</li><li>source ~/.bashrc</li><li>unalias 别名 删除别名</li></ul><h3 id="_1-5-命令的生效顺序" tabindex="-1"><a class="header-anchor" href="#_1-5-命令的生效顺序"><span>1.5 命令的生效顺序</span></a></h3><ul><li>绝对路径或者相对路径</li><li>别名</li><li>bash内部命令</li><li>按照$PATH环境变量定义的目录查找顺序找到的第一个命令</li></ul><h3 id="_1-6-命令快捷键" tabindex="-1"><a class="header-anchor" href="#_1-6-命令快捷键"><span>1.6 命令快捷键</span></a></h3><table><thead><tr><th style="text-align:left;">命令</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">ctrl+c</td><td style="text-align:left;">强制终止当前命令</td></tr><tr><td style="text-align:left;">ctrl+l</td><td style="text-align:left;">清屏</td></tr><tr><td style="text-align:left;">ctrl+a</td><td style="text-align:left;">光标移动到命令行首</td></tr><tr><td style="text-align:left;">ctrl+e</td><td style="text-align:left;">光标移动到命令行尾</td></tr><tr><td style="text-align:left;">ctrl+u</td><td style="text-align:left;">从光标所在的位置删除到行首</td></tr><tr><td style="text-align:left;">ctrl+z</td><td style="text-align:left;">把命令放入后台</td></tr><tr><td style="text-align:left;">fg</td><td style="text-align:left;">把任务带回前台</td></tr><tr><td style="text-align:left;">ctrl+r</td><td style="text-align:left;">在历史命令中搜索</td></tr></tbody></table><h3 id="_1-7-历史命令" tabindex="-1"><a class="header-anchor" href="#_1-7-历史命令"><span>1.7 历史命令</span></a></h3><ul><li>history [选项] [历史命令保存文件]</li><li>选项 <ul><li>-c 清空历史命令</li><li>-w 把缓存中的历史命令写入历史命令保存文件 ~/.bash_history</li></ul></li><li>默认保存1000条 /etc/profile <code>HISSIZE=10000</code></li></ul><h3 id="_1-8-调用" tabindex="-1"><a class="header-anchor" href="#_1-8-调用"><span>1.8 调用</span></a></h3><ul><li>使用上下箭头调用以前的历史命令</li><li>使用 !n 重复执行第n条历史命令</li><li>使用 !! 重复执行上一条命令</li><li>使用 !字符 重复执行最后一条以该字符串开头的命令</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">history <span class="token operator">-</span>c</span>
<span class="line"><span class="token number">1</span>  echo <span class="token number">1</span></span>
<span class="line"><span class="token number">2</span>  echo <span class="token number">2</span></span>
<span class="line"><span class="token number">3</span>  echo <span class="token number">3</span></span>
<span class="line"><span class="token operator">!</span><span class="token number">2</span></span>
<span class="line"><span class="token operator">!</span><span class="token operator">!</span></span>
<span class="line"><span class="token operator">!</span>echo</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-9-输出重定向" tabindex="-1"><a class="header-anchor" href="#_1-9-输出重定向"><span>1.9 输出重定向</span></a></h3><h4 id="_1-9-1-标准输入输出" tabindex="-1"><a class="header-anchor" href="#_1-9-1-标准输入输出"><span>1.9.1 标准输入输出</span></a></h4><table><thead><tr><th style="text-align:left;">设备</th><th style="text-align:left;">设备文件名</th><th style="text-align:left;">文件描述符</th><th style="text-align:left;">类型</th></tr></thead><tbody><tr><td style="text-align:left;">键盘</td><td style="text-align:left;">/dev/stdin</td><td style="text-align:left;">0</td><td style="text-align:left;">标准输入</td></tr><tr><td style="text-align:left;">显示器</td><td style="text-align:left;">/dev/stdout</td><td style="text-align:left;">1</td><td style="text-align:left;">标准输出</td></tr><tr><td style="text-align:left;">显示器</td><td style="text-align:left;">/dev/stderr</td><td style="text-align:left;">2</td><td style="text-align:left;">标准错误输出</td></tr></tbody></table><table><thead><tr><th style="text-align:left;">类型</th><th style="text-align:left;">符号</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;">标准输出重定向</td><td style="text-align:left;">命令 &gt; 文件</td><td style="text-align:left;">以覆盖的方式，把命令的正确输出输出到指定的文件或设备当中</td></tr><tr><td style="text-align:left;">标准输出重定向</td><td style="text-align:left;">命令 &gt;&gt; 文件</td><td style="text-align:left;">以追加的方式，把命令的正确输出输出到指定的文件或设备当中</td></tr><tr><td style="text-align:left;">错误输出重定向</td><td style="text-align:left;">命令&gt;文件</td><td style="text-align:left;">以覆盖的方式，把命令的错误输出输出到指定的文件或设备当中</td></tr><tr><td style="text-align:left;">错误输出重定向</td><td style="text-align:left;">命令&gt;&gt;文件</td><td style="text-align:left;">以追加的方式，把命令的错误输出输出到指定的文件或设备当中</td></tr><tr><td style="text-align:left;">正确输出和错误输出同时保存</td><td style="text-align:left;">命令&gt;文件 2&gt;&amp;1</td><td style="text-align:left;">以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中</td></tr><tr><td style="text-align:left;">正确输出和错误输出同时保存</td><td style="text-align:left;">命令&gt;文件 2&gt;&gt;&amp;1</td><td style="text-align:left;">以追加的方式，把正确输出和错误输出都保存到同一个文件当中</td></tr><tr><td style="text-align:left;">正确输出和错误输出同时保存</td><td style="text-align:left;">命令&amp;&gt;文件</td><td style="text-align:left;">以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中</td></tr><tr><td style="text-align:left;">正确输出和错误输出同时保存</td><td style="text-align:left;">命令&amp;&gt;&gt;文件</td><td style="text-align:left;">以追加的方式，把正确输出和错误输出都保存到同一个文件当中</td></tr><tr><td style="text-align:left;">正确输出和错误输出同时保存</td><td style="text-align:left;">命令&gt;&gt;文件1 2&gt;文件2</td><td style="text-align:left;">以覆盖的方式，正确的输出追加到文件1中，把错误输出追加到文件2中</td></tr></tbody></table><h4 id="_1-9-2-输入重定向" tabindex="-1"><a class="header-anchor" href="#_1-9-2-输入重定向"><span>1.9.2 输入重定向</span></a></h4><ul><li><code>wc</code>命令的功能为统计指定文件中的行数、字数、字节数, 并将统计结果显示输出</li><li>命令 &lt; 文件把文件做为命令的输入</li><li>命令 &lt;&lt; 标识符 标识符把标识符之间内容作为命令的输入</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">- wc &lt; access.log </span>
<span class="line"> [root@localhost ~]</span>
<span class="line">&gt; hello world</span>
<span class="line">&gt; !</span>
<span class="line"> 1  2 12</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-10-管道符号" tabindex="-1"><a class="header-anchor" href="#_1-10-管道符号"><span>1.10 管道符号</span></a></h3><h4 id="_1-10-1-多命令顺序执行" tabindex="-1"><a class="header-anchor" href="#_1-10-1-多命令顺序执行"><span>1.10.1 多命令顺序执行</span></a></h4><table><thead><tr><th style="text-align:left;">多命令执行符</th><th style="text-align:left;">格式</th><th style="text-align:left;">作用</th><th style="text-align:left;">案例</th></tr></thead><tbody><tr><td style="text-align:left;">;</td><td style="text-align:left;">命令1;命令2</td><td style="text-align:left;">多个命令执行，命令之间没有任何逻辑联系</td><td style="text-align:left;">echo 1;echo 2;</td></tr><tr><td style="text-align:left;">&amp;&amp;</td><td style="text-align:left;">命令1&amp;&amp;命令2</td><td style="text-align:left;">逻辑与 当命令1正确执行，则命令2才会执行 当命令1执行不正确，则命令2不会执行</td><td style="text-align:left;">echo 1&amp;&amp;echo 2;</td></tr><tr><td style="text-align:left;">\\|命令1\\\\ 命令2</td><td style="text-align:left;">逻辑或 当命令1执行不正确，则命令2才会执行 当命令1正确执行，则命令2不会执行</td><td style="text-align:left;">echo 1\\\\echo 2;</td><td style="text-align:left;"></td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token operator">-</span> date<span class="token punctuation">;</span>ls<span class="token punctuation">;</span>date<span class="token punctuation">;</span>ls</span>
<span class="line"><span class="token operator">-</span> ls <span class="token operator">&amp;&amp;</span> echo yes <span class="token operator">||</span> echo no</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-10-2-管道符号" tabindex="-1"><a class="header-anchor" href="#_1-10-2-管道符号"><span>1.10.2 管道符号</span></a></h4><ul><li>命令1的正确输出会作为命令2的操作对象</li><li>命令1|命令2<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">ls /etc/ | more</span>
<span class="line">netstat -an | grep ESTABLISHED | wc -l</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_1-10-3-通配符" tabindex="-1"><a class="header-anchor" href="#_1-10-3-通配符"><span>1.10.3 通配符</span></a></h4><p>匹配文件名和目录名</p><table><thead><tr><th style="text-align:left;">通配符</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;">?</td><td style="text-align:left;">匹配一个任意字符</td></tr><tr><td style="text-align:left;">*</td><td style="text-align:left;">匹配0个或任意字符，也就是可以匹配任意内容</td></tr><tr><td style="text-align:left;">[]</td><td style="text-align:left;">匹配中括号中任意一个字符</td></tr><tr><td style="text-align:left;">[-]</td><td style="text-align:left;">匹配中括号中任意一个字符,-代表范围</td></tr><tr><td style="text-align:left;">[^]</td><td style="text-align:left;">匹配不是中括号中的一个字符</td></tr></tbody></table><h4 id="_1-10-4-其它符号" tabindex="-1"><a class="header-anchor" href="#_1-10-4-其它符号"><span>1.10.4 其它符号</span></a></h4><table><thead><tr><th style="text-align:left;">符号</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;">&#39;&#39;</td><td style="text-align:left;">单引号。在单引号中所有的特殊符号，如$和\`都没有特殊含义</td></tr><tr><td style="text-align:left;">&quot;&quot;</td><td style="text-align:left;">双引号，在双引号里特殊符号都没有特殊含义，但是 $ \` \\ 例外，拥有调用变量值，引用命令和转义的含义</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">反引号，扩起来的是系统命令</td></tr><tr><td style="text-align:left;">$()</td><td style="text-align:left;">和反引号一样</td></tr><tr><td style="text-align:left;">#</td><td style="text-align:left;">在shell脚本中，</td></tr><tr><td style="text-align:left;">$</td><td style="text-align:left;">用于调用变量的值</td></tr><tr><td style="text-align:left;">|转义符号</td><td style="text-align:left;"></td></tr></tbody></table><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">-  a=\`ls\`</span>
<span class="line">-  b=$(ls)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-变量" tabindex="-1"><a class="header-anchor" href="#_2-变量"><span>2. 变量</span></a></h2><h3 id="_2-1-什么是变量" tabindex="-1"><a class="header-anchor" href="#_2-1-什么是变量"><span>2.1 什么是变量</span></a></h3><ul><li>可以变化的量</li><li>变量必须以字母或下划线开头，名字中间只能由字母，数字和下划线组成</li><li>变量名的长度不得超过255个字符</li><li>变量名在有效范围内必须唯一</li><li>变量默认类型都是字符串</li></ul><h3 id="_2-2-变量的分类" tabindex="-1"><a class="header-anchor" href="#_2-2-变量的分类"><span>2.2 变量的分类</span></a></h3><ul><li>字符串</li><li>整型</li><li>浮点型</li><li>日期型</li></ul><h3 id="_2-3-用户自定义变量" tabindex="-1"><a class="header-anchor" href="#_2-3-用户自定义变量"><span>2.3 用户自定义变量</span></a></h3><ul><li>这些变量的值是自己定义的</li><li>变量名不能为数字开头</li><li>等号左右两边不能有空格</li></ul><h4 id="_2-3-1-定义变量" tabindex="-1"><a class="header-anchor" href="#_2-3-1-定义变量"><span>2.3.1 定义变量</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">name<span class="token operator">=</span><span class="token string">&quot;zhufeng&quot;</span></span>
<span class="line">age<span class="token operator">=</span><span class="token number">10</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-2-输出变量值" tabindex="-1"><a class="header-anchor" href="#_2-3-2-输出变量值"><span>2.3.2 输出变量值</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">echo $变量名</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-3-3-值默认都是字符串" tabindex="-1"><a class="header-anchor" href="#_2-3-3-值默认都是字符串"><span>2.3.3 值默认都是字符串</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">$ x<span class="token operator">=</span><span class="token number">1</span></span>
<span class="line">$ y<span class="token operator">=</span><span class="token number">2</span></span>
<span class="line">$ z<span class="token operator">=</span><span class="token number">3</span></span>
<span class="line">$ z<span class="token operator">=</span>$x<span class="token operator">+</span>$y<span class="token operator">+</span>$z</span>
<span class="line">$ echo $z</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-4-在赋值的时候引用变量" tabindex="-1"><a class="header-anchor" href="#_2-3-4-在赋值的时候引用变量"><span>2.3.4 在赋值的时候引用变量</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">y<span class="token operator">=</span><span class="token string">&quot;$y&quot;</span><span class="token number">2</span></span>
<span class="line">y<span class="token operator">=</span>$<span class="token punctuation">{</span>y<span class="token punctuation">}</span><span class="token number">2</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-5-set" tabindex="-1"><a class="header-anchor" href="#_2-3-5-set"><span>2.3.5 set</span></a></h4><ul><li>查询系统中默认所有已经生效的变量，包括系统变量,也包括自定义变量</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">set <span class="token operator">|</span> grep zhufeng</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">$ set <span class="token operator">-</span>u</span>
<span class="line">$ echo $a</span>
<span class="line"><span class="token literal-property property">bash</span><span class="token operator">:</span> a<span class="token operator">:</span> unbound variable</span>
<span class="line">\`</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-6-unset" tabindex="-1"><a class="header-anchor" href="#_2-3-6-unset"><span>2.3.6 unset</span></a></h4><ul><li>删除变量</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">unset a</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-4-环境变量" tabindex="-1"><a class="header-anchor" href="#_2-4-环境变量"><span>2.4 环境变量</span></a></h3><ul><li>环境变量是全局变量，而自定义变量是局部变量</li><li>自定义变量会在当前的shell中生效，而环境变量会在当前shell以及其子shell中生效</li><li>这种变量主要保存的是和系统操作环境相关的数据</li><li>变量可以自定义，但是对系统生效的环境变量名和变量作用是固定的</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">bash </span>
<span class="line">pstree</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-1-自定义环境变量" tabindex="-1"><a class="header-anchor" href="#_2-4-1-自定义环境变量"><span>2.4.1 自定义环境变量</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> 变量名<span class="token operator">=</span>变量值</span>
<span class="line"><span class="token keyword">export</span> envname<span class="token operator">=</span>prod</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-2-env" tabindex="-1"><a class="header-anchor" href="#_2-4-2-env"><span>2.4.2 env</span></a></h4><ul><li>仅仅用来查看环境变量，而不看到本地变量<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">env</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="_2-4-3-常用环境变量" tabindex="-1"><a class="header-anchor" href="#_2-4-3-常用环境变量"><span>2.4.3 常用环境变量</span></a></h4><table><thead><tr><th style="text-align:left;">变量名</th><th style="text-align:left;">含义</th><th style="text-align:left;">示例</th></tr></thead><tbody><tr><td style="text-align:left;">HOSTNAME</td><td style="text-align:left;">主机名</td><td style="text-align:left;">HOSTNAME=localhost</td></tr><tr><td style="text-align:left;">SHELL</td><td style="text-align:left;">当前的shell</td><td style="text-align:left;">SHELL=/bin/bash</td></tr><tr><td style="text-align:left;">TERM</td><td style="text-align:left;">终端环境</td><td style="text-align:left;">TERM=xterm</td></tr><tr><td style="text-align:left;">HISTSIZE</td><td style="text-align:left;">历史命令条数</td><td style="text-align:left;">HISTSIZE=1000</td></tr><tr><td style="text-align:left;">SSH_CLIENT</td><td style="text-align:left;">当前操作环境如果是用SSH连接的话，这里会记录客户端IP</td><td style="text-align:left;">SSH_CLIENT=192.168.1.100 57596 22</td></tr><tr><td style="text-align:left;">SSH_TTY</td><td style="text-align:left;">SSH连接的终端</td><td style="text-align:left;">SSH_TTY=/dev/pts/1</td></tr><tr><td style="text-align:left;">USER</td><td style="text-align:left;">当前登录的用户</td><td style="text-align:left;">USER=root</td></tr></tbody></table><h4 id="_2-4-4-path" tabindex="-1"><a class="header-anchor" href="#_2-4-4-path"><span>2.4.4 path</span></a></h4><ul><li>系统搜索路径</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">/usr/lib/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果想把一个自定义的脚本直接可以执行，或者把这个文件拷贝到目标目录下，或者把脚本所在目录添加到环境变量中的PATH路径中</p><p>hello.sh</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">echo hello</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">.</span><span class="token operator">/</span>hello<span class="token punctuation">.</span>sh</span>
<span class="line"><span class="token operator">/</span>root<span class="token operator">/</span>myshell<span class="token operator">/</span>hello<span class="token punctuation">.</span>sh</span>
<span class="line"><span class="token keyword">export</span> <span class="token constant">PATH</span><span class="token operator">=</span><span class="token string">&quot;$PATH&quot;</span><span class="token operator">:</span><span class="token operator">/</span>root<span class="token operator">/</span>myshell   临时生效</span>
<span class="line">hello<span class="token punctuation">.</span>sh</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-5-ps1" tabindex="-1"><a class="header-anchor" href="#_2-4-5-ps1"><span>2.4.5 $PS1</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">[\\u@\\h \\W]\\$</span>
<span class="line"> root@localhost myshell]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th style="text-align:left;">变量</th><th style="text-align:left;">提示符</th></tr></thead><tbody><tr><td style="text-align:left;">\\d</td><td style="text-align:left;">显示日期，格式为&quot;星期 月 日&quot;</td></tr><tr><td style="text-align:left;">\\H</td><td style="text-align:left;">完整的主机名</td></tr><tr><td style="text-align:left;">\\t</td><td style="text-align:left;">24小时制时间,格式为 &quot;HH:MM:SS&quot;</td></tr><tr><td style="text-align:left;">\\A</td><td style="text-align:left;">24小时制时间，格式为 &quot;HH:MM&quot;</td></tr><tr><td style="text-align:left;">\\u</td><td style="text-align:left;">显示当前用户名</td></tr><tr><td style="text-align:left;">\\w</td><td style="text-align:left;">显示所在目录完整名称</td></tr><tr><td style="text-align:left;">\\W</td><td style="text-align:left;">显示所在目录的最后一个目录</td></tr><tr><td style="text-align:left;">\\$</td><td style="text-align:left;">提示符，root为</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token constant">PS1</span><span class="token operator">=</span><span class="token string">&#39;[\\u@\\h \\w]\\$ &#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-4-6-语系环境变量" tabindex="-1"><a class="header-anchor" href="#_2-4-6-语系环境变量"><span>2.4.6 语系环境变量</span></a></h4><ul><li>查询当前系统语系</li><li>在Linux中通过locale来设置程序运行的不同语言环境，locale由ANSI C提供支持。locale的命名规则为&lt;语言&gt;_&lt;地区&gt;.&lt;字符集编码&gt;，如zh_CN.UTF-8，zh代表中文，CN代表大陆地区，UTF-8表示字符集。</li><li>LANG: 定义系统主语系的变量</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">locale</span>
<span class="line"><span class="token constant">LANG</span><span class="token operator">=</span>zh_CN<span class="token punctuation">.</span><span class="token constant">UTF</span><span class="token operator">-</span><span class="token number">8</span></span>
<span class="line"></span>
<span class="line">echo $<span class="token constant">LANG</span></span>
<span class="line"></span>
<span class="line">下次开机之后我们系统环境</span>
<span class="line">cat <span class="token operator">/</span>etc<span class="token operator">/</span>sysconfig<span class="token operator">/</span>i18n</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-7-中文支持" tabindex="-1"><a class="header-anchor" href="#_2-4-7-中文支持"><span>2.4.7 中文支持</span></a></h4><ul><li>图形界面可以支持中文</li><li>第三方工具比如xshell语系设置正确可以支持中文</li><li>虚拟机中的纯字符界面不支持中文</li></ul><h3 id="_2-5-位置参数变量" tabindex="-1"><a class="header-anchor" href="#_2-5-位置参数变量"><span>2.5 位置参数变量</span></a></h3><ul><li>这种变量主要是用来向脚本当中传递参数或数据的,变量名不能自定义,变量作用是固定的</li></ul><table><thead><tr><th style="text-align:left;">位置参数变量</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;">$n</td><td style="text-align:left;">n为数字，$0代表命令本身，$1-$9代表第1到第9个参数，10以上的参数需要用大括号包含,如\${10}</td></tr><tr><td style="text-align:left;">$*</td><td style="text-align:left;">这个变量代表命令中所有的参数，$*把所有的变看数看成一个整体</td></tr><tr><td style="text-align:left;">$@</td><td style="text-align:left;">这个变量也代表命令行中所有的参数，不过$@把每个参数进行区分</td></tr><tr><td style="text-align:left;">$</td><td style="text-align:left;"></td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">num1<span class="token operator">=</span>$1</span>
<span class="line">num2<span class="token operator">=</span>$2</span>
<span class="line">sum<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>num1<span class="token operator">+</span>num2<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">echo $sum</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token string">&quot;$@&quot;</span></span>
<span class="line"> <span class="token keyword">do</span></span>
<span class="line">   echo <span class="token string">&quot;i=$i&quot;</span></span>
<span class="line"> done</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-6-预定义变量" tabindex="-1"><a class="header-anchor" href="#_2-6-预定义变量"><span>2.6 预定义变量</span></a></h3><ul><li>是脚本中已经定义好的变量，变量名不能自定义，变量作用也是固定的</li></ul><table><thead><tr><th style="text-align:left;">位置参数变量</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;">$?</td><td style="text-align:left;">最后一次执行的命令的返回状态。0表示正确执行，非0表示不正确执行</td></tr><tr><td style="text-align:left;">$$</td><td style="text-align:left;">当前进程的进程号(PID)</td></tr><tr><td style="text-align:left;">$!</td><td style="text-align:left;">后台运行的最后一个进程号(PID)</td></tr></tbody></table><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">ls &amp;&amp; echo yes</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-7-read" tabindex="-1"><a class="header-anchor" href="#_2-7-read"><span>2.7 read</span></a></h3><p>read [选项] [变量名]</p><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-p</td><td style="text-align:left;">提示信息，在等待read输入时，输出提示信息</td></tr><tr><td style="text-align:left;">-t</td><td style="text-align:left;">秒数: read命令会一直等待用户输入，使用此选项可以指定等待时间</td></tr><tr><td style="text-align:left;">-n</td><td style="text-align:left;">字符数，read命令只接受指定的字符数，就会执行</td></tr><tr><td style="text-align:left;">-s</td><td style="text-align:left;">隐藏输入的数据，适用于机密信息的输入</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">read <span class="token operator">-</span>p <span class="token string">&#39;please input your name:&#39;</span> <span class="token operator">-</span>t <span class="token number">5</span> name</span>
<span class="line">echo <span class="token operator">-</span>e <span class="token string">&quot;\\n&quot;</span></span>
<span class="line">read <span class="token operator">-</span>p <span class="token string">&#39;please input you gender[m/f]:&#39;</span> <span class="token operator">-</span>n <span class="token number">1</span> gender</span>
<span class="line">echo <span class="token operator">-</span>e <span class="token string">&quot;\\n&quot;</span></span>
<span class="line">read <span class="token operator">-</span>p <span class="token string">&#39;please input your password:&#39;</span> <span class="token operator">-</span>s password</span>
<span class="line">echo <span class="token operator">-</span>e <span class="token string">&quot;\\n&quot;</span></span>
<span class="line">echo $name<span class="token punctuation">,</span>$gender<span class="token punctuation">,</span>$password</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-运算符" tabindex="-1"><a class="header-anchor" href="#_3-运算符"><span>3. 运算符</span></a></h2><ul><li>弱类型并且默认是字符串类型</li></ul><h3 id="_3-1-declare命令" tabindex="-1"><a class="header-anchor" href="#_3-1-declare命令"><span>3.1 declare命令</span></a></h3><h4 id="_3-1-1-declare命令" tabindex="-1"><a class="header-anchor" href="#_3-1-1-declare命令"><span>3.1.1 declare命令</span></a></h4><ul><li>用来声明变量类型</li><li>declare [+/-] [选项] 变量名</li></ul><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-</td><td style="text-align:left;">给变量设定类型属性</td></tr><tr><td style="text-align:left;">+</td><td style="text-align:left;">取消变量的类型属性</td></tr><tr><td style="text-align:left;">-a</td><td style="text-align:left;">将变量声明为数组类型</td></tr><tr><td style="text-align:left;">-i</td><td style="text-align:left;">将变量声明为整数型(integer)</td></tr><tr><td style="text-align:left;">-x</td><td style="text-align:left;">将变量声明为环境变量</td></tr><tr><td style="text-align:left;">-r</td><td style="text-align:left;">将变量声明为只读变量</td></tr><tr><td style="text-align:left;">-p</td><td style="text-align:left;">显示指定变量的被声明的类型</td></tr></tbody></table><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">//声明成整型</span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line">1+2</span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line">3</span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line">1+2</span>
<span class="line"> </span>
<span class="line">declare -i c=&quot;3&quot;</span>
<span class="line"></span>
<span class="line">//声明环境变量</span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"></span>
<span class="line">//只读</span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-1-2-数组" tabindex="-1"><a class="header-anchor" href="#_3-1-2-数组"><span>3.1.2 数组</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">names[0]=zhangsan</span>
<span class="line">names[1]=lisi</span>
<span class="line"> </span>
<span class="line">declare -a names;</span>
<span class="line"> </span>
<span class="line">echo \${names}</span>
<span class="line">zhangsan</span>
<span class="line">打印第2个元素</span>
<span class="line"> </span>
<span class="line">lisi</span>
<span class="line"> </span>
<span class="line">echo \${names[*]}</span>
<span class="line">zhangsan lisi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-1-3-声明环境变量" tabindex="-1"><a class="header-anchor" href="#_3-1-3-声明环境变量"><span>3.1.3 声明环境变量</span></a></h4><ul><li>export最终执行的是<code>declare -x</code>命令</li><li><code>declare -p</code> 可以查看所有的类型</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token constant">NAME</span><span class="token operator">=</span>zhufeng</span>
<span class="line">declare <span class="token operator">-</span>x <span class="token constant">NAME</span><span class="token operator">=</span>zhufeng</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-1-4-只读属性" tabindex="-1"><a class="header-anchor" href="#_3-1-4-只读属性"><span>3.1.4 只读属性</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line"> </span>
<span class="line">-bash: gender: readonly variable</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-1-5-查询变量属性" tabindex="-1"><a class="header-anchor" href="#_3-1-5-查询变量属性"><span>3.1.5 查询变量属性</span></a></h4><ul><li>declare -p 查询所有变量的属性</li><li>declare -p 变量名 查询指定变量的属性</li></ul><h3 id="_3-2-数值运算的方法" tabindex="-1"><a class="header-anchor" href="#_3-2-数值运算的方法"><span>3.2 数值运算的方法</span></a></h3><ul><li>只要用declare声明变量的时候指定类型就可以进行数值运算</li></ul><h4 id="_3-2-1-expr或let" tabindex="-1"><a class="header-anchor" href="#_3-2-1-expr或let"><span>3.2.1 expr或let</span></a></h4><ul><li><ul><li>号左右两侧必须有空格,否则还是整块输出</li></ul></li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line">5</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line"> </span>
<span class="line">5</span>
<span class="line"> </span>
<span class="line"> </span>
<span class="line">5</span>
<span class="line"></span>
<span class="line">d=$(date)</span>
<span class="line">echo $d</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-2-优先级" tabindex="-1"><a class="header-anchor" href="#_3-2-2-优先级"><span>3.2.2 优先级</span></a></h4><p><img src="http://img.zhufengpeixun.cn/priority.png" alt="priority"></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">result<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token number">6</span></span>
<span class="line">\`</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-环境变量配置文件" tabindex="-1"><a class="header-anchor" href="#_4-环境变量配置文件"><span>4. 环境变量配置文件</span></a></h2><h3 id="_4-1-source-命令" tabindex="-1"><a class="header-anchor" href="#_4-1-source-命令"><span>4.1 source 命令</span></a></h3><ul><li>修改完配置文件后，必须注销重新登录才能生效，使用source命令可以不用重新登录</li><li>source 配置文件</li><li><code>. 配置文件</code></li></ul><h3 id="_4-2-环境变量配置文件简介" tabindex="-1"><a class="header-anchor" href="#_4-2-环境变量配置文件简介"><span>4.2 环境变量配置文件简介</span></a></h3><ul><li>PATH、HISTSIZE、PS1、HOSTNAME等环境变量写入对应的环境变量配置文件</li><li>环境变量配置文件中主要是定义地系统操作环境生效的系统默认环境变量，如PATH等 此下文件登录时起作用的环境变量</li></ul><table><thead><tr><th style="text-align:left;">路径</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">/etc/profile</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">/etc/profile.d/*.sh</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">/etc/bashrc</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">~/.bash_profile</td><td style="text-align:left;">只会对当前用户生效</td></tr><tr><td style="text-align:left;">~/.bashrc</td><td style="text-align:left;">只会对当前用户生效</td></tr></tbody></table><p><img src="http://img.zhufengpeixun.cn/loadenv.jpg" alt="loadenv"></p><h3 id="_4-3-环境变量配置文件的功能" tabindex="-1"><a class="header-anchor" href="#_4-3-环境变量配置文件的功能"><span>4.3 环境变量配置文件的功能</span></a></h3><h4 id="_4-3-1-etc-profile" tabindex="-1"><a class="header-anchor" href="#_4-3-1-etc-profile"><span>4.3.1 /etc/profile</span></a></h4><ul><li>在这里修改系统变量</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">cat  /etc/profile | grep USER</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><table><thead><tr><th style="text-align:left;">变量名</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">USER</td><td style="text-align:left;">用户名</td></tr><tr><td style="text-align:left;">LOGNAME</td><td style="text-align:left;">登录名</td></tr><tr><td style="text-align:left;">MAIL</td><td style="text-align:left;">邮箱地址</td></tr><tr><td style="text-align:left;">PATH</td><td style="text-align:left;">查找路径</td></tr><tr><td style="text-align:left;">HOSTNAE</td><td style="text-align:left;">主机名</td></tr><tr><td style="text-align:left;">umask</td><td style="text-align:left;">权限掩码</td></tr><tr><td style="text-align:left;">/etc/profile.d/星.sh</td><td style="text-align:left;"></td></tr></tbody></table><h4 id="_4-3-2-bash-profile" tabindex="-1"><a class="header-anchor" href="#_4-3-2-bash-profile"><span>4.3.2 ~/.bash_profile</span></a></h4><ul><li>PATH 在这里修改PATH路径</li><li>调用 ~/.bashrc</li></ul><h4 id="_4-3-3-bashrc" tabindex="-1"><a class="header-anchor" href="#_4-3-3-bashrc"><span>4.3.3 ~/.bashrc</span></a></h4><ul><li>配置alias 改别名在这里</li><li>调用 /etc/bashrc</li></ul><h4 id="_4-3-4-etc-bashrc" tabindex="-1"><a class="header-anchor" href="#_4-3-4-etc-bashrc"><span>4.3.4 /etc/bashrc</span></a></h4><ul><li>PS1 登录提示符在这里修改</li><li>umask</li><li>PATH变量</li><li>调用 /etc/profile.d/星.sh文件</li></ul><h4 id="_4-3-5-其它配置文件" tabindex="-1"><a class="header-anchor" href="#_4-3-5-其它配置文件"><span>4.3.5. 其它配置文件</span></a></h4><h5 id="_4-3-5-1-注销时生效的环境变量配置文件" tabindex="-1"><a class="header-anchor" href="#_4-3-5-1-注销时生效的环境变量配置文件"><span>4.3.5.1 注销时生效的环境变量配置文件</span></a></h5><p>~/.bash_logout</p><h5 id="_4-3-5-2-脚本历史" tabindex="-1"><a class="header-anchor" href="#_4-3-5-2-脚本历史"><span>4.3.5.2 脚本历史</span></a></h5><ul><li>当正确退出计算机的时候会历史记录会写入文件 ~/.bash_history</li></ul><h5 id="_4-3-5-3-shell登录信息" tabindex="-1"><a class="header-anchor" href="#_4-3-5-3-shell登录信息"><span>4.3.5.3 Shell登录信息</span></a></h5><p>本地终端欢迎信息 /etc/issue 远程终端欢迎信息 /etc/issue.net 不管远程还是本地都可以生效 /etc/motd</p><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">\\d</td><td style="text-align:left;">当前系统日期</td></tr><tr><td style="text-align:left;">\\s</td><td style="text-align:left;">显示操作系统名称</td></tr><tr><td style="text-align:left;">\\l</td><td style="text-align:left;">显示登录的终端号</td></tr><tr><td style="text-align:left;">\\m</td><td style="text-align:left;">显示硬件体系结构，如i386等</td></tr><tr><td style="text-align:left;">\\n</td><td style="text-align:left;">显示主机名</td></tr><tr><td style="text-align:left;">\\o</td><td style="text-align:left;">显示域名</td></tr><tr><td style="text-align:left;">\\r</td><td style="text-align:left;">显示内核版本</td></tr><tr><td style="text-align:left;">\\t</td><td style="text-align:left;">显示当前系统时间</td></tr><tr><td style="text-align:left;">\\u</td><td style="text-align:left;">显示当前登录用户的序列号</td></tr></tbody></table><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">vi /etc/ssh/sshd_config</span>
<span class="line">Banner /etc/issue.net</span>
<span class="line">service sshd restart</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-正则表达式" tabindex="-1"><a class="header-anchor" href="#_4-正则表达式"><span>4.正则表达式</span></a></h2><ul><li><a href="https://regexper.com" target="_blank" rel="noopener noreferrer">regexper</a></li></ul><h3 id="_4-1-概念" tabindex="-1"><a class="header-anchor" href="#_4-1-概念"><span>4.1 概念</span></a></h3><ul><li>正则表达式是用于描述字符排列和匹配模式的一种语法规则</li><li>它主要用于字符串的模式分割、匹配查找及替换操作</li></ul><h3 id="_4-2-通配符" tabindex="-1"><a class="header-anchor" href="#_4-2-通配符"><span>4.2 通配符</span></a></h3><ul><li>通配符用来匹配符合条件的文件名，通配符是完全匹配。</li><li>ls find 这些命令不支持正则，只能使用通配符</li></ul><table><thead><tr><th style="text-align:left;">符号</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">?</td><td style="text-align:left;">匹配任意一个字符</td></tr><tr><td style="text-align:left;">*</td><td style="text-align:left;">匹配任意多个字符</td></tr><tr><td style="text-align:left;">[]</td><td style="text-align:left;">匹配中括号中范围内的一个字符</td></tr></tbody></table><h3 id="_4-3-正则表达式" tabindex="-1"><a class="header-anchor" href="#_4-3-正则表达式"><span>4.3 正则表达式</span></a></h3><ul><li>正则表达式是用来在文件中匹配符合条件的字符串，是包含匹配。</li><li>grep awk sed 等都可以支持正则表达式</li></ul><h3 id="_4-4-元字符" tabindex="-1"><a class="header-anchor" href="#_4-4-元字符"><span>4.4 元字符</span></a></h3><p><code>alias grep=&#39;grep --color=auto&#39;</code></p><table><thead><tr><th style="text-align:left;">元字符</th><th style="text-align:left;">作用</th><th style="text-align:left;">示例</th></tr></thead><tbody><tr><td style="text-align:left;">*</td><td style="text-align:left;">前一个字符匹配 0 次或任意多次</td><td style="text-align:left;">grep 1* reg.txt</td></tr><tr><td style="text-align:left;">.</td><td style="text-align:left;">匹配除换行符外的任意一个字符</td><td style="text-align:left;">grep . reg.txt</td></tr><tr><td style="text-align:left;">^</td><td style="text-align:left;">匹配行首。例如，^hello 会匹配以 hello 开头的行</td><td style="text-align:left;">grep ^a reg.txt</td></tr><tr><td style="text-align:left;">$</td><td style="text-align:left;">匹配行尾。例如，hello&amp; 会匹配以 hello 结尾的行</td><td style="text-align:left;">grep a$ reg.txt</td></tr><tr><td style="text-align:left;">[]</td><td style="text-align:left;">匹配屮柄号屮指定的任意一个字符，而且只匹配一个字符。例如.[aoeiu]匹配任意一个元音字母， [0-9] 匹配任意一位数字，[a-z][0-9] 匹配由小写字母和一位数字构成的两位字符</td><td style="text-align:left;">grep ab[bc]c reg.txt</td></tr><tr><td style="text-align:left;">[^]</td><td style="text-align:left;">匹配除中括号中的字符以外的任意一个字符。例如，[^0-9] 匹配任意一位非数字字符，[^a-z] 匹配任意一位非小写字母</td><td style="text-align:left;">grep a[^fg]c reg.txt</td></tr><tr><td style="text-align:left;">|转义符，用于取消特殊符号的含义</td><td style="text-align:left;">grep \\.$ reg.txt</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">{n}</td><td style="text-align:left;">表示其前面的字符恰好出现 n 次。例如，[0-9]{4} 匹配4位数字，[1][3-8][0-9]{9} 匹配手机号码</td><td style="text-align:left;">grep &quot;a{1}&quot; reg.txt</td></tr><tr><td style="text-align:left;">(n,}</td><td style="text-align:left;">表示其前面的字符出现不少于 n 次。例如，[0-9]{2,} 匹配两位及以上的数字</td><td style="text-align:left;">grep &quot;a{1,}&quot; reg.txt</td></tr><tr><td style="text-align:left;">{n,m}</td><td style="text-align:left;">表示其前面的字符至少出现 n 次，最多出现 m 次。例如，[a-z]{6,8} 匹配 6〜8 位的小写字母</td><td style="text-align:left;">grep &quot;a{2,3}&quot; reg.txt</td></tr></tbody></table><h3 id="_4-5-cut" tabindex="-1"><a class="header-anchor" href="#_4-5-cut"><span>4.5 cut</span></a></h3><ul><li>cut用来提取文本中的某一部分文本</li><li>cut [选项] 文件名 <ul><li>-f 列号，用来指定要提取的列</li><li>-d 分隔符，按照指定分隔符分割列,默认分隔符是TAB制表符</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">cat <span class="token operator">/</span>etc<span class="token operator">/</span>passwd <span class="token operator">|</span> grep <span class="token operator">/</span>bin<span class="token operator">/</span>bash <span class="token operator">|</span> cut <span class="token operator">-</span>f <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span> <span class="token operator">-</span>d <span class="token operator">:</span></span>
<span class="line"></span>
<span class="line">df <span class="token operator">-</span>h <span class="token operator">|</span> grep <span class="token operator">/</span>dev<span class="token operator">/</span>sda5 <span class="token operator">|</span> cut <span class="token operator">-</span>f <span class="token number">5</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-6-printf" tabindex="-1"><a class="header-anchor" href="#_4-6-printf"><span>4.6 printf</span></a></h3><ul><li>按规定格式输出</li><li>printf 输出类型 输出内容</li></ul><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">%ns</td><td style="text-align:left;">输出字符串,n是数字指代输出几个字符</td></tr><tr><td style="text-align:left;">%ni</td><td style="text-align:left;">输出整数,n是指输出几个数字</td></tr><tr><td style="text-align:left;">%m.nf</td><td style="text-align:left;">输出浮点数,m和n是数字，指代输出的整数位数和小数位数，如%6.2f代表输出6位位，2位小数，4位整数</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">printf <span class="token string">&quot;%s\\t%s\\t%s\\t%s\\t%s\\t\\%s\\n&quot;</span> <span class="token function">$</span><span class="token punctuation">(</span>df <span class="token operator">-</span>h <span class="token operator">|</span> grep <span class="token operator">/</span>dev<span class="token operator">/</span>sda5<span class="token punctuation">)</span> <span class="token operator">|</span> cut <span class="token operator">-</span>f <span class="token number">5</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_4-7-awk" tabindex="-1"><a class="header-anchor" href="#_4-7-awk"><span>4.7 awk</span></a></h3><ul><li><p>awk &#39;条件1{动作1} 条件2{动作2}...&#39; 文件名</p></li><li><p>条件(Pattern)</p><ul><li>一般使用关系表达式作为条件</li><li>x &gt; 10 判断变量x是否大于10</li><li>x &gt;=10 大于等于</li><li>x &lt;=10 小于等于</li></ul></li><li><p>动作(Action)</p><ul><li>格式化输出</li></ul></li><li><p>$0 整行 $1 第一列...</p></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> df <span class="token operator">-</span>h <span class="token operator">|</span> grep <span class="token operator">/</span>dev<span class="token operator">/</span>sda5 <span class="token operator">|</span>awk <span class="token string">&#39;{print $5}&#39;</span><span class="token operator">|</span> cut <span class="token operator">-</span>d <span class="token string">&#39;%&#39;</span> <span class="token operator">-</span>f <span class="token number">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_4-7-1-begin-end" tabindex="-1"><a class="header-anchor" href="#_4-7-1-begin-end"><span>4.7.1 begin end</span></a></h4><ul><li>awk可以正确截取制表符和空格</li><li>begin 在所有的输出之前打印</li><li>end 在所有的输出之后打印<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">awk <span class="token string">&#39;BEGIN{print &quot;开始&quot;}END{print &quot;结束&quot;}&#39;</span> numbers<span class="token punctuation">.</span>txt </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="_4-7-2-fs" tabindex="-1"><a class="header-anchor" href="#_4-7-2-fs"><span>4.7.2 FS</span></a></h4><ul><li>Field Separator，字段分隔符</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">awk <span class="token string">&#39;BEGIN{FS=&quot;:&quot;}{print $1&quot;\\t&quot;$2}&#39;</span> <span class="token operator">/</span>etc<span class="token operator">/</span>passwd</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_4-7-3-声明变量" tabindex="-1"><a class="header-anchor" href="#_4-7-3-声明变量"><span>4.7.3 声明变量</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">awk <span class="token string">&#39;BEGIN{sum=0}{sum=sum+$1}END{print sum}&#39;</span> numbers<span class="token punctuation">.</span>txt </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_4-7-4-多条件" tabindex="-1"><a class="header-anchor" href="#_4-7-4-多条件"><span>4.7.4 多条件</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">awk <span class="token string">&#39;$2&gt;90{print $1&quot;\\t优秀&quot;}$2&gt;80{print $2&quot;\\t良好&quot;}&#39;</span> score<span class="token punctuation">.</span>txt</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_4-7-5-nr" tabindex="-1"><a class="header-anchor" href="#_4-7-5-nr"><span>4.7.5 NR</span></a></h4><ul><li>NR,表示awk开始执行程序后所读取的数据行数</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">awk <span class="token string">&#39;{print NR,$0}&#39;</span> file1 </span>
<span class="line">awk <span class="token string">&#39;NR=3{print $0}&#39;</span> file1 </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-7-6-ofs" tabindex="-1"><a class="header-anchor" href="#_4-7-6-ofs"><span>4.7.6 OFS</span></a></h4><ul><li>OFS Out of Field Separator，输出字段分隔符</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">echo <span class="token string">&quot;i love you&quot;</span> <span class="token operator">|</span> awk <span class="token string">&#39;BEGIN{ FS=&quot; &quot;;OFS=&quot;-&quot; }{ print $1,$2,$3}&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_4-8-sed命令" tabindex="-1"><a class="header-anchor" href="#_4-8-sed命令"><span>4.8 sed命令</span></a></h3><ul><li>sed是一个轻量级编辑器，主要用来对数据进行选取、替换、替换和新增操作</li><li>sed [选项] &#39;[动作]&#39; 文件名</li><li>所有的动作都必须用单号号括起来</li><li>类型类似于批量vi操作</li></ul><p>选项</p><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th><th style="text-align:left;">示例</th></tr></thead><tbody><tr><td style="text-align:left;">-n</td><td style="text-align:left;">一般sed命令会把所有的数据都输出到屏幕上，如果加入此选项则只会把处理过的行输出到屏幕上</td><td style="text-align:left;"><code>sed -n &#39;2p&#39; score.txt</code></td></tr><tr><td style="text-align:left;">-e</td><td style="text-align:left;">允许对输入数据应用多条sed编辑命令</td><td style="text-align:left;">sed -e &#39;s/75/70/g;s/55/50/g&#39; score.txt</td></tr><tr><td style="text-align:left;">-i</td><td style="text-align:left;">用sed的修改直接修改编辑的文件，而不是在屏幕上输出</td><td style="text-align:left;"><code>sed -i &#39;1i newline&#39; score.txt</code></td></tr></tbody></table><p>动作</p><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th><th style="text-align:left;">示例</th></tr></thead><tbody><tr><td style="text-align:left;">a</td><td style="text-align:left;">追加，在每一行或者指定行下面添加一行或多行</td><td style="text-align:left;"><code>sed &#39;1a newline&#39; score.txt</code></td></tr><tr><td style="text-align:left;">c</td><td style="text-align:left;">行替换，用c后面的字符串替换掉原始整个数据行</td><td style="text-align:left;"><code>sed &#39;c newline&#39; score.txt</code></td></tr><tr><td style="text-align:left;">s</td><td style="text-align:left;">字符串替换,用一个字符串替换另外一个字符串，格式为 &quot;行范围s/旧字符串/新字符串/g&quot;</td><td style="text-align:left;"><code>sed &#39;3s/lisi/lisisi/g&#39; score.txt</code></td></tr><tr><td style="text-align:left;">i</td><td style="text-align:left;">插入，在当前行插入一行或多行</td><td style="text-align:left;"><code>sed &#39;1i newline&#39; score.txt</code></td></tr><tr><td style="text-align:left;">d</td><td style="text-align:left;">删除指定的行</td><td style="text-align:left;"><code>sed &#39;1,2d&#39; score.txt</code></td></tr><tr><td style="text-align:left;">p</td><td style="text-align:left;">打印,输出指定的行</td><td style="text-align:left;"><code>sed -n &#39;2p&#39; score.txt</code></td></tr></tbody></table><h3 id="_4-9-排序命令sort" tabindex="-1"><a class="header-anchor" href="#_4-9-排序命令sort"><span>4.9 排序命令sort</span></a></h3><ul><li>sort [选项] 文件名</li><li>选项</li></ul><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-f</td><td style="text-align:left;">忽略大小写</td></tr><tr><td style="text-align:left;">-n</td><td style="text-align:left;">以数值型进行排序，默认使用字符串顺序</td></tr><tr><td style="text-align:left;">-r</td><td style="text-align:left;">反向排序，默认从小到大</td></tr><tr><td style="text-align:left;">-t</td><td style="text-align:left;">指定分割符，默认分割符是制表符</td></tr><tr><td style="text-align:left;">-k n[,m]</td><td style="text-align:left;">按照指定的字段范围排序。从第n个字段开始，到第m个字段结束，默认是到行尾</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">sort <span class="token operator">/</span>etc<span class="token operator">/</span>passwd</span>
<span class="line">sort <span class="token operator">-</span>r <span class="token operator">/</span>etc<span class="token operator">/</span>passwd</span>
<span class="line">sort <span class="token operator">-</span>t <span class="token string">&quot;:&quot;</span> <span class="token operator">-</span>k <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token operator">/</span>etc<span class="token operator">/</span>passwd</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-10-wc" tabindex="-1"><a class="header-anchor" href="#_4-10-wc"><span>4.10 wc</span></a></h3><ul><li>wc [选项] 文件名</li></ul><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-l</td><td style="text-align:left;">只统计行数</td></tr><tr><td style="text-align:left;">-w</td><td style="text-align:left;">只允许单词数</td></tr><tr><td style="text-align:left;">-m</td><td style="text-align:left;">只统计字符数</td></tr></tbody></table><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">wc wc.txt </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_5-流程控制" tabindex="-1"><a class="header-anchor" href="#_5-流程控制"><span>5. 流程控制</span></a></h2><h3 id="_5-1-条件判断" tabindex="-1"><a class="header-anchor" href="#_5-1-条件判断"><span>5.1 条件判断</span></a></h3><h4 id="_5-1-1-按照文件类型进行判断" tabindex="-1"><a class="header-anchor" href="#_5-1-1-按照文件类型进行判断"><span>5.1.1 按照文件类型进行判断</span></a></h4><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-d</td><td style="text-align:left;">文件是否存在并且是目录</td></tr><tr><td style="text-align:left;">-e</td><td style="text-align:left;">文件是否存在</td></tr><tr><td style="text-align:left;">-f</td><td style="text-align:left;">文件是否存在并且是普通文件</td></tr><tr><td style="text-align:left;">-b</td><td style="text-align:left;">文件是否存在并且是块设备文件</td></tr><tr><td style="text-align:left;">-c</td><td style="text-align:left;">文件是否存在并且是字符设备文件</td></tr><tr><td style="text-align:left;">-L</td><td style="text-align:left;">文件是否存在并且是链接文件</td></tr><tr><td style="text-align:left;">-p</td><td style="text-align:left;">文件是否存在并且是管道文件</td></tr><tr><td style="text-align:left;">-s</td><td style="text-align:left;">文件是否存在并且是否为非空</td></tr><tr><td style="text-align:left;">-S</td><td style="text-align:left;">文件是否存在并且是套接字文件</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">test <span class="token operator">-</span>e <span class="token number">1</span><span class="token punctuation">.</span>txt</span>
<span class="line"><span class="token punctuation">[</span><span class="token operator">-</span>e <span class="token number">1</span><span class="token punctuation">.</span>txt<span class="token punctuation">]</span></span>
<span class="line">echo $<span class="token operator">?</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">yes</span>
<span class="line"> </span>
<span class="line">no</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-1-2-按照文件权限进行判断" tabindex="-1"><a class="header-anchor" href="#_5-1-2-按照文件权限进行判断"><span>5.1.2 按照文件权限进行判断</span></a></h4><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-r</td><td style="text-align:left;">文件是否存在，并且是否拥有读权限</td></tr><tr><td style="text-align:left;">-w</td><td style="text-align:left;">文件是否存在，并且是否拥有写权限</td></tr><tr><td style="text-align:left;">-x</td><td style="text-align:left;">文件是否存在，并且是否拥有执行权限</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">echo read  <span class="token operator">&gt;</span> read<span class="token punctuation">.</span>txt</span>
<span class="line">echo write  <span class="token operator">&gt;</span> write<span class="token punctuation">.</span>txt</span>
<span class="line">echo execute  <span class="token operator">&gt;</span> execute<span class="token punctuation">.</span>txt</span>
<span class="line"></span>
<span class="line">chmod u<span class="token operator">+</span>w write<span class="token punctuation">.</span>txt </span>
<span class="line">chmod u<span class="token operator">+</span>x execute<span class="token punctuation">.</span>txt</span>
<span class="line"></span>
<span class="line"><span class="token punctuation">[</span> <span class="token operator">-</span>e read<span class="token punctuation">.</span>txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;read yes&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> <span class="token operator">-</span>e write<span class="token punctuation">.</span>txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;write yes&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> <span class="token operator">-</span>e execute<span class="token punctuation">.</span>txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;execute yes&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-1-3-两个文件间的比较" tabindex="-1"><a class="header-anchor" href="#_5-1-3-两个文件间的比较"><span>5.1.3 两个文件间的比较</span></a></h4><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">文件1 -nt 文件2</td><td style="text-align:left;">判断文件1的修改时间是否比文件2的新</td></tr><tr><td style="text-align:left;">文件1 -ot 文件2</td><td style="text-align:left;">判断文件1的修改时间是否比文件2的旧</td></tr><tr><td style="text-align:left;">文件1 -ef 文件2</td><td style="text-align:left;">判断文件1和文件2的inode号是否一致,可用于判断硬链接</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">[</span> write<span class="token punctuation">.</span>txt <span class="token operator">-</span>nt read<span class="token punctuation">.</span>txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;write is older than read&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> read<span class="token punctuation">.</span>txt <span class="token operator">-</span>ot write<span class="token punctuation">.</span>txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;read is older than write&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line">ln execute<span class="token punctuation">.</span>txt execute2<span class="token punctuation">.</span>txt</span>
<span class="line"><span class="token punctuation">[</span> execute<span class="token punctuation">.</span>txt <span class="token operator">-</span>ef execute2<span class="token punctuation">.</span>txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;execute and execute2.txt are the same&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-1-4-两个整数间的比较" tabindex="-1"><a class="header-anchor" href="#_5-1-4-两个整数间的比较"><span>5.1.4 两个整数间的比较</span></a></h4><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">整数1 -eq 整数2</td><td style="text-align:left;">判断整数1是否和整数2相等</td></tr><tr><td style="text-align:left;">整数1 -ne 整数2</td><td style="text-align:left;">判断整数1是否和整数2不相等</td></tr><tr><td style="text-align:left;">整数1 -gt 整数2</td><td style="text-align:left;">判断整数1是否大于整数2</td></tr><tr><td style="text-align:left;">整数1 -lt 整数2</td><td style="text-align:left;">判断整数1是否小于整数2</td></tr><tr><td style="text-align:left;">整数1 -ge 整数2</td><td style="text-align:left;">判断整数1是否大于等于整数2</td></tr><tr><td style="text-align:left;">整数1 -le 整数2</td><td style="text-align:left;">判断整数1是否小于等于整数2</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">[</span> <span class="token number">2</span> <span class="token operator">-</span>eq <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;2==2&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> <span class="token number">3</span> <span class="token operator">-</span>ne <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;2!=2&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> <span class="token number">3</span> <span class="token operator">-</span>gt <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;2&gt;2&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> <span class="token number">1</span> <span class="token operator">-</span>lt <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;2&lt;2&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> <span class="token number">2</span> <span class="token operator">-</span>ge <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;2&gt;=2&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> <span class="token number">2</span> <span class="token operator">-</span>le <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;2&lt;=2&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-1-5-字符串的判断" tabindex="-1"><a class="header-anchor" href="#_5-1-5-字符串的判断"><span>5.1.5 字符串的判断</span></a></h4><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-z 字符串</td><td style="text-align:left;">判断字否串是否为空</td></tr><tr><td style="text-align:left;">-n 字符中</td><td style="text-align:left;">判断字符串是否为非空</td></tr><tr><td style="text-align:left;">字符串1 == 字符串2</td><td style="text-align:left;">判断字符串1是否和字符串2相等</td></tr><tr><td style="text-align:left;">字符串1 != 字符串2</td><td style="text-align:left;">判断字符串1是否和字符串2不相等</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"></span>
<span class="line">name<span class="token operator">=</span>zhufeng</span>
<span class="line"><span class="token punctuation">[</span> <span class="token operator">-</span>z <span class="token string">&quot;$name&quot;</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line">name2<span class="token operator">=</span>zhufeng</span>
<span class="line"><span class="token punctuation">[</span> <span class="token string">&quot;$name&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;$name2&quot;</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-1-6-多重条件判断" tabindex="-1"><a class="header-anchor" href="#_5-1-6-多重条件判断"><span>5.1.6 多重条件判断</span></a></h4><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">判断1 -a 判断2</td><td style="text-align:left;">逻辑与</td></tr><tr><td style="text-align:left;">判断1 -o 判断2</td><td style="text-align:left;">逻辑或</td></tr><tr><td style="text-align:left;">!判断</td><td style="text-align:left;">逻辑非</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">[</span> <span class="token number">2</span> <span class="token operator">-</span>gt <span class="token number">1</span> <span class="token operator">-</span>a <span class="token number">3</span> <span class="token operator">-</span>gt <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> <span class="token number">2</span> <span class="token operator">-</span>gt <span class="token number">1</span> <span class="token operator">-</span>a <span class="token number">3</span> <span class="token operator">-</span>gt <span class="token number">4</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> <span class="token number">2</span> <span class="token operator">-</span>gt <span class="token number">1</span> <span class="token operator">-</span>o <span class="token number">3</span> <span class="token operator">-</span>gt <span class="token number">4</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"><span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token number">3</span> <span class="token operator">-</span>gt <span class="token number">4</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span>echo <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> echo <span class="token string">&quot;no&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2-单分支if语句" tabindex="-1"><a class="header-anchor" href="#_5-2-单分支if语句"><span>5.2 单分支if语句</span></a></h3><ul><li>if语句使用<code>fi</code>结尾</li><li>[条件判断式]就是使用<code>test</code>命令进行判断，所以中括号和条件判断式之间必须有空格</li><li>then后面跟符合条件之后执行的程序，可以放在[]之后，用;分隔，也可以换行，不用;</li></ul><h4 id="_5-2-1-语法" tabindex="-1"><a class="header-anchor" href="#_5-2-1-语法"><span>5.2.1 语法</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span>条件判断<span class="token punctuation">]</span><span class="token punctuation">;</span>then</span>
<span class="line"> 代码体</span>
<span class="line">fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span>条件判断<span class="token punctuation">]</span></span>
<span class="line">then</span>
<span class="line"> 代码体</span>
<span class="line">fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token number">2</span> <span class="token operator">-</span>gt <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>then echo bigger<span class="token punctuation">;</span> fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_5-2-2-判断当前用户是否是root用户" tabindex="-1"><a class="header-anchor" href="#_5-2-2-判断当前用户是否是root用户"><span>5.2.2 判断当前用户是否是root用户</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">user<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>whoami<span class="token punctuation">)</span></span>
<span class="line">user<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">whoami</span><span class="token template-punctuation string">\`</span></span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;$user&quot;</span> <span class="token operator">==</span> root <span class="token punctuation">]</span></span>
<span class="line">then</span>
<span class="line">echo <span class="token string">&quot;I am root&quot;</span></span>
<span class="line">fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-双分支if语句" tabindex="-1"><a class="header-anchor" href="#_5-3-双分支if语句"><span>5.3 双分支if语句</span></a></h3><h4 id="_5-3-1-语法" tabindex="-1"><a class="header-anchor" href="#_5-3-1-语法"><span>5.3.1 语法</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span>条件判断<span class="token punctuation">]</span></span>
<span class="line">then</span>
<span class="line"> 代码体<span class="token number">1</span></span>
<span class="line"><span class="token keyword">else</span></span>
<span class="line"> 代码体<span class="token number">2</span> </span>
<span class="line">fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-3-2-判断是否目录" tabindex="-1"><a class="header-anchor" href="#_5-3-2-判断是否目录"><span>5.3.2 判断是否目录</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">read <span class="token operator">-</span>t <span class="token number">10</span> <span class="token operator">-</span>p <span class="token string">&quot;please input a filename&quot;</span> dir</span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">-</span>d <span class="token string">&quot;$dir&quot;</span> <span class="token punctuation">]</span></span>
<span class="line">then</span>
<span class="line">  echo <span class="token string">&quot;is directory&quot;</span></span>
<span class="line"><span class="token keyword">else</span> </span>
<span class="line">  echo <span class="token string">&quot;not a direcotry&quot;</span></span>
<span class="line">fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-4-多分支if语句" tabindex="-1"><a class="header-anchor" href="#_5-4-多分支if语句"><span>5.4 多分支if语句</span></a></h3><h4 id="_5-4-1-语法" tabindex="-1"><a class="header-anchor" href="#_5-4-1-语法"><span>5.4.1 语法</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span>条件判断<span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">then</span>
<span class="line"> 代码体<span class="token number">1</span></span>
<span class="line">elif <span class="token punctuation">[</span>条件判断<span class="token number">2</span><span class="token punctuation">]</span> </span>
<span class="line"> 代码体<span class="token number">2</span></span>
<span class="line"><span class="token keyword">else</span></span>
<span class="line"> 代码体<span class="token number">3</span></span>
<span class="line">fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">read <span class="token operator">-</span>p <span class="token string">&quot;please input a grade&quot;</span> grade</span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;$grade&quot;</span> <span class="token operator">-</span>gt <span class="token number">90</span> <span class="token punctuation">]</span></span>
<span class="line"> then</span>
<span class="line">  echo great</span>
<span class="line">elif <span class="token punctuation">[</span> <span class="token string">&quot;$grade&quot;</span> <span class="token operator">-</span>gt <span class="token number">80</span> <span class="token punctuation">]</span></span>
<span class="line">  then</span>
<span class="line">   echo good</span>
<span class="line"><span class="token keyword">else</span></span>
<span class="line">   echo bad</span>
<span class="line">fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-5-case-语句" tabindex="-1"><a class="header-anchor" href="#_5-5-case-语句"><span>5.5 case 语句</span></a></h3><ul><li>case 和if 都是多分支判断语句,if能判断多个条件,case只能判断一个条件</li></ul><h4 id="_5-5-1-语法" tabindex="-1"><a class="header-anchor" href="#_5-5-1-语法"><span>5.5.1 语法</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">case</span> 变量名 <span class="token keyword">in</span> </span>
<span class="line">值<span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="line">  代码块<span class="token number">1</span></span>
<span class="line">  <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line">值<span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">  代码块<span class="token number">2</span></span>
<span class="line"> <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token operator">*</span><span class="token punctuation">)</span></span>
<span class="line">  代码块<span class="token number">3</span></span>
<span class="line"> <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line">esac</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">read <span class="token operator">-</span>p <span class="token string">&quot;yes or no?&quot;</span> <span class="token operator">-</span>t <span class="token number">30</span> choose</span>
<span class="line"><span class="token keyword">case</span> $choose <span class="token keyword">in</span> </span>
<span class="line">  <span class="token string">&quot;yes&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    echo <span class="token string">&#39;yes&#39;</span></span>
<span class="line">    <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    echo <span class="token string">&quot;no&quot;</span></span>
<span class="line">   <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token operator">*</span><span class="token punctuation">)</span></span>
<span class="line">    echo other</span>
<span class="line">   <span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line">esac</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-6-for循环" tabindex="-1"><a class="header-anchor" href="#_5-6-for循环"><span>5.6 for循环</span></a></h3><h3 id="_5-6-1-语法" tabindex="-1"><a class="header-anchor" href="#_5-6-1-语法"><span>5.6.1 语法</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">for</span> 变量 <span class="token keyword">in</span> 值<span class="token number">1</span> 值<span class="token number">2</span> 值<span class="token number">3</span></span>
<span class="line"><span class="token keyword">do</span></span>
<span class="line">代码块</span>
<span class="line">done</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span></span>
<span class="line"><span class="token keyword">do</span></span>
<span class="line"> echo $i</span>
<span class="line">done</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-6-2-语法" tabindex="-1"><a class="header-anchor" href="#_5-6-2-语法"><span>5.6.2 语法</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line"></span>
<span class="line"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </span>
<span class="line"><span class="token keyword">do</span>   </span>
<span class="line"> echo <span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//加不加$都一样</span></span>
<span class="line">done </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-7-while循环" tabindex="-1"><a class="header-anchor" href="#_5-7-while循环"><span>5.7 while循环</span></a></h3><ul><li>while循环是不定循环，也称为条件循环，只要条件判断成立，就会一直继续</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">while</span> <span class="token punctuation">[</span>条件判断式<span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">do</span></span>
<span class="line"> 代码块</span>
<span class="line">done</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">i<span class="token operator">=</span><span class="token number">1</span></span>
<span class="line">result<span class="token operator">=</span><span class="token number">0</span></span>
<span class="line"><span class="token keyword">while</span> <span class="token punctuation">[</span> $i <span class="token operator">-</span>le <span class="token number">100</span> <span class="token punctuation">]</span></span>
<span class="line"> <span class="token keyword">do</span></span>
<span class="line">   result<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$result<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">   i<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"> done</span>
<span class="line">echo $result</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-8-until循环" tabindex="-1"><a class="header-anchor" href="#_5-8-until循环"><span>5.8 until循环</span></a></h3><ul><li>直到条件不成立停止</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">i<span class="token operator">=</span><span class="token number">1</span></span>
<span class="line">result<span class="token operator">=</span><span class="token number">0</span></span>
<span class="line">until <span class="token punctuation">[</span> $i <span class="token operator">-</span>gt <span class="token number">100</span> <span class="token punctuation">]</span></span>
<span class="line"> <span class="token keyword">do</span></span>
<span class="line">   result<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$result<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">   i<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"> done</span>
<span class="line">echo $result</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-函数" tabindex="-1"><a class="header-anchor" href="#_6-函数"><span>6. 函数</span></a></h2><ul><li>linux shell 可以用户定义函数，然后在shell脚本中可以随便调用</li><li>可以带function fun() 定义，也可以直接fun() 定义,不带任何参数</li><li>调用函数不需要加()</li></ul><h3 id="_6-1-简单函数" tabindex="-1"><a class="header-anchor" href="#_6-1-简单函数"><span>6.1 简单函数</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">[ function ] funcname [()]</span>
<span class="line">{</span>
<span class="line">    action;</span>
<span class="line">    [return int;]</span>
<span class="line">}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">start(){</span>
<span class="line">&gt;  echo start</span>
<span class="line">&gt; }</span>
<span class="line"> start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">start(){</span>
<span class="line"> echo start</span>
<span class="line">}</span>
<span class="line">start</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-2-返回值" tabindex="-1"><a class="header-anchor" href="#_6-2-返回值"><span>6.2 返回值</span></a></h3><ul><li>参数返回，可以显示加：return 返回，如果不加，将以最后一条命令运行结果，作为返回值</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">&gt; sum4(){</span>
<span class="line">&gt; r=$(($1+$2))</span>
<span class="line">&gt; return $r</span>
<span class="line">&gt; }</span>
<span class="line"> </span>
<span class="line">echo $?</span>
<span class="line">5</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-3-参数说明" tabindex="-1"><a class="header-anchor" href="#_6-3-参数说明"><span>6.3 参数说明</span></a></h3><table><thead><tr><th style="text-align:left;">参数处理</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">$</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">$*</td><td style="text-align:left;">以一个单字符串显示所有向脚本传递的参数</td></tr><tr><td style="text-align:left;">$@</td><td style="text-align:left;">与$*相同，但是使用时加引号，并在引号中返回每个参数</td></tr><tr><td style="text-align:left;">$$</td><td style="text-align:left;">脚本运行的当前进程ID号</td></tr><tr><td style="text-align:left;">$!</td><td style="text-align:left;">后台运行的最后一个进程的ID号</td></tr><tr><td style="text-align:left;">$-</td><td style="text-align:left;">显示Shell使用的当前选项，与set命令功能相同</td></tr><tr><td style="text-align:left;">$?</td><td style="text-align:left;">显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误</td></tr></tbody></table><h3 id="_6-4-profile" tabindex="-1"><a class="header-anchor" href="#_6-4-profile"><span>6.4 profile</span></a></h3><ul><li><p><a href="http://tldp.org/LDP/abs/html/parameter-substitution.html" target="_blank" rel="noopener noreferrer">parameter-substitution</a></p></li><li><p>[shell帮助文档](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html</p></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">echo $<span class="token operator">-</span></span>
<span class="line"> echo &quot;$<span class="token punctuation">{</span><span class="token operator">-</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-4-1-脚本" tabindex="-1"><a class="header-anchor" href="#_6-4-1-脚本"><span>6.4.1 脚本</span></a></h4><p>cat /etc/profile</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token operator">/</span>etc<span class="token operator">/</span>profile<span class="token punctuation">.</span>d<span class="token comment">/*.sh ; do</span>
<span class="line">  if [ -r &quot;$i&quot; ]; then</span>
<span class="line">       if [ &quot;\${-</span>
<span class="line">          . &quot;$i&quot;</span>
<span class="line">      else</span>
<span class="line">          . &quot;$i&quot; &gt;/dev/null 2&gt;&amp;1</span>
<span class="line">      fi</span>
<span class="line">  fi</span>
<span class="line">done</span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>如果现在执行的命令(或脚本)是交互式（interactively），那么加载之</li><li>如果执行的命令（或脚本）是非交互式（non-interactively），那么加载之，并且将输出重定向到 /dev/null,目的是防止有些执行某些程序（如scp），需要登录到远端机器，读取远端机器的环境变量有输出，导致程序中断！</li></ul><h4 id="_6-4-2-打印当前shell的选项" tabindex="-1"><a class="header-anchor" href="#_6-4-2-打印当前shell的选项"><span>6.4.2 打印当前shell的选项</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">himBH</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>$-</code>记录着当前设置的shell选项，<code>himBH</code>是默认值，你可以通过 set 命令来设置或者取消一个选项配置。例如：</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">set <span class="token operator">-</span>x</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>这个可以打开 shell 的调试开关，调试 shell 脚本非常有用，这个时候再检查下 $- 变量的值，可以看到多了 x 字符：</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> [root@localhost ~]</span>
<span class="line">+ echo himxBH</span>
<span class="line">himxBH</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-4-3-选项" tabindex="-1"><a class="header-anchor" href="#_6-4-3-选项"><span>6.4.3 选项</span></a></h4><ul><li>查看当前 shell 的选项配置<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">set <span class="token operator">-</span>o</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h5 id="_6-4-3-1-i-interactive" tabindex="-1"><a class="header-anchor" href="#_6-4-3-1-i-interactive"><span>6.4.3.1 i - interactive</span></a></h5><ul><li>包含这个选项说明当前的 shell 是一个交互式的 shell，何为交互式？你输入命令，shell 解释执行后给你返回结果，我们在 Terminal 下使用的 shell 就是交互式的 如果我们在一个脚本里面 echo $-，结果是不会包含 i 的</li></ul><h5 id="_6-4-3-2-h-history-expand" tabindex="-1"><a class="header-anchor" href="#_6-4-3-2-h-history-expand"><span>6.4.3.2 H - history expand</span></a></h5><ul><li>history expand 就是展开历史列表中的命令，可以通过!感叹号来完成，例如&quot;!!&quot;返回上最近的一个历史命令，&quot;!n&quot;返回第 n 个历史命令，等等</li></ul><h5 id="_6-4-3-3-b-brace-expansion" tabindex="-1"><a class="header-anchor" href="#_6-4-3-3-b-brace-expansion"><span>6.4.3.3 B - brace expansion</span></a></h5><ul><li>大括号扩展，是可以让bash生成任意字符串的一种扩展功能</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">echo g{a,b,c}$</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="_6-4-3-4-m-monitor-mode" tabindex="-1"><a class="header-anchor" href="#_6-4-3-4-m-monitor-mode"><span>6.4.3.4 m - monitor mode</span></a></h5><ul><li>打开监控模式,可以控制进程的停止、继续，后台或者前台执行</li><li>正常情况下，在交互式模式下，该选项默认是打开的，所以再执行一个比较耗时的命令时，你可以按下<code>CTRL+Z</code> 让它在后台运行，然后可以用 <code>fg</code> 命令将后台运行的任务恢复到前台执行</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> sleep 10s</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="_6-4-3-5-h-hashal" tabindex="-1"><a class="header-anchor" href="#_6-4-3-5-h-hashal"><span>6.4.3.5 h - hashal</span></a></h5><ul><li>Remember the location of commands as they are looked up for execution. This is enabled by default. 记录命令的位置</li></ul><h4 id="_6-4-4-删除" tabindex="-1"><a class="header-anchor" href="#_6-4-4-删除"><span>6.4.4 删除</span></a></h4><p>从左往右看，删除掉 <code>$-</code> 变量的值中第一个 <code>i</code> 字符以及之前的内容</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> \${-</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>%与</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">\${-%i*}</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_7-shell实战" tabindex="-1"><a class="header-anchor" href="#_7-shell实战"><span>7.shell实战</span></a></h2><h3 id="_7-1-注意事项" tabindex="-1"><a class="header-anchor" href="#_7-1-注意事项"><span>7.1 注意事项</span></a></h3><ul><li>开头加解释器:</li><li>命名建议规则: 变量名大写、局部变量小写，函数名小写，名字体现出实际作用</li><li>默认变量是全局的，在函数中变量local指定为局部变量，避免污染其它作用域</li><li><code>set -e</code> 遇到执行非0时退出脚本, <code>set -x</code> 打印执行过程</li><li>写脚本一定要先测试再上生产环境</li></ul><h3 id="_7-2-获取随机字符串或数字" tabindex="-1"><a class="header-anchor" href="#_7-2-获取随机字符串或数字"><span>7.2 获取随机字符串或数字</span></a></h3><ul><li><code>-c, --characters=LIST select only these characters</code></li></ul><h4 id="_7-2-1-获取随机8位字符串" tabindex="-1"><a class="header-anchor" href="#_7-2-1-获取随机8位字符串"><span>7.2.1 获取随机8位字符串</span></a></h4><ul><li>MD5全称是报文摘要算法（Message-Digest Algorithm 5），此算法对任意长度的信息逐位进行计算，产生一个二进制长度为128位(十六进制长度就是32位)的报文摘要,不同的文件产生相同的报文摘要的可能性是非常非常之小的</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">echo $<span class="token constant">RANDOM</span> <span class="token operator">|</span>md5sum<span class="token operator">|</span>cut <span class="token operator">-</span>c <span class="token number">1</span><span class="token operator">-</span><span class="token number">8</span></span>
<span class="line">cat <span class="token operator">/</span>proc<span class="token operator">/</span>sys<span class="token operator">/</span>kernel<span class="token operator">/</span>random<span class="token operator">/</span>uuid <span class="token operator">|</span> cut <span class="token operator">-</span>c <span class="token number">1</span><span class="token operator">-</span><span class="token number">8</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-2-2-获取随机8位数字" tabindex="-1"><a class="header-anchor" href="#_7-2-2-获取随机8位数字"><span>7.2.2 获取随机8位数字</span></a></h4><ul><li>cksum命令是确保文件从一个系统传输到另一个系统地过程中没有被损坏。这个测试要求校验和在源系统中被计算出来,在目的系统中又被计算一次，两个数字比较，如果校验和相等，则该文件被认为是被正确传输了</li><li>%N 十亿分之一秒，纳秒 [000000000，999999999]</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">echo $<span class="token constant">RANDOM</span> <span class="token operator">|</span>cksum<span class="token operator">|</span>cut <span class="token operator">-</span>c <span class="token number">1</span><span class="token operator">-</span><span class="token number">8</span></span>
<span class="line">date <span class="token operator">+</span><span class="token operator">%</span><span class="token constant">N</span> <span class="token operator">|</span> cut <span class="token operator">-</span>c <span class="token number">1</span><span class="token operator">-</span><span class="token number">8</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-3-定义一个颜色输出字符串函数" tabindex="-1"><a class="header-anchor" href="#_7-3-定义一个颜色输出字符串函数"><span>7.3 定义一个颜色输出字符串函数</span></a></h3><ul><li>终端的字符颜色是用转义序列控制的，是文本模式下的系统显示功能</li><li>转义序列是以ESC开头,即用\\033来完成（ESC的ASCII码用十进制表示是27，用八进制表示就是033）</li><li>书写格式: 开头部分：<code>\\033[显示方式;前景色;背景色m + 结尾部分：\\033[0m</code> 显示方式</li></ul><table><thead><tr><th style="text-align:left;">数值</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">0</td><td style="text-align:left;">默认值</td></tr><tr><td style="text-align:left;">1</td><td style="text-align:left;">高亮</td></tr><tr><td style="text-align:left;">22</td><td style="text-align:left;">非粗体</td></tr><tr><td style="text-align:left;">4</td><td style="text-align:left;">下划线</td></tr><tr><td style="text-align:left;">24</td><td style="text-align:left;">非下划线</td></tr><tr><td style="text-align:left;">5</td><td style="text-align:left;">闪烁</td></tr><tr><td style="text-align:left;">25</td><td style="text-align:left;">非闪烁</td></tr><tr><td style="text-align:left;">7</td><td style="text-align:left;">反显</td></tr><tr><td style="text-align:left;">27</td><td style="text-align:left;">非反显</td></tr></tbody></table><p>前景色</p><table><thead><tr><th style="text-align:left;">数值</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">30</td><td style="text-align:left;">黑色</td></tr><tr><td style="text-align:left;">31</td><td style="text-align:left;">红色</td></tr><tr><td style="text-align:left;">32</td><td style="text-align:left;">绿色</td></tr><tr><td style="text-align:left;">33</td><td style="text-align:left;">黄色</td></tr><tr><td style="text-align:left;">34</td><td style="text-align:left;">蓝色</td></tr><tr><td style="text-align:left;">35</td><td style="text-align:left;">洋红</td></tr><tr><td style="text-align:left;">36</td><td style="text-align:left;">青色</td></tr><tr><td style="text-align:left;">37</td><td style="text-align:left;">白色</td></tr></tbody></table><p>背景色</p><table><thead><tr><th style="text-align:left;">数值</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">40</td><td style="text-align:left;">黑色</td></tr><tr><td style="text-align:left;">41</td><td style="text-align:left;">红色</td></tr><tr><td style="text-align:left;">42</td><td style="text-align:left;">绿色</td></tr><tr><td style="text-align:left;">43</td><td style="text-align:left;">黄色</td></tr><tr><td style="text-align:left;">44</td><td style="text-align:left;">蓝色</td></tr><tr><td style="text-align:left;">45</td><td style="text-align:left;">洋红</td></tr><tr><td style="text-align:left;">46</td><td style="text-align:left;">青色</td></tr><tr><td style="text-align:left;">47</td><td style="text-align:left;">白色</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">echo <span class="token operator">-</span>e <span class="token string">&quot;\\033[m hello \\033[m&quot;</span></span>
<span class="line"><span class="token literal-property property">显示方式</span><span class="token operator">:</span> 正常    字体前景色：红色  背景色：青色</span>
<span class="line">echo <span class="token operator">-</span>e <span class="token string">&quot;\\033[0;31;46m hello \\033[m&quot;</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line"> </span>
<span class="line">function echo_color(){</span>
<span class="line">  if [ $1 == &quot;green&quot; ]; then</span>
<span class="line">     echo -e &quot;\\033[32;40m$2\\033[0m&quot;</span>
<span class="line">  elif [ $1 == &quot;red&quot; ]; then</span>
<span class="line">     echo -e &quot;\\033[31;40m$2\\033[0m&quot;  </span>
<span class="line">  fi    </span>
<span class="line">}</span>
<span class="line"></span>
<span class="line">echo -e &quot;\\033[32;40mshell\\033[0m&quot;</span>
<span class="line">echo -e &quot;\\033[33;40mshell\\033[0m&quot;</span>
<span class="line"></span>
<span class="line">echo_color red hello</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-4-批量创建用户" tabindex="-1"><a class="header-anchor" href="#_7-4-批量创建用户"><span>7.4 批量创建用户</span></a></h3><ul><li><code>/dev/null 2&gt;&amp;1</code> 这条命令的意思是将标准输出和错误输出全部重定向到/dev/null中,也就是将产生的所有信息丢弃</li><li><code>command &gt; file 2&gt;file</code> 的意思是将命令所产生的标准输出信息,和错误的输出信息送到<code>file</code>中。 command &gt; file 2&gt;file 这样的写法,stdout和stderr都直接送到file中, file会被打开两次,这样stdout和stderr会互相覆盖,这样写相当使用了FD1和FD2两个同时去抢占file 的管道</li><li><code>command &gt;file 2&gt;&amp;1</code> 这条命令就将stdout直接送向file, stderr 继承了FD1管道后,再被送往file,此时,file 只被打开了一次,也只使用了一个管道FD1,它包括了stdout和stderr的内容</li></ul><table><thead><tr><th style="text-align:left;">符号</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">&gt;</td><td style="text-align:left;">代表重定向到哪里</td></tr><tr><td style="text-align:left;">/dev/null</td><td style="text-align:left;">代表空设备文件</td></tr><tr><td style="text-align:left;">2</td><td style="text-align:left;">表示stderr标准错误</td></tr><tr><td style="text-align:left;">&amp;</td><td style="text-align:left;">表示等同于的意思，2&gt;&amp;1，表示2的输出重定向等同于1</td></tr><tr><td style="text-align:left;">1</td><td style="text-align:left;">1表示stdout标准输出，系统默认值是1，所以&quot;&gt;/dev/null&quot;等同于 &quot;1&gt;/dev/null&quot;</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line"><span class="token constant">USER_FILE</span><span class="token operator">=</span>users<span class="token punctuation">.</span>txt</span>
<span class="line"><span class="token keyword">for</span> <span class="token constant">USER</span> <span class="token keyword">in</span> user<span class="token punctuation">{</span><span class="token number">1.</span><span class="token number">.5</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">do</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token operator">!</span> id $<span class="token constant">USER</span> <span class="token operator">&amp;</span><span class="token operator">&gt;</span><span class="token operator">/</span>dev<span class="token operator">/</span><span class="token keyword">null</span><span class="token punctuation">;</span> then</span>
<span class="line">    <span class="token constant">PASS</span><span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>echo $<span class="token constant">RANDOM</span> <span class="token operator">|</span> md5sum <span class="token operator">|</span> cut <span class="token operator">-</span>c <span class="token number">1</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span></span>
<span class="line">    useradd $<span class="token constant">USER</span></span>
<span class="line">    echo $<span class="token constant">PASS</span> <span class="token operator">|</span> passwd <span class="token operator">--</span>stdin $<span class="token constant">USER</span> <span class="token operator">&amp;</span><span class="token operator">&gt;</span> <span class="token operator">/</span>dev<span class="token operator">/</span><span class="token keyword">null</span></span>
<span class="line">    echo <span class="token operator">-</span>e <span class="token string">&quot;$USER\\t$PASS&quot;</span> <span class="token operator">&gt;&gt;</span> $<span class="token constant">USER_FILE</span></span>
<span class="line">    echo <span class="token string">&quot;$USER user create successfully.&quot;</span></span>
<span class="line">  <span class="token keyword">else</span></span>
<span class="line">    echo_color red <span class="token string">&quot;$USER already exists.&quot;</span><span class="token punctuation">;</span>  </span>
<span class="line">  fi</span>
<span class="line">done</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-5-检查主机存活状态" tabindex="-1"><a class="header-anchor" href="#_7-5-检查主机存活状态"><span>7.5 检查主机存活状态</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line"><span class="token keyword">for</span> <span class="token constant">IP</span> <span class="token keyword">in</span> $@<span class="token punctuation">;</span> <span class="token keyword">do</span></span>
<span class="line">  <span class="token keyword">if</span> ping <span class="token operator">-</span>c <span class="token number">1</span> $<span class="token constant">IP</span> <span class="token operator">&amp;</span><span class="token operator">&gt;</span><span class="token operator">/</span>dev<span class="token operator">/</span><span class="token keyword">null</span><span class="token punctuation">;</span> then</span>
<span class="line">     echo <span class="token string">&quot;$IP is ok.&quot;</span></span>
<span class="line">  <span class="token keyword">else</span></span>
<span class="line">     echo <span class="token string">&quot;$IP is wrong!&quot;</span></span>
<span class="line">  fi</span>
<span class="line">done       </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-6-系统监控" tabindex="-1"><a class="header-anchor" href="#_7-6-系统监控"><span>7.6 系统监控</span></a></h3><h4 id="_7-6-1-系统命令" tabindex="-1"><a class="header-anchor" href="#_7-6-1-系统命令"><span>7.6.1 系统命令</span></a></h4><h5 id="_7-6-1-1-vmstat" tabindex="-1"><a class="header-anchor" href="#_7-6-1-1-vmstat"><span>7.6.1.1 vmstat</span></a></h5><ul><li>借助<code>vmstat</code>工具来分析CPU统计信息</li><li>vmstat(Virtual Memory Statistics 虚拟内存统计) 命令用来显示Linux系统虚拟内存状态，也可以报告关于进程、内存、I/O等系统整体运行状态</li><li>vmstat [刷新延时 刷新次数]</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">vmstat <span class="token number">1</span> <span class="token number">3</span></span>
<span class="line">procs <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>memory<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">-</span>swap<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>io<span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">--</span>system<span class="token operator">--</span> <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>cpu<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span></span>
<span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="token keyword">in</span>   cs us sy id wa st</span>
<span class="line"> <span class="token number">1</span>  <span class="token number">0</span>    <span class="token number">532</span> <span class="token number">329932</span>  <span class="token number">99388</span> <span class="token number">459768</span>    <span class="token number">0</span>    <span class="token number">0</span>    <span class="token number">16</span>    <span class="token number">81</span>   <span class="token number">59</span>   <span class="token number">50</span>  <span class="token number">3</span>  <span class="token number">1</span> <span class="token number">96</span>  <span class="token number">0</span>  <span class="token number">0</span>    </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_7-6-1-1-1-procs-进程信息字段" tabindex="-1"><a class="header-anchor" href="#_7-6-1-1-1-procs-进程信息字段"><span>7.6.1.1.1 (procs)进程信息字段</span></a></h6><table><thead><tr><th style="text-align:left;">分类</th><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">procs</td><td style="text-align:left;">r</td><td style="text-align:left;">等待运行的进程数，数量越大，系统就越繁忙</td></tr><tr><td style="text-align:left;">procs</td><td style="text-align:left;">b</td><td style="text-align:left;">不可被唤醒的进程数量，数量越大，系统越繁忙</td></tr></tbody></table><h6 id="_7-6-1-1-2-memory-内存信息字段" tabindex="-1"><a class="header-anchor" href="#_7-6-1-1-2-memory-内存信息字段"><span>7.6.1.1.2 memory(内存信息字段)</span></a></h6><table><thead><tr><th style="text-align:left;">分类</th><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">memory</td><td style="text-align:left;">swpd</td><td style="text-align:left;">使用的Swap空间的大小，单位KB</td></tr><tr><td style="text-align:left;">memory</td><td style="text-align:left;">free</td><td style="text-align:left;">空闲的内存容量，单位KB</td></tr><tr><td style="text-align:left;">memory</td><td style="text-align:left;">buff</td><td style="text-align:left;">缓冲的内存容量，单位KB</td></tr><tr><td style="text-align:left;">memory</td><td style="text-align:left;">cache</td><td style="text-align:left;">缓存的内存容量，单位KB</td></tr></tbody></table><h6 id="_7-6-1-1-3-swap-交换分区信息" tabindex="-1"><a class="header-anchor" href="#_7-6-1-1-3-swap-交换分区信息"><span>7.6.1.1.3 swap(交换分区信息)</span></a></h6><ul><li>如果说si和so数越大说明数据经常要在磁盘和内存之间数据交换，系统性能就会越差</li></ul><table><thead><tr><th style="text-align:left;">分类</th><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">swap</td><td style="text-align:left;">si(in)</td><td style="text-align:left;">从磁盘中交换到内存中的数据的数量，单位KB</td></tr><tr><td style="text-align:left;">swap</td><td style="text-align:left;">so(out)</td><td style="text-align:left;">从内存中交换到硬盘中的数据的数量，单位KB</td></tr></tbody></table><h6 id="_7-6-1-1-4-io-磁盘读写" tabindex="-1"><a class="header-anchor" href="#_7-6-1-1-4-io-磁盘读写"><span>7.6.1.1.4 io(磁盘读写)</span></a></h6><ul><li>bi和bo数越大，说明磁盘的I/O越繁忙</li></ul><table><thead><tr><th style="text-align:left;">分类</th><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">io</td><td style="text-align:left;">bi(in)</td><td style="text-align:left;">从块设备读入数据的问题，单位是块</td></tr><tr><td style="text-align:left;">io</td><td style="text-align:left;">bo(out)</td><td style="text-align:left;">写到块设备的数据的总量，单位是块</td></tr></tbody></table><h6 id="_7-6-1-1-5-system-系统信息字段" tabindex="-1"><a class="header-anchor" href="#_7-6-1-1-5-system-系统信息字段"><span>7.6.1.1.5 system(系统信息字段)</span></a></h6><ul><li>in和cs数越大，说明系统与接口设备的通信越繁忙</li></ul><table><thead><tr><th style="text-align:left;">分类</th><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">system</td><td style="text-align:left;">in(interrupt)</td><td style="text-align:left;">每秒被中断的进程次数</td></tr><tr><td style="text-align:left;">system</td><td style="text-align:left;">cs(switch)</td><td style="text-align:left;">每秒钟进行的事件切换次数</td></tr></tbody></table><h6 id="_7-6-1-1-6-cpu-cpu信息字段" tabindex="-1"><a class="header-anchor" href="#_7-6-1-1-6-cpu-cpu信息字段"><span>7.6.1.1.6 CPU(CPU信息字段)</span></a></h6><table><thead><tr><th style="text-align:left;">分类</th><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">CPU</td><td style="text-align:left;">us(user)</td><td style="text-align:left;">非内核进程消耗CPU运算时间的百分比</td></tr><tr><td style="text-align:left;">CPU</td><td style="text-align:left;">sy(system)</td><td style="text-align:left;">内核进程消耗CPU运算时间的百分比</td></tr><tr><td style="text-align:left;">CPU</td><td style="text-align:left;">id(idea)</td><td style="text-align:left;">空闲CPU的百分比</td></tr><tr><td style="text-align:left;">CPU</td><td style="text-align:left;">wa(wait)</td><td style="text-align:left;">等待I/O所消耗的CPU百分比</td></tr><tr><td style="text-align:left;">CPU</td><td style="text-align:left;">st(steal)</td><td style="text-align:left;">被虚拟机偷走的CPU百分比</td></tr></tbody></table><h5 id="_7-6-1-2-free" tabindex="-1"><a class="header-anchor" href="#_7-6-1-2-free"><span>7.6.1.2 free</span></a></h5><ul><li>查看内存使用状态</li><li>free [-b|-k|-m|-g]</li></ul><p>选项 |参数名称|参数含义| |:----|:----| |-b|以字节为单位| |-k|以KB字节为单位| |-m|以MB字节为单位| |-g|以GB字节为单位|</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">             total       used       free     shared    buffers     cached</span>
<span class="line">Mem:          1006        687        319          0         98        449</span>
<span class="line">-/+ buffers/cache:        139        866</span>
<span class="line">Swap:         1999          0       1999</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_7-6-1-2-1-第一行" tabindex="-1"><a class="header-anchor" href="#_7-6-1-2-1-第一行"><span>7.6.1.2.1 第一行</span></a></h6><table><thead><tr><th style="text-align:left;">分类</th><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">total</td><td style="text-align:left;">内存总数,total=used+free</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">used</td><td style="text-align:left;">已经使用的内存数</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">free</td><td style="text-align:left;">空闲的内存数</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">shared</td><td style="text-align:left;">多个进程共享的内存数,0，废弃，永远为0</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">buffers</td><td style="text-align:left;">缓冲区内存数,buffer用于作为写入磁盘的内容缓冲区</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">cached</td><td style="text-align:left;">缓存内存数,用于从磁盘中读取的内容缓存</td><td style="text-align:left;"></td></tr></tbody></table><h6 id="_7-6-1-2-2-第二行" tabindex="-1"><a class="header-anchor" href="#_7-6-1-2-2-第二行"><span>7.6.1.2.2 第二行</span></a></h6><ul><li>用于指示应用程序看到的内存情况，也就是应用程序获取内存大小</li></ul><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">算法</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">- buffers/cache</td><td style="text-align:left;">第一行的used-buffers-cached</td><td style="text-align:left;">已经使用的要减去缓存和缓冲的内存量</td></tr><tr><td style="text-align:left;">+ buffers/cache</td><td style="text-align:left;">第一行的free+buffers+cached</td><td style="text-align:left;">空闲的要加上缓存和缓冲的内存量</td></tr></tbody></table><h6 id="_7-6-1-2-3-第三行" tabindex="-1"><a class="header-anchor" href="#_7-6-1-2-3-第三行"><span>7.6.1.2.3 第三行</span></a></h6><table><thead><tr><th style="text-align:left;">分类</th><th style="text-align:left;">参数</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">total</td><td style="text-align:left;">swap总数，默认单位是K</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">used</td><td style="text-align:left;">已经使用的swap数，默认单位是K</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">free</td><td style="text-align:left;">空闲的swap数，默认单位是K</td><td style="text-align:left;"></td></tr></tbody></table><h5 id="_7-6-1-3-查询网络状态" tabindex="-1"><a class="header-anchor" href="#_7-6-1-3-查询网络状态"><span>7.6.1.3 查询网络状态</span></a></h5><ul><li>netstat 选项</li></ul><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">-t</td><td style="text-align:left;">列出TCP协议端口</td></tr><tr><td style="text-align:left;">-u</td><td style="text-align:left;">列出UDP协议端口</td></tr><tr><td style="text-align:left;">-n</td><td style="text-align:left;">不使用域名与服务名，而使用IP地址和端口号</td></tr><tr><td style="text-align:left;">-l</td><td style="text-align:left;">仅列出在监听状态网络服务</td></tr><tr><td style="text-align:left;">-a</td><td style="text-align:left;">列出所有的网络连接</td></tr></tbody></table><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">netstat -tlun</span>
<span class="line">netstat -an | more</span>
<span class="line">netstat -unt | grep  ESTABLISHED</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-6-2-函数" tabindex="-1"><a class="header-anchor" href="#_7-6-2-函数"><span>7.6.2 函数</span></a></h4><h5 id="_7-6-2-1-cpu" tabindex="-1"><a class="header-anchor" href="#_7-6-2-1-cpu"><span>7.6.2.1 cpu</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line"><span class="token function">cpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    local user system idle cwait</span>
<span class="line">    user<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>vmstat <span class="token operator">|</span> awk <span class="token string">&#39;NR==3{print $13}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    system<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>vmstat <span class="token operator">|</span> awk <span class="token string">&#39;NR==3{print $14}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    idea<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>vmstat <span class="token operator">|</span> awk <span class="token string">&#39;NR==3{print $15}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    cwait<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>vmstat <span class="token operator">|</span> awk <span class="token string">&#39;NR==3{print $16}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    echo <span class="token string">&quot;user cpu: $user%&quot;</span></span>
<span class="line">    echo <span class="token string">&quot;system cpu: $system%&quot;</span></span>
<span class="line">    echo <span class="token string">&quot;idle cpu: $idea%&quot;</span></span>
<span class="line">    echo <span class="token string">&quot;wait: $cwait%&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">cpu</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_7-6-2-2-memory" tabindex="-1"><a class="header-anchor" href="#_7-6-2-2-memory"><span>7.6.2.2 memory</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">memory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">  local total used free</span>
<span class="line">  used<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>free <span class="token operator">-</span>m <span class="token operator">|</span> awk <span class="token string">&#39;NR==3{print $3}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  free<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>free <span class="token operator">-</span>m <span class="token operator">|</span> awk <span class="token string">&#39;NR==3{print $4}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  total<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$used<span class="token operator">+</span>$free<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">  echo <span class="token string">&quot;内存总计: \${total}M&quot;</span></span>
<span class="line">  echo <span class="token string">&quot;内存使用: \${used}M&quot;</span></span>
<span class="line">  echo <span class="token string">&quot;内存剩余: \${free}M&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">memory</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_7-6-2-3-disk" tabindex="-1"><a class="header-anchor" href="#_7-6-2-3-disk"><span>7.6.2.3 disk</span></a></h5><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">disk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">  local mount total used used_percent free</span>
<span class="line">  partitions<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>df <span class="token operator">-</span>h<span class="token operator">|</span>awk <span class="token string">&#39;BEGIN{OFS=&quot;=&quot;}/^\\/dev/{print $6,$2,$3,$4,$5}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  echo $p</span>
<span class="line">  <span class="token keyword">for</span> p <span class="token keyword">in</span>  $partitions<span class="token punctuation">;</span> <span class="token keyword">do</span></span>
<span class="line">    mount<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>echo $p <span class="token operator">|</span> cut <span class="token operator">-</span>d<span class="token string">&quot;=&quot;</span> <span class="token operator">-</span>f1<span class="token punctuation">)</span></span>
<span class="line">    total<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>echo $p <span class="token operator">|</span> cut <span class="token operator">-</span>d<span class="token string">&quot;=&quot;</span> <span class="token operator">-</span>f2<span class="token punctuation">)</span></span>
<span class="line">    used<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>echo $p <span class="token operator">|</span> cut <span class="token operator">-</span>d<span class="token string">&quot;=&quot;</span> <span class="token operator">-</span>f3<span class="token punctuation">)</span></span>
<span class="line">    free<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>echo $p <span class="token operator">|</span> cut <span class="token operator">-</span>d<span class="token string">&quot;=&quot;</span> <span class="token operator">-</span>f4<span class="token punctuation">)</span></span>
<span class="line">    used_percent<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>echo $p <span class="token operator">|</span> cut <span class="token operator">-</span>d<span class="token string">&quot;=&quot;</span> <span class="token operator">-</span>f5<span class="token operator">|</span>cut <span class="token operator">-</span>d<span class="token string">&quot;%&quot;</span> <span class="token operator">-</span>f1<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">[</span> $used_percent <span class="token operator">-</span>ge <span class="token number">5</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> then</span>
<span class="line">      echo <span class="token string">&quot;挂载点=$mount,总大小=$total,使用大小=$used,空闲大小=$free,使用百分比=$used_percent%&quot;</span></span>
<span class="line">    fi  </span>
<span class="line">  done</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-7-监控网络流量" tabindex="-1"><a class="header-anchor" href="#_7-7-监控网络流量"><span>7.7 监控网络流量</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">network</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    local old_in old_out new_in new_out</span>
<span class="line">    old_in<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>ifconfig ens33 <span class="token operator">|</span> awk <span class="token string">&#39;/RX/&amp;&amp;/bytes/{print $5}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    old_out<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>ifconfig ens33 <span class="token operator">|</span> awk <span class="token string">&#39;/TX/&amp;&amp;/bytes/{print $5}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    sleep 1s</span>
<span class="line">    new_in<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>ifconfig ens33 <span class="token operator">|</span> awk <span class="token string">&#39;/RX/&amp;&amp;/bytes/{print $5}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    new_out<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>ifconfig ens33 <span class="token operator">|</span> awk <span class="token string">&#39;/TX/&amp;&amp;/bytes/{print $5}&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">in</span><span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$new_in<span class="token operator">-</span>$old_in<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    out<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token punctuation">(</span>$new_out<span class="token operator">-</span>$old_out<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    echo <span class="token string">&quot;$1 入口流量=\${in}bytes/s 出口流量=\${out}bytes/s&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">network</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-8-监控网站状态" tabindex="-1"><a class="header-anchor" href="#_7-8-监控网站状态"><span>7.8 监控网站状态</span></a></h3><ul><li>-w 可以获取一些变量的值</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">curl <span class="token operator">-</span>o <span class="token operator">/</span>dev<span class="token operator">/</span><span class="token keyword">null</span> <span class="token operator">-</span>s <span class="token operator">-</span>w <span class="token string">&quot;%{http_code}&quot;</span> <span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>baidu<span class="token punctuation">.</span>com</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">check_url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token constant">HTTP_CODE</span><span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>curl <span class="token operator">-</span>o <span class="token operator">/</span>dev<span class="token operator">/</span><span class="token keyword">null</span> <span class="token operator">-</span>s <span class="token operator">-</span>w <span class="token string">&quot;%{http_code}&quot;</span> $1<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">[</span> $<span class="token constant">HTTP_CODE</span> <span class="token operator">-</span>ne <span class="token number">200</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> then</span>
<span class="line">      echo <span class="token string">&quot;$1不可达&quot;</span></span>
<span class="line">    <span class="token keyword">else</span></span>
<span class="line">      echo <span class="token string">&quot;$1状态正常&quot;</span>  </span>
<span class="line">    fi</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-9-监控nginx状态" tabindex="-1"><a class="header-anchor" href="#_7-9-监控nginx状态"><span>7.9 监控nginx状态</span></a></h3><h4 id="_7-9-1-本地安装nginx" tabindex="-1"><a class="header-anchor" href="#_7-9-1-本地安装nginx"><span>7.9.1 本地安装nginx</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">rpm <span class="token operator">-</span>Uvh http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>nginx<span class="token punctuation">.</span>org<span class="token operator">/</span>packages<span class="token operator">/</span>centos<span class="token operator">/</span><span class="token number">7</span><span class="token operator">/</span>noarch<span class="token operator">/</span><span class="token constant">RPMS</span><span class="token operator">/</span>nginx<span class="token operator">-</span>release<span class="token operator">-</span>centos<span class="token operator">-</span><span class="token number">7</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">.</span>el7<span class="token punctuation">.</span>ngx<span class="token punctuation">.</span>noarch<span class="token punctuation">.</span>rpm</span>
<span class="line">yum install <span class="token operator">-</span>y nginx</span>
<span class="line">systemctl start nginx<span class="token punctuation">.</span>service</span>
<span class="line">systemctl status  nginx<span class="token punctuation">.</span>service</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-9-2-监控脚本" tabindex="-1"><a class="header-anchor" href="#_7-9-2-监控脚本"><span>7.9.2 监控脚本</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">local nginx</span>
<span class="line">nginx<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">ps -ef |grep nginx|grep -v grep|wc -l</span><span class="token template-punctuation string">\`</span></span></span>
<span class="line"> <span class="token keyword">if</span> <span class="token punctuation">[</span> $nginx <span class="token operator">-</span>gt <span class="token number">2</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>then</span>
<span class="line">    echo <span class="token string">&quot;your nginx is running&quot;</span></span>
<span class="line">    exit <span class="token number">0</span></span>
<span class="line"> <span class="token keyword">else</span></span>
<span class="line">    <span class="token operator">/</span>bin<span class="token operator">/</span>systemctl start nginx<span class="token punctuation">.</span>service</span>
<span class="line">    exit <span class="token number">1</span></span>
<span class="line">fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-10-监控mysql状态" tabindex="-1"><a class="header-anchor" href="#_7-10-监控mysql状态"><span>7.10 监控mysql状态</span></a></h3><h4 id="_7-10-1-本地安装mysql" tabindex="-1"><a class="header-anchor" href="#_7-10-1-本地安装mysql"><span>7.10.1 本地安装mysql</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">wget <span class="token operator">-</span>i <span class="token operator">-</span>c http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>dev<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>com<span class="token operator">/</span>get<span class="token operator">/</span>mysql57<span class="token operator">-</span>community<span class="token operator">-</span>release<span class="token operator">-</span>el7<span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">.</span>noarch<span class="token punctuation">.</span>rpm</span>
<span class="line">yum <span class="token operator">-</span>y install mysql57<span class="token operator">-</span>community<span class="token operator">-</span>release<span class="token operator">-</span>el7<span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">.</span>noarch<span class="token punctuation">.</span>rpm</span>
<span class="line">yum <span class="token operator">-</span>y install mysql<span class="token operator">-</span>community<span class="token operator">-</span>server</span>
<span class="line">systemctl start  mysqld<span class="token punctuation">.</span>service</span>
<span class="line">systemctl status mysqld<span class="token punctuation">.</span>service</span>
<span class="line"></span>
<span class="line"></span>
<span class="line">mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-10-2-默认密码和忘记密码" tabindex="-1"><a class="header-anchor" href="#_7-10-2-默认密码和忘记密码"><span>7.10.2 默认密码和忘记密码</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">cat  <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>mysqld<span class="token punctuation">.</span>log <span class="token operator">|</span> grep  temporary</span>
<span class="line"></span>
<span class="line"><span class="token number">1.</span> 修改<span class="token operator">/</span>etc<span class="token operator">/</span>my<span class="token punctuation">.</span>conf<span class="token punctuation">,</span> 添加参数skip<span class="token operator">-</span>grant<span class="token operator">-</span>tables</span>
<span class="line">systemctl restart mysqld<span class="token punctuation">.</span>service</span>
<span class="line">mysql <span class="token operator">-</span>uroot</span>
<span class="line">use mysql</span>
<span class="line">update user <span class="token keyword">set</span> authentication_string<span class="token operator">=</span><span class="token constant">PASSWORD</span><span class="token punctuation">(</span><span class="token string">&#39;123456&#39;</span><span class="token punctuation">)</span> where User<span class="token operator">=</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">;</span></span>
<span class="line">alter user <span class="token string">&#39;root&#39;</span>@<span class="token string">&#39;localhost&#39;</span> identified by <span class="token string">&#39;Zfpx2019@qq.com&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-10-3-监控脚本" tabindex="-1"><a class="header-anchor" href="#_7-10-3-监控脚本"><span>7.10.3 监控脚本</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line">PortNum<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">netstat -lnt|grep 3306|wc -l</span><span class="token template-punctuation string">\`</span></span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span> $PortNum <span class="token operator">-</span>eq <span class="token number">1</span> <span class="token punctuation">]</span></span>
<span class="line">then</span>
<span class="line"> echo <span class="token string">&quot;mysqld is running.&quot;</span></span>
<span class="line"><span class="token keyword">else</span></span>
<span class="line"> echo <span class="token string">&quot;mysqld is stoped.&quot;</span></span>
<span class="line">fi</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-11-mysql备份脚本" tabindex="-1"><a class="header-anchor" href="#_7-11-mysql备份脚本"><span>7.11 mysql备份脚本</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line"><span class="token constant">DATE</span><span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>date <span class="token operator">+</span><span class="token operator">%</span><span class="token constant">F_</span><span class="token operator">%</span><span class="token constant">H</span><span class="token operator">-</span><span class="token operator">%</span><span class="token constant">M</span><span class="token operator">-</span><span class="token operator">%</span><span class="token constant">S</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token constant">HOST</span><span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span></span>
<span class="line"><span class="token constant">DB</span><span class="token operator">=</span>test</span>
<span class="line"><span class="token constant">USER</span><span class="token operator">=</span>root</span>
<span class="line"><span class="token constant">PASS</span><span class="token operator">=</span>Zfpx2019@qq<span class="token punctuation">.</span>com</span>
<span class="line"><span class="token constant">MAIL</span><span class="token operator">=</span><span class="token string">&quot;83687401@qq.com&quot;</span></span>
<span class="line"><span class="token constant">BACKUP_DIR</span><span class="token operator">=</span><span class="token operator">/</span>data<span class="token operator">/</span>db_backup</span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token operator">-</span>d <span class="token string">&quot;$BACKUP_DIR&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>then</span>
<span class="line"> mkdir <span class="token operator">-</span>p $<span class="token constant">BACKUP_DIR</span></span>
<span class="line">fi</span>
<span class="line"><span class="token constant">SQL_FILE</span><span class="token operator">=</span>$<span class="token punctuation">{</span><span class="token constant">DB</span><span class="token punctuation">}</span>_FULL_$<span class="token constant">DATE</span><span class="token punctuation">.</span>sql</span>
<span class="line"><span class="token constant">BAK_FILE</span><span class="token operator">=</span>$<span class="token punctuation">{</span><span class="token constant">DB</span><span class="token punctuation">}</span>_FULL_$<span class="token constant">DATE</span><span class="token punctuation">.</span>zip</span>
<span class="line">cd $<span class="token constant">BACKUP_DIR</span></span>
<span class="line"><span class="token keyword">if</span> mysqldump <span class="token operator">-</span>h$<span class="token constant">HOST</span> <span class="token operator">-</span>u$<span class="token constant">USER</span> <span class="token operator">-</span>p$<span class="token constant">PASS</span> <span class="token operator">-</span><span class="token constant">B</span> $<span class="token constant">DB</span> <span class="token operator">&gt;</span> $<span class="token constant">SQL_FILE</span><span class="token punctuation">;</span> then</span>
<span class="line">  zip $<span class="token constant">BAK_FILE</span> $<span class="token constant">SQL_FILE</span> <span class="token operator">&amp;&amp;</span> rm <span class="token operator">-</span>rf $<span class="token constant">SQL_FILE</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token operator">-</span>s $<span class="token constant">BAK_FILE</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> then</span>
<span class="line">    echo <span class="token string">&quot;$DATE 备份失败&quot;</span> <span class="token operator">|</span> mail <span class="token operator">-</span>s <span class="token string">&quot;备份失败&quot;</span> $<span class="token constant">MAIL</span></span>
<span class="line">  fi</span>
<span class="line"><span class="token keyword">else</span></span>
<span class="line">  echo <span class="token string">&quot;$DATE 备份失败&quot;</span> <span class="token operator">|</span> mail <span class="token operator">-</span>s <span class="token string">&quot;备份失败&quot;</span> $<span class="token constant">MAIL</span></span>
<span class="line">fi</span>
<span class="line">find $<span class="token constant">BACKUP_DIR</span> <span class="token operator">-</span>name <span class="token string">&#39;*.zip&#39;</span> <span class="token operator">-</span>ctime <span class="token operator">+</span><span class="token number">14</span> <span class="token operator">-</span>exec rm <span class="token punctuation">{</span><span class="token punctuation">}</span> \\<span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_8-附录" tabindex="-1"><a class="header-anchor" href="#_8-附录"><span>8. 附录</span></a></h2><h3 id="_8-1-linux特殊文件" tabindex="-1"><a class="header-anchor" href="#_8-1-linux特殊文件"><span>8.1. Linux特殊文件</span></a></h3><h4 id="_8-1-1-块设备" tabindex="-1"><a class="header-anchor" href="#_8-1-1-块设备"><span>8.1.1 块设备</span></a></h4><ul><li>块设备：系统能够随机无序访问固定大小的数据片的设备，这些数据片称为块。块设备是以固定大小长度来传送资料的，它使用缓冲区暂存数据，时机成熟后从缓存中一次性写入到设备或者从设备中一次性放到缓存区。常见的块设备有硬盘、CD-ROM驱动器、Flash闪存等等，它们也是通过文件形式存在于Linux中的。Linux以<code>b</code>(block)表示块设备</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">brw-rw----.   /dev/sr0</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-1-2-字符设备" tabindex="-1"><a class="header-anchor" href="#_8-1-2-字符设备"><span>8.1.2 字符设备</span></a></h4><ul><li>字符设备：按照字符流方式被有序访问，以不定长度的字符传送资料，不存在缓冲区，所以对这种设备的读写都是实时的，比如键盘等等。Linux以<code>c</code>(char)表示字符设备</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> </span>
<span class="line">crw-r-----.   /dev/input/mouse0</span>
<span class="line"> </span>
<span class="line">crw-r-----.  /dev/input/event0</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-1-3-管道文件" tabindex="-1"><a class="header-anchor" href="#_8-1-3-管道文件"><span>8.1.3 管道文件</span></a></h4><ul><li>管道文件是linux下的一种特殊缓存文件,所谓缓存就是只会存在于进程执行的时候，进程关闭管道文件也关闭了,管道文件要在读写的时候，先阻塞在写操作的open函数，当有读操作进来的时候，通信链路建立，写操作开始往管道里写东西，写完成之后，在读操作会把东西读出来，最后两个进程都正常结束退出,Linux以<code>p</code>(pipe)表示管道设备</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">find <span class="token operator">/</span> <span class="token operator">-</span>type p</span>
<span class="line">ll <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>run<span class="token operator">/</span>autofs<span class="token punctuation">.</span>fifo<span class="token operator">-</span>misc</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_8-1-4-套接字" tabindex="-1"><a class="header-anchor" href="#_8-1-4-套接字"><span>8.1.4 套接字</span></a></h4><ul><li>套接字Socket看做是不同主机之间的进程进行双向通信的端点，简单的说就是通信的两方的一种约定，用套接字中的相关函数来完成通信过程。套接字Socket是连接应用程序和网络驱动程序的桥梁，套接字Socket在应用程序中创建，通过绑定与网络驱动建立关系。此后，应用程序送给套接字Socket的数据，由套接字Socket交给网络驱动程序向网络上发送出去。计算机从网络上收到与该套接字Socket绑定IP地址和端口号相关的数据后，由网络驱动程序交给Socket，应用程序便可从该Socket中提取接收到的数据，网络应用程序就是这样通过Socket进行数据的发送与接收的。Linux以<code>S</code>(Socket)表示套接字设备</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line"> [root@localhost input]</span>
<span class="line">srwxrwxrwx. 1 mysql mysql 0 4月   6 12:18 /tmp/mysql.sock</span>
<span class="line"> [root@localhost input]</span>
<span class="line">srwxrwxrwx. 1 root root 0 4月   6 17:51 /var/run/cups/cups.sock</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,410)])])}const c=a(l,[["render",i]]),d=JSON.parse('{"path":"/strong/61.5.devops-shell.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/61.5.devops-shell.md"}');export{c as comp,d as data};
