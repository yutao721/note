import{_ as s,c as a,a as t,o as p}from"./app-CD1YpnS1.js";const e={};function l(c,n){return p(),a("div",null,[...n[0]||(n[0]=[t(`<h2 id="_1-掘金爬虫" tabindex="-1"><a class="header-anchor" href="#_1-掘金爬虫"><span>1. 掘金爬虫</span></a></h2><p>通过一个实例来介绍如何编写网络爬虫抓去掘金数据，并存储到MySQL数据库中，以及定时任务爬虫来更新内容</p><h2 id="_2-核心步骤" tabindex="-1"><a class="header-anchor" href="#_2-核心步骤"><span>2. 核心步骤</span></a></h2><ol><li>发起HTTP请求获取网页内容</li><li>使用类似jQuery的语法来操作网页提取需要的数据</li><li>把数据保存到数据库中以供查询</li><li>建立一个服务器来显示这些数据</li><li>可以定时爬取数据</li><li>让程序稳定运行</li><li>对编码进行转换</li></ol><h2 id="_3-核心类库" tabindex="-1"><a class="header-anchor" href="#_3-核心类库"><span>3. 核心类库</span></a></h2><h3 id="_3-1-request" tabindex="-1"><a class="header-anchor" href="#_3-1-request"><span>3.1 request</span></a></h3><ul><li><a href="https://nodei.co/npm/request" target="_blank" rel="noopener noreferrer">npm request</a></li><li><a href="https://github.com/request/request" target="_blank" rel="noopener noreferrer">github request</a></li></ul><h4 id="_3-1-1-安装" tabindex="-1"><a class="header-anchor" href="#_3-1-1-安装"><span>3.1.1 安装</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">npm install --save request</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-1-2-get请求" tabindex="-1"><a class="header-anchor" href="#_3-1-2-get请求"><span>3.1.2 GET请求</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">request</span><span class="token punctuation">(</span><span class="token string">&#39;http://www.baidu.com&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> response<span class="token punctuation">,</span> body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>statusCode <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-1-3-post-application-json" tabindex="-1"><a class="header-anchor" href="#_3-1-3-post-application-json"><span>3.1.3 POST application/json</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> request<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> options<span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;http://localhost:8080/post&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">json</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;Content-Type&quot;</span><span class="token operator">:</span><span class="token string">&quot;application/json&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&quot;zfpx&quot;</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span>response<span class="token punctuation">,</span>body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>statusCode <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-1-4-post-application-x-www-form-urlencoded" tabindex="-1"><a class="header-anchor" href="#_3-1-4-post-application-x-www-form-urlencoded"><span>3.1.4 POST application/x-www-form-urlencoded</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> request<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> options<span class="token operator">=</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;http://localhost:8080/form&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">&#39;POST&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">json</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">form</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zfpx&#39;</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token function">request</span><span class="token punctuation">(</span>options<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span>response<span class="token punctuation">,</span>body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span>statusCode <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-1-5-post-multipart-form-data" tabindex="-1"><a class="header-anchor" href="#_3-1-5-post-multipart-form-data"><span>3.1.5 POST multipart/form-data</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> request<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> fs<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> formData <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;zfpx&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">avatar</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">value</span><span class="token operator">:</span>  fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">&#39;avatar.jpg&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;avatar.jpg&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">contentType</span><span class="token operator">:</span> <span class="token string">&#39;image/jpeg&#39;</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">request<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">&#39;http://localhost:8080/upload&#39;</span><span class="token punctuation">,</span> formData<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> response<span class="token punctuation">,</span> body</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  </span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>error<span class="token operator">&amp;&amp;</span>response<span class="token punctuation">.</span>statusCode<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-2-cheerio" tabindex="-1"><a class="header-anchor" href="#_3-2-cheerio"><span>3.2 cheerio</span></a></h3><p><a href="https://www.npmjs.com/package/cheerio" target="_blank" rel="noopener noreferrer">cheerio</a>是一个node的库，可以理解为一个Node.js版本的jquery，使用方式和jquery基本相同。</p><h4 id="_3-2-1-安装" tabindex="-1"><a class="header-anchor" href="#_3-2-1-安装"><span>3.2.1 安装</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">npm install cheerio</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-2-2-load装载dom" tabindex="-1"><a class="header-anchor" href="#_3-2-2-load装载dom"><span>3.2.2 load装载DOM</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> str<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string"></span>
<span class="line">&lt;h2 class=&quot;title&quot;&gt;Hello world&lt;/h2&gt;</span>
<span class="line"></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> cheerio<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cheerio&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> $<span class="token operator">=</span>cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;h2.title&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&#39;hello there!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;h2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&#39;welcome&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-3-选择器" tabindex="-1"><a class="header-anchor" href="#_3-2-3-选择器"><span>3.2.3 选择器</span></a></h4><ul><li>选择器在 Context 范围内搜索，Context又在Root范围内搜索。</li><li>root在右，context在左</li><li>selector 和context可以是一个字符串表达式，DOM元素，和DOM元素的数组，或者chreeio对象。</li><li>root 是通常是HTML 文档字符串。</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$(selectior,[context],[root])</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> html<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string"></span>
<span class="line">&lt;ul id=&quot;fruits&quot;&gt;</span>
<span class="line">  &lt;li class=&quot;apple&quot;&gt;Apple&lt;/li&gt;</span>
<span class="line">  &lt;li class=&quot;orange&quot;&gt;Orange&lt;/li&gt;</span>
<span class="line">  &lt;li class=&quot;pear&quot;&gt;Pear&lt;/li&gt;</span>
<span class="line">&lt;/ul&gt;</span>
<span class="line"></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> cheerio<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cheerio&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> $<span class="token operator">=</span>cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">,</span>&#39;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-5-attr修改属性" tabindex="-1"><a class="header-anchor" href="#_3-2-5-attr修改属性"><span>3.2.5 attr修改属性</span></a></h4><ul><li>获得和修改属性</li><li>在匹配的元素中只能获得第一元素的属性。</li><li>如果设置一个属性的值为null，则移除这个属性</li><li>你也可以传递一对键值，或者一个函数。<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">attr(name,value)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;ul&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;favorite&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#39;class&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;favorite&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token string">&#39;favorite&#39;</span><span class="token punctuation">,</span><span class="token keyword">class</span><span class="token operator">:</span><span class="token string">&#39;favorite&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.favorite&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;ul&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-6-removeattr-name" tabindex="-1"><a class="header-anchor" href="#_3-2-6-removeattr-name"><span>3.2.6 removeAttr(name)</span></a></h4><p>通过name删除属性</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.favorite&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeAttr</span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-2-7-prop-修改状态值" tabindex="-1"><a class="header-anchor" href="#_3-2-7-prop-修改状态值"><span>3.2.7 prop()修改状态值</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;input[type=&quot;checkbox&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">&#39;checked&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt; false</span></span>
<span class="line"></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;input[type=&quot;checkbox&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">&#39;checked&#39;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt; ok</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-8-data-自定义属性" tabindex="-1"><a class="header-anchor" href="#_3-2-8-data-自定义属性"><span>3.2.8 data()自定义属性</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;div data-apple-color=&quot;red&quot;&gt;&lt;/div&gt;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt; { appleColor: &#39;red&#39; }</span></span>
<span class="line"></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;div data-apple-color=&quot;red&quot;&gt;&lt;/div&gt;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">&#39;apple-color&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt; &#39;red&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> apple <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">&#39;kind&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;mac&#39;</span><span class="token punctuation">)</span></span>
<span class="line">apple<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">&#39;kind&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt; &#39;mac&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-9-val-赋值" tabindex="-1"><a class="header-anchor" href="#_3-2-9-val-赋值"><span>3.2.9 val()赋值</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;input[type=&quot;text&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt; input_text</span></span>
<span class="line"></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;input[type=&quot;text&quot;]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token string">&#39;test&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt; &lt;input type=&quot;text&quot; value=&quot;test&quot;/&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-10-hasclass-classname" tabindex="-1"><a class="header-anchor" href="#_3-2-10-hasclass-classname"><span>3.2.10 hasClass( className )</span></a></h4><p>检查匹配的元素是否有给出的类名</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">&#39;pear&#39;</span><span class="token punctuation">)</span><span class="token comment">//=&gt; true</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">&#39;fruit&#39;</span><span class="token punctuation">)</span><span class="token comment">//=&gt; false</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;li&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">&#39;pear&#39;</span><span class="token punctuation">)</span><span class="token comment">//=&gt; true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-11-addclass-name" tabindex="-1"><a class="header-anchor" href="#_3-2-11-addclass-name"><span>3.2.11 addClass(name)</span></a></h4><p>增加class(es)给所有匹配的elements.也可以传函数。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&#39;fruit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt; &lt;li class=&quot;pear fruit&quot;&gt;Pear&lt;/li&gt;</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&#39;fruit red&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt; &lt;li class=&quot;apple fruit red&quot;&gt;Apple&lt;/li&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-12-emoveclass-classname" tabindex="-1"><a class="header-anchor" href="#_3-2-12-emoveclass-classname"><span>3.2.12 emoveClass([className])</span></a></h4><p>从选择的elements里去除一个或多个有空格分开的class。如果className 没有定义，所有的classes将会被去除，也可以传函数</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">&#39;pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt;Pear</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&#39;red&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt;Apple</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-13-find-selector" tabindex="-1"><a class="header-anchor" href="#_3-2-13-find-selector"><span>3.2.13 find(selector)</span></a></h4><p>获得一个在匹配的元素中由选择器滤过的后代</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> <span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-2-14-parent-selector" tabindex="-1"><a class="header-anchor" href="#_3-2-14-parent-selector"><span>3.2.14 parent([selector])</span></a></h4><p>获得通过选择器筛选匹配的元素的parent集合</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.orange&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token comment">// =&gt; 2</span></span>
<span class="line"> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.orange&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parents</span><span class="token punctuation">(</span>&#39;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-15-next-获得第一个本元素之后的同级元素" tabindex="-1"><a class="header-anchor" href="#_3-2-15-next-获得第一个本元素之后的同级元素"><span>3.2.15 next()获得第一个本元素之后的同级元素</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">&#39;orange&#39;</span><span class="token punctuation">)</span><span class="token comment">//=&gt; true</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt; null</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-16-nextall" tabindex="-1"><a class="header-anchor" href="#_3-2-16-nextall"><span>3.2.16 .nextAll()</span></a></h4><p>获得本元素之后的所有同级元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt; [&lt;li class=&quot;orange&quot;&gt;Orange&lt;/li&gt;, &lt;li class=&quot;pear&quot;&gt;Pear&lt;/li&gt;]</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token comment">//=&gt;2</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-17-prev" tabindex="-1"><a class="header-anchor" href="#_3-2-17-prev"><span>3.2.17 prev()</span></a></h4><p>获得本元素之前的第一个同级元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.orange&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prev</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasClass</span><span class="token punctuation">(</span><span class="token string">&#39;apple&#39;</span><span class="token punctuation">)</span><span class="token comment">//=&gt; true</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-2-18-preall" tabindex="-1"><a class="header-anchor" href="#_3-2-18-preall"><span>3.2.18 preAll()</span></a></h4><p>获得本元素前的所有同级元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prevAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt; [&lt;li class=&quot;orange&quot;&gt;Orange&lt;/li&gt;, &lt;li class=&quot;apple&quot;&gt;Apple&lt;/li&gt;]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-2-19-slice-start-end" tabindex="-1"><a class="header-anchor" href="#_3-2-19-slice-start-end"><span>3.2.19 slice(start,[end])</span></a></h4><p>获得选定范围内的元素数组</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;li&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt; &#39;Orange&#39;</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;li&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token comment">//=&gt; 1</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-20-siblings-selector" tabindex="-1"><a class="header-anchor" href="#_3-2-20-siblings-selector"><span>3.2.20 siblings(selector)</span></a></h4><p>获得被选择的同级元素(除去自己)</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">siblings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token comment">//=&gt; 2</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">siblings</span><span class="token punctuation">(</span><span class="token string">&#39;.orange&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token comment">//=&gt; 1</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">siblings</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token comment">//=&gt; 0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-21-first" tabindex="-1"><a class="header-anchor" href="#_3-2-21-first"><span>3.2.21 first()</span></a></h4><p>会选择chreeio对象的第一个元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> <span class="token punctuation">(</span>&#39;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-2-22-last" tabindex="-1"><a class="header-anchor" href="#_3-2-22-last"><span>3.2.22 last()</span></a></h4><p>会选择chreeio对象的最后一个元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> <span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-2-23-eq-i" tabindex="-1"><a class="header-anchor" href="#_3-2-23-eq-i"><span>3.2.23 eq(i)</span></a></h4><p>通过索引筛选匹配的元素。使用.eq(-i)就从最后一个元素向前数。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;li&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt; Apple</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;li&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt; Pear</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-24-children-selector" tabindex="-1"><a class="header-anchor" href="#_3-2-24-children-selector"><span>3.2.24 children(selector)</span></a></h4><p>获被选择元素的子元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> <span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line"> <span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-25-each-function-index-element" tabindex="-1"><a class="header-anchor" href="#_3-2-25-each-function-index-element"><span>3.2.25 each(function(index,element))</span></a></h4><p>迭代一个cheerio对象，为每个匹配元素执行一个函数。要提早跳出循环，返回false.</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> fruits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;li&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span> elem</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  fruits<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">fruits<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;, &#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//=&gt; Apple, Orange, Pear</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-26-map-function-index-element" tabindex="-1"><a class="header-anchor" href="#_3-2-26-map-function-index-element"><span>3.2.26 map(function(index,element))</span></a></h4><p>迭代一个cheerio对象，为每个匹配元素执行一个函数。Map会返回一个迭代结果的数组。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;li&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span> el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> </span>
<span class="line">  <span class="token keyword">return</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#39;class&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;, &#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">//=&gt; apple, orange, pear</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-27-filter-selector" tabindex="-1"><a class="header-anchor" href="#_3-2-27-filter-selector"><span>3.2.27 filter(selector)</span></a></h4><ul><li>迭代一个cheerio对象，滤出匹配选择器或者是传进去的函数的元素。</li><li>如果使用函数方法，这个函数在被选择的元素中执行，所以this指向的手势当前元素。</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;li&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token string">&#39;.orange&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#39;class&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//=&gt; orange</span></span>
<span class="line"></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;li&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token punctuation">,</span> el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> </span>
<span class="line">    <span class="token comment">// this === el </span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#39;class&#39;</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#39;orange&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#39;class&#39;</span><span class="token punctuation">)</span>；</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">//=&gt; orange</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-28-append-content-content" tabindex="-1"><a class="header-anchor" href="#_3-2-28-append-content-content"><span>3.2.28 append(content,[content…])</span></a></h4><p>在每个元素最后插入一个子元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;ul&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;li class=&quot;plum&quot;&gt;Plum&lt;/li&gt;&#39;</span><span class="token punctuation">)</span></span>
<span class="line">$<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;apple&quot;&gt;Apple&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;orange&quot;&gt;Orange&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;pear&quot;&gt;Pear&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;plum&quot;&gt;Plum&lt;/li&gt;//</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-29-prepend-content-content" tabindex="-1"><a class="header-anchor" href="#_3-2-29-prepend-content-content"><span>3.2.29 prepend(content,[content,…])</span></a></h4><p>在每个元素最前插入一个子元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;ul&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prepend</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;li class=&quot;plum&quot;&gt;Plum&lt;/li&gt;&#39;</span><span class="token punctuation">)</span></span>
<span class="line">$<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;plum&quot;&gt;Plum&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;apple&quot;&gt;Apple&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;orange&quot;&gt;Orange&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;pear&quot;&gt;Pear&lt;/li&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-30-after-content-content" tabindex="-1"><a class="header-anchor" href="#_3-2-30-after-content-content"><span>3.2.30 after(content,[content,…])</span></a></h4><p>在每个匹配元素之后插入一个元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;li class=&quot;plum&quot;&gt;Plum&lt;/li&gt;&#39;</span><span class="token punctuation">)</span></span>
<span class="line">$<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;apple&quot;&gt;Apple&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;plum&quot;&gt;Plum&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;orange&quot;&gt;Orange&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;pear&quot;&gt;Pear&lt;/li&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-31-before-content-content" tabindex="-1"><a class="header-anchor" href="#_3-2-31-before-content-content"><span>3.2.31 before(content,[content,…])</span></a></h4><p>在每个匹配的元素之前插入一个元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;li class=&quot;plum&quot;&gt;Plum&lt;/li&gt;&#39;</span><span class="token punctuation">)</span></span>
<span class="line">$<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;plum&quot;&gt;Plum&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;apple&quot;&gt;Apple&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;orange&quot;&gt;Orange&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;pear&quot;&gt;Pear&lt;/li&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-32-remove-selector" tabindex="-1"><a class="header-anchor" href="#_3-2-32-remove-selector"><span>3.2.32 remove( [selector] )</span></a></h4><p>从DOM中去除匹配的元素和它们的子元素。选择器用来筛选要删除的元素。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">$<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;apple&quot;&gt;Apple&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;orange&quot;&gt;Orange&lt;/li&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-33-replacewith-content" tabindex="-1"><a class="header-anchor" href="#_3-2-33-replacewith-content"><span>3.2.33 replaceWith( content )</span></a></h4><p>替换匹配的的元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> plum <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;&lt;li class=&quot;plum&quot;&gt;Plum&lt;/li&gt;&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.pear&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceWith</span><span class="token punctuation">(</span>plum<span class="token punctuation">)</span></span>
<span class="line">$<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;apple&quot;&gt;Apple&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;orange&quot;&gt;Orange&lt;/li&gt;</span></span>
<span class="line"><span class="token comment">// &lt;li class=&quot;plum&quot;&gt;Plum&lt;/li&gt;//</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-34-empty" tabindex="-1"><a class="header-anchor" href="#_3-2-34-empty"><span>3.2.34 empty()</span></a></h4><p>清空一个元素，移除所有的子元素</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;ul&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>$<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_3-2-35-html-htmlstring" tabindex="-1"><a class="header-anchor" href="#_3-2-35-html-htmlstring"><span>3.2.35 html( [htmlString] )</span></a></h4><p>获得元素的HTML字符串。如果htmlString有内容的话，将会替代原来的HTML</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.orange&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//=&gt; Orange</span></span>
<span class="line"> <span class="token function">$</span><span class="token punctuation">(</span>&#39;</span>
<span class="line"><span class="token comment">//=&gt; &lt;li class=&quot;mango&quot;&gt;Mango&lt;/li&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-36-text-textstring" tabindex="-1"><a class="header-anchor" href="#_3-2-36-text-textstring"><span>3.2.36 text( [textString] )</span></a></h4><p>获得元素的text内容，包括子元素。如果textString被指定的话，每个元素的text内容都会被替换。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.orange&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt; Orange</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;ul&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//=&gt; Apple// Orange// Pear</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-debug" tabindex="-1"><a class="header-anchor" href="#_3-3-debug"><span>3.3 debug</span></a></h3><ul><li>在编写程序的时候，有时候需要输出一些调试信息，以便排查问题。</li><li>但是在程序运行过程中又不需要这些信息，为了方便切换而且不需要改代码，可以使用debug模块<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">let</span> debug <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;debug&#39;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">&#39;app:main&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&#39;现在的时间是%s&#39;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li>Window系统在命令行中执行 <code>SET DEBUG=app:*</code></li><li>Mac系统在命令行中执行 <code>export DEBUG=app:*</code></li></ul><h3 id="_3-4-corn" tabindex="-1"><a class="header-anchor" href="#_3-4-corn"><span>3.4 corn</span></a></h3><p><a href="https://www.npmjs.com/package/cron" target="_blank" rel="noopener noreferrer">cron</a>用来周期性的执行某种任务或等待处理某些事件的一个守护进程</p><table><thead><tr><th style="text-align:left;">符号</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">星号(*)</td><td style="text-align:left;">代表所有可能的值</td></tr><tr><td style="text-align:left;">逗号(,)</td><td style="text-align:left;">可以用逗号隔开的值指定一个列表范围，例如，“1,2,5,7,8,9”</td></tr><tr><td style="text-align:left;">中杠(-)</td><td style="text-align:left;">可以用整数之间的中杠表示一个整数范围，例如“2-6”表示“2,3,4,5,6”</td></tr><tr><td style="text-align:left;">正斜线(/)</td><td style="text-align:left;">可以用正斜线指定时间的间隔频率，*/10，如果用在minute字段，表示每十分钟执行一次</td></tr></tbody></table><table><thead><tr><th style="text-align:left;">单位</th><th style="text-align:left;">范围</th></tr></thead><tbody><tr><td style="text-align:left;">Seconds</td><td style="text-align:left;">0-59</td></tr><tr><td style="text-align:left;">Minutes</td><td style="text-align:left;">0-59</td></tr><tr><td style="text-align:left;">Hours</td><td style="text-align:left;">0-23</td></tr><tr><td style="text-align:left;">Day</td><td style="text-align:left;">1-31</td></tr><tr><td style="text-align:left;">Months</td><td style="text-align:left;">0-11</td></tr><tr><td style="text-align:left;">Day of Week</td><td style="text-align:left;">0-6</td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> cronJob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cron&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>CronJob<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> job1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">cronJob</span><span class="token punctuation">(</span><span class="token string">&quot;* * * * * *&quot;</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;每秒&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">job1<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-5-监听未知错误" tabindex="-1"><a class="header-anchor" href="#_3-5-监听未知错误"><span>3.5 监听未知错误</span></a></h3><ul><li>大部分情况下，异步的IO操作发生的错误无法被try catch捕获，如果没有捕获会导致程序退出</li><li>在Node.js中，如果一个抛出的异常没有被try catch捕获，会尝试将错误交给uncaughtException事件处理函数来进行处理，仅当没有注册该事件处理函数时才会导致进程直接退出。</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;uncaughtException&#39;</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&#39;uncaughtException: %s&#39;</span><span class="token punctuation">,</span>erro<span class="token punctuation">.</span>stack<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-6-pm2" tabindex="-1"><a class="header-anchor" href="#_3-6-pm2"><span>3.6 pm2</span></a></h3><p>pm2是一个功能强大的进程管理器，通过<code>pm2 start</code>来启动程序, 当该进程异常退出时,pm2会自动尝试重启进程。</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">npm install pm2 -g</span>
<span class="line">npm2 start </span>
<span class="line">pm2 stop </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-7-编码-iconv-lite" tabindex="-1"><a class="header-anchor" href="#_3-7-编码-iconv-lite"><span>3.7 编码(iconv-lite)</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> request <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;request&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> iconv<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;iconv-lite&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> cheerio<span class="token operator">=</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;cheerio&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&#39;http://top.baidu.com/buzz?b=26&amp;c=1&amp;fr=topcategory_c1&#39;</span></span>
<span class="line"><span class="token punctuation">,</span> <span class="token literal-property property">encoding</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>response<span class="token punctuation">,</span>body</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    body <span class="token operator">=</span> iconv<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>body<span class="token punctuation">,</span> <span class="token string">&#39;gbk&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">let</span> $<span class="token operator">=</span>cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">let</span> movies<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.keyword .list-title&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span>item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">let</span> movie<span class="token operator">=</span><span class="token function">$</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        movies<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">            <span class="token literal-property property">name</span><span class="token operator">:</span>movie<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>movies<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-8-发送邮件" tabindex="-1"><a class="header-anchor" href="#_3-8-发送邮件"><span>3.8 发送邮件</span></a></h3><p><a href="https://nodemailer.com/about/" target="_blank" rel="noopener noreferrer">nodemailer</a>是一个简单易用的Node.js邮件发送模块</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">const</span> nodemailer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;nodemailer&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> transporter <span class="token operator">=</span> nodemailer<span class="token punctuation">.</span><span class="token function">createTransport</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// host: &#39;smtp.ethereal.email&#39;,</span></span>
<span class="line">    <span class="token literal-property property">service</span><span class="token operator">:</span> <span class="token string">&#39;qq&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 使用了内置传输发送邮件 查看支持列表：https://nodemailer.com/smtp/well-known/</span></span>
<span class="line">    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">465</span><span class="token punctuation">,</span> <span class="token comment">// SMTP 端口</span></span>
<span class="line">    <span class="token literal-property property">secureConnection</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 使用了 SSL</span></span>
<span class="line">    <span class="token literal-property property">auth</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">&#39;83687401@qq.com&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token comment">// 这里密码不是qq密码，是你设置的smtp授权码</span></span>
<span class="line">        <span class="token literal-property property">pass</span><span class="token operator">:</span> <span class="token string">&#39;gfndwuvvfpbebjdi&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> mailOptions <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">&#39;&quot;83687401&quot; &lt;83687401@qq.com&gt;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// sender address</span></span>
<span class="line">    <span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">&#39;83687401@qq.com&#39;</span><span class="token punctuation">,</span> <span class="token comment">// list of receivers</span></span>
<span class="line">    <span class="token literal-property property">subject</span><span class="token operator">:</span> <span class="token string">&#39;hello&#39;</span><span class="token punctuation">,</span> <span class="token comment">// Subject line</span></span>
<span class="line">    <span class="token comment">// 发送text或者html格式</span></span>
<span class="line">    <span class="token comment">// text: &#39;Hello world?&#39;, // plain text body</span></span>
<span class="line">    <span class="token literal-property property">html</span><span class="token operator">:</span> <span class="token string">&#39;&lt;h1&gt;Hello world&lt;/h1&gt;&#39;</span> <span class="token comment">// html body</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// send mail with defined transport object</span></span>
<span class="line">transporter<span class="token punctuation">.</span><span class="token function">sendMail</span><span class="token punctuation">(</span>mailOptions<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Message sent: %s&#39;</span><span class="token punctuation">,</span> info<span class="token punctuation">.</span>messageId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Message sent: &lt;04ec7731-cc68-1ef6-303c-61b0f796b78f@qq.com&gt;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-9-http代理工具" tabindex="-1"><a class="header-anchor" href="#_3-9-http代理工具"><span>3.9 HTTP代理工具</span></a></h2><ul><li>Windows 平台有 Fiddler，macOS 有 Charles，阿里有AnyProxy</li><li>基本原理就是通过在手机客户端设置好代理IP和端口,客户端所有的 HTTP、HTTPS 请求就会经过代理工具</li></ul><h3 id="_3-9-1-https抓包设置" tabindex="-1"><a class="header-anchor" href="#_3-9-1-https抓包设置"><span>3.9.1 https抓包设置</span></a></h3><h4 id="_3-9-1-1-fiddler" tabindex="-1"><a class="header-anchor" href="#_3-9-1-1-fiddler"><span>3.9.1.1 Fiddler</span></a></h4><ul><li>Tools &gt; Fiddler Options &gt; Connections <ul><li>Fiddler listens on port 8888</li><li>Allow remote computers to connect</li></ul></li><li>Tools &gt; Fiddler Options &gt; HTTPS &gt; Decrypt HTTPS traffic <ul><li>Capture HTTPS CONNECTs</li><li>Decrypt HTTPS traffic</li></ul></li></ul><h4 id="_3-9-1-2-android" tabindex="-1"><a class="header-anchor" href="#_3-9-1-2-android"><span>3.9.1.2 Android</span></a></h4><ul><li>进入手机的 WLAN 设置，选择当前所在局域网的 WiFi 链接，设置代理服务器的 IP 和端口</li><li>访问<a href="http://192.168.31.236:8888/%E6%98%BE%E7%A4%BAecho%E9%A1%B5%E9%9D%A2" target="_blank" rel="noopener noreferrer">http://192.168.31.236:8888/显示echo页面</a></li><li>下载 FiddlerRoot certificate，下载并安装证书，并验证通过</li></ul><h4 id="_3-9-1-3-抓取接口" tabindex="-1"><a class="header-anchor" href="#_3-9-1-3-抓取接口"><span>3.9.1.3 抓取接口</span></a></h4><ul><li>过滤 <code>mp.weixin.qq.com</code> 接口</li><li>历史消息 <a href="https://mp.weixin.qq.com/mp/profile_ext" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/mp/profile_ext</a></li><li>文章详情 <a href="https://mp.weixin.qq.com/mp/getappmsgext" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/mp/getappmsgext</a></li></ul><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考"><span>参考</span></a></h2><ul><li><a href="https://www.telerik.com/download/fiddler" target="_blank" rel="noopener noreferrer">fiddler</a></li><li><a href="https://www.cnblogs.com/joshua317/p/8670923.html" target="_blank" rel="noopener noreferrer">Fiddler抓取https设置详解</a></li></ul>`,148)])])}const i=s(e,[["render",l]]),u=JSON.parse('{"path":"/strong/39.crawl-1.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/39.crawl-1.md"}');export{i as comp,u as data};
