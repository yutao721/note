import{_ as n,c as a,a as t,o as e}from"./app-CD1YpnS1.js";const p={};function l(o,s){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h2 id="_1-ts中的工程化" tabindex="-1"><a class="header-anchor" href="#_1-ts中的工程化"><span>1. TS中的工程化</span></a></h2><ul><li>前端工程化就是通过流程规范化、标准化提升团队协作效率</li><li>通过组件化、模块化提升代码质量</li><li>使用构建工具、自动化工具提升开发效率</li><li>编译 =&gt; 打包(合并) =&gt; 压缩 =&gt; 代码检查 =&gt; 测试 =&gt; 持续集成</li></ul><h2 id="_2-编译参数" tabindex="-1"><a class="header-anchor" href="#_2-编译参数"><span>2. 编译参数</span></a></h2><ul><li><a href="https://www.tslang.cn/docs/handbook/compiler-options.html" target="_blank" rel="noopener noreferrer">编译参数</a></li></ul><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">功能</th></tr></thead><tbody><tr><td style="text-align:left;">rootDir,outDir</td><td style="text-align:left;">配置输入输出目录</td></tr><tr><td style="text-align:left;">lib,jsx</td><td style="text-align:left;">添加基础库的能力</td></tr><tr><td style="text-align:left;">noImplicitAny,strict</td><td style="text-align:left;">更严格的模式</td></tr><tr><td style="text-align:left;">module,target,declaration,sourceMap</td><td style="text-align:left;">控制输出的内容</td></tr><tr><td style="text-align:left;">watch</td><td style="text-align:left;">观察模式</td></tr><tr><td style="text-align:left;">allowJs</td><td style="text-align:left;">允许编译javascript文件</td></tr></tbody></table><h2 id="_3-代码检查" tabindex="-1"><a class="header-anchor" href="#_3-代码检查"><span>3. 代码检查</span></a></h2><h2 id="_3-代码检查-1" tabindex="-1"><a class="header-anchor" href="#_3-代码检查-1"><span>3. 代码检查</span></a></h2><ul><li>ESLint 是一款插件化的 JavaScript 静态代码检查工具，ESLint 通过规则来描述具体的检查行为</li><li><a href="https://eslint.org" target="_blank" rel="noopener noreferrer">eslint</a></li></ul><h3 id="_3-1-模块安装" tabindex="-1"><a class="header-anchor" href="#_3-1-模块安装"><span>3.1 模块安装</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">cnpm i eslint typescript @typescript-eslint/parser @typescript-eslint/eslint-plugin --save-dev</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-2-eslintrc配置文件" tabindex="-1"><a class="header-anchor" href="#_3-2-eslintrc配置文件"><span>3.2 eslintrc配置文件</span></a></h3><ul><li><a href="https://eslint.org/docs/rules/" target="_blank" rel="noopener noreferrer">英文rules</a></li><li><a href="https://cn.eslint.org/docs/rules/" target="_blank" rel="noopener noreferrer">中文rules</a></li><li>需要添加<code>parserOptions</code>以支持模块化的写法</li><li>.eslintrc.js</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-property property">&quot;parser&quot;</span><span class="token operator">:</span><span class="token string">&quot;@typescript-eslint/parser&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;@typescript-eslint&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string-property property">&quot;rules&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;no-var&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;no-extra-semi&quot;</span><span class="token operator">:</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;@typescript-eslint/indent&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token string-property property">&quot;parserOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token string-property property">&quot;ecmaVersion&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;sourceType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string-property property">&quot;ecmaFeatures&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token string-property property">&quot;modules&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3-npm命令" tabindex="-1"><a class="header-anchor" href="#_3-3-npm命令"><span>3.3 npm命令</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">&quot;scripts&quot;: {</span>
<span class="line">    &quot;start&quot;: &quot;webpack&quot;,</span>
<span class="line">    &quot;build&quot;: &quot;tsc&quot;,</span>
<span class="line">    &quot;eslint&quot;: &quot;eslint src --ext .ts&quot;,</span>
<span class="line">    &quot;eslint:fix&quot;: &quot;eslint src --ext .ts --fix&quot;</span>
<span class="line">  }</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">var</span> name2 <span class="token operator">=</span> <span class="token string">&#39;zhufeng&#39;</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>检查结果</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line">src\\helloworld<span class="token punctuation">.</span>ts</span>
<span class="line">  <span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span>   error  Unexpected <span class="token keyword">var</span><span class="token punctuation">,</span> use <span class="token keyword">let</span> or <span class="token keyword">const</span> instead      no<span class="token operator">-</span><span class="token keyword">var</span></span>
<span class="line">  <span class="token number">1</span><span class="token operator">:</span><span class="token number">23</span>  error  Unnecessary semicolon                         no<span class="token operator">-</span>extra<span class="token operator">-</span>semi</span>
<span class="line">  <span class="token number">1</span><span class="token operator">:</span><span class="token number">24</span>  error  Unnecessary semicolon                         no<span class="token operator">-</span>extra<span class="token operator">-</span>semi</span>
<span class="line">  <span class="token number">3</span><span class="token operator">:</span><span class="token number">1</span>   error  Expected indentation <span class="token keyword">of</span> <span class="token number">2</span> spaces but found <span class="token number">4</span>  @typescript<span class="token operator">-</span>eslint<span class="token operator">/</span>inden</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-4-配置自动修复" tabindex="-1"><a class="header-anchor" href="#_3-4-配置自动修复"><span>3.4 配置自动修复</span></a></h3><ul><li>安装vscode的eslint插件</li><li>配置参数 .vscode\\settings.json<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token string-property property">&quot;eslint.autoFixOnSave&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string-property property">&quot;eslint.validate&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token string">&quot;javascript&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string">&quot;javascriptreact&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">          <span class="token string-property property">&quot;language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;typescript&quot;</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token string-property property">&quot;autoFix&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">       <span class="token punctuation">{</span></span>
<span class="line">          <span class="token string-property property">&quot;language&quot;</span><span class="token operator">:</span> <span class="token string">&quot;typescriptreact&quot;</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token string-property property">&quot;autoFix&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p><img src="http://img.zhufengpeixun.cn/eslintplugin.png" alt="eslintplugin"></p><p><img src="http://img.zhufengpeixun.cn/eslint.png" alt="eslint"></p><h2 id="_4-git-hooks-检查" tabindex="-1"><a class="header-anchor" href="#_4-git-hooks-检查"><span>4. Git Hooks 检查</span></a></h2><ul><li>Git 基本已经成为项目开发中默认的版本管理软件，在使用 Git 的项目中，我们可以为项目设置 Git Hooks 来帮我们在提交代码的各个阶段做一些代码检查等工作</li><li>钩子（Hooks） 都被存储在 Git 目录下的 hooks 子目录中。 也就是绝大部分项目中的 .git/hooks 目录</li><li><a href="https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90" target="_blank" rel="noopener noreferrer">钩子</a>分为两大类，客户端的和服务器端的 <ul><li>客户端钩子主要被提交和合并这样的操作所调用</li><li>而服务器端钩子作用于接收被推送的提交这样的联网操作，这里我们主要介绍客户端钩子</li></ul></li></ul><h3 id="_4-1-pre-commit" tabindex="-1"><a class="header-anchor" href="#_4-1-pre-commit"><span>4.1 pre-commit</span></a></h3><ul><li><code>pre-commit</code> 就是在代码提交之前做些东西，比如代码打包，代码检测，称之为钩子（hook）</li><li>在commit之前执行一个函数（callback）。这个函数成功执行完之后，再继续commit，但是失败之后就阻止commit</li><li>在.git-&gt;hooks-&gt;下面有个pre-commit.sample*，这个里面就是默认的函数(脚本)样本</li></ul><h3 id="_4-2-安装pre-commit" tabindex="-1"><a class="header-anchor" href="#_4-2-安装pre-commit"><span>4.2 安装pre-commit</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">npm install pre-commit --save-dev</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_4-3-配置脚本" tabindex="-1"><a class="header-anchor" href="#_4-3-配置脚本"><span>4.3 配置脚本</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">&quot;scripts&quot;: {</span>
<span class="line">    &quot;build&quot;: &quot;tsc&quot;,</span>
<span class="line">    &quot;eslint&quot;: &quot;eslint src --ext .ts&quot;,</span>
<span class="line">    &quot;eslint:fix&quot;: &quot;eslint src --ext .ts --fix&quot;</span>
<span class="line">  },</span>
<span class="line">  &quot;pre-commit&quot;: [</span>
<span class="line">    &quot;eslint&quot;</span>
<span class="line">  ]</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>如果没有在<code>.git-&gt;hooks</code>目录下生成<code>pre-commit</code>文件的话，则要手工创建<code>node ./node_modules/pre-commit/install.js</code></p></blockquote><h2 id="_5-单元测试" tabindex="-1"><a class="header-anchor" href="#_5-单元测试"><span>5. 单元测试</span></a></h2><ul><li>Mocha是现在最流行的JavaScript测试框架之一，在浏览器和Node环境都可以使用。</li><li>所谓&quot;测试框架&quot;，就是运行测试的工具。通过它，可以为JavaScript应用添加测试，从而保证代码的质量</li></ul><h3 id="_5-1-安装" tabindex="-1"><a class="header-anchor" href="#_5-1-安装"><span>5.1 安装</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">cnpm i mocha  @types/mocha chai @types/chai ts-node @types/node  --save-dev</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_5-2-sum-ts" tabindex="-1"><a class="header-anchor" href="#_5-2-sum-ts"><span>5.2 sum.ts</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span>number<span class="token punctuation">,</span><span class="token literal-property property">y</span><span class="token operator">:</span>number</span><span class="token punctuation">)</span><span class="token operator">:</span>number<span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">x</span><span class="token operator">:</span>number<span class="token punctuation">,</span><span class="token literal-property property">y</span><span class="token operator">:</span>number</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toPrecision</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-sum-test-ts" tabindex="-1"><a class="header-anchor" href="#_5-3-sum-test-ts"><span>5.3 sum.test.ts</span></a></h3><ul><li>通常，测试脚本与所要测试的源码脚本同名，但是后缀名为.test.js（表示测试）或者.spec.js（表示规格）。比如，add.js的测试脚本名字就是add.test.js</li><li>测试脚本里面应该包括一个或多个describe块，每个describe块应该包括一个或多个it块</li><li>describe块称为&quot;测试套件&quot;（test suite），表示一组相关的测试。它是一个函数，第一个参数是测试套件的名称（&quot;加法函数的测试&quot;），第二个参数是一个实际执行的函数。</li><li>it块称为&quot;测试用例&quot;（test case），表示一个单独的测试，是测试的最小单位。它也是一个函数，第一个参数是测试用例的名称（&quot;1 加 1 应该等于 2&quot;），第二个参数是一个实际执行的函数。</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> sum <span class="token keyword">from</span> <span class="token string">&#39;../src/sum&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> assert <span class="token keyword">from</span> <span class="token string">&#39;assert&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> chai <span class="token keyword">from</span> <span class="token string">&#39;chai&#39;</span></span>
<span class="line"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;test sum&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;1+1=2&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">    assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;2+2=4&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">    chai<span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;0.1+0.2=0.3&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">    assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">.1</span><span class="token punctuation">,</span><span class="token number">.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-4-断言库" tabindex="-1"><a class="header-anchor" href="#_5-4-断言库"><span>5.4 断言库</span></a></h3><ul><li>所谓&quot;断言&quot;，就是判断源码的实际执行结果与预期结果是否一致，如果不一致就抛出一个错误</li><li>所有的测试用例（it块）都应该含有一句或多句的断言。它是编写测试用例的关键。断言功能由断言库来实现，Mocha本身不带断言库，所以必须先引入断言库</li></ul><h4 id="_5-4-1-assert" tabindex="-1"><a class="header-anchor" href="#_5-4-1-assert"><span>5.4.1 assert</span></a></h4><ul><li>assert.equal 用于判断两个值是否相等</li></ul><h4 id="_5-4-2-chai" tabindex="-1"><a class="header-anchor" href="#_5-4-2-chai"><span>5.4.2 chai</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token comment">// 相等或不相等</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zhufeng&#39;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zhufeng&#39;</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span>deep<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 布尔值为true</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span>ok<span class="token punctuation">;</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>not<span class="token punctuation">.</span>be<span class="token punctuation">.</span>ok<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 类型判断</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&#39;zhufeng&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token function">a</span><span class="token punctuation">(</span><span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token string">&#39;zhufeng&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token function">an</span><span class="token punctuation">(</span><span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span>an<span class="token punctuation">.</span><span class="token function">instanceof</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//包含</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">include</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&#39;zhufeng&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">contain</span><span class="token punctuation">(</span><span class="token string">&#39;feng&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;zhufeng&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">9</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>include<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 是否为空</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span>empty<span class="token punctuation">;</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span>empty<span class="token punctuation">;</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span>empty<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 正则匹配</span></span>
<span class="line"><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&#39;zhufengnodejs@126.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^zhufeng</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>头部是expect方法，尾部是断言方法，比如equal、a/an、ok、match等。两者之间使用to或to.be连接</p></blockquote><h3 id="_5-5-指定测试脚本文件" tabindex="-1"><a class="header-anchor" href="#_5-5-指定测试脚本文件"><span>5.5 指定测试脚本文件</span></a></h3><ul><li>mocha命令后面紧跟测试脚本的路径和文件名，可以指定多个测试脚本。</li><li>Mocha默认运行test子目录里面的测试脚本。所以，一般都会把测试脚本放在test目录里面，然后执行mocha就不需要参数了</li><li>加上--recursive参数，就会执行test子目录下面所有的层的测试用例</li><li>命令行指定测试脚本时，可以使用通配符，同时指定多个文件</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">mocha spec/{a,b}.js      执行spec目录下面的a.js和b.js</span>
<span class="line">mocha test/*.js     执行test目录下面的所有文件</span>
<span class="line">mocha test/**/*.js   执行test目录下面任何子目录中、文件后缀名为js的测试脚本</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-6-tsconfig-json" tabindex="-1"><a class="header-anchor" href="#_5-6-tsconfig-json"><span>5.6 tsconfig.json</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token string-property property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string-property property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;commonjs&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-7-package-json" tabindex="-1"><a class="header-anchor" href="#_5-7-package-json"><span>5.7 package.json</span></a></h3><ul><li>mocha命令后面紧跟测试脚本的路径和文件名，可以指定多个测试脚本</li><li>Mocha默认运行<code>test</code>子目录里面的测试脚本。所以，一般都会把测试脚本放在<code>test</code>目录里面，然后执行mocha就不需要参数了</li><li>加上--recursive参数可以保证子目录下面所有的测试用例都会执行</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">  &quot;scripts&quot;: {</span>
<span class="line">    &quot;test&quot;: &quot;set TS_NODE_COMPILER_OPTIONS={\\&quot;module\\&quot;:\\&quot;commonjs\\&quot;}  &amp;&amp; mocha --require ts-node/register --watch --watch-extensions ts test/**/*&quot;</span>
<span class="line">  },</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>如果&quot;module&quot;: &quot;es2015&quot;的话则需要在命令行中配置module规范</p></blockquote><h3 id="_5-8-配置文件mocha-opts" tabindex="-1"><a class="header-anchor" href="#_5-8-配置文件mocha-opts"><span>5.8 配置文件mocha.opts</span></a></h3><ul><li>Mocha允许在test目录下面，放置配置文件mocha.opts，把命令行参数写在里面</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">--require ts-node/register </span>
<span class="line">--watch </span>
<span class="line">--watch-extensions ts</span>
<span class="line">test/sum.test.ts</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-9-方法调用" tabindex="-1"><a class="header-anchor" href="#_5-9-方法调用"><span>5.9 方法调用</span></a></h3><ul><li>Sinon 是用于 JavaScript 的测试框架，适用于任何单元测试框架。</li><li>Sinon 将测试为三种类型： <ul><li>Spies：提供有关函数调用的信息，而不会影响其行为</li><li>Stubs：类似于 Spies，但完全取代了功能。这样就可以使存根函数做任何你喜欢的事情 - 抛出异常，返回一个特定的值等等</li><li>Mocks：通过组合 Spies 和 Stubs，可以更轻松地替换整个对象</li></ul></li></ul><p>|监控函数执行|真正执行原函数|替换原有实现|提供行为描述| |:---|:---|:---|:---|:---| |spy|是|是||| |stub|是||是|| |mock|是||是|是|</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">npm install sinon @types/sinon -D</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_5-9-1-要测试的类" tabindex="-1"><a class="header-anchor" href="#_5-9-1-要测试的类"><span>5.9.1 要测试的类</span></a></h4><p>src\\todo.ts</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Todos</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">private</span> <span class="token literal-property property">todos</span><span class="token operator">:</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token keyword">private</span> <span class="token literal-property property">store</span><span class="token operator">:</span>any</span>
<span class="line">  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">store</span><span class="token operator">:</span>any</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token operator">=</span>store<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span>  </span>
<span class="line">  <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">todo</span><span class="token operator">:</span>string</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>todos<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-9-2-spy" tabindex="-1"><a class="header-anchor" href="#_5-9-2-spy"><span>5.9.2 spy</span></a></h4><ul><li>提供有关函数调用的信息，而不会影响其行为<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> sinon <span class="token keyword">from</span> <span class="token string">&quot;sinon&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span>  chai  <span class="token keyword">from</span> <span class="token string">&quot;chai&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> Todos <span class="token keyword">from</span> <span class="token string">&quot;../src/todos&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;测试 Todos&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;spy print&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">const</span> t <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Todos</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token comment">// 用 sinon.spy 监控 console.log 函数的执行，并不替换其原有的实现</span></span>
<span class="line">  sinon<span class="token punctuation">.</span><span class="token function">spy</span><span class="token punctuation">(</span>console<span class="token punctuation">,</span> <span class="token string">&quot;log&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  t<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;eat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  t<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;sleep&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  t<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//函数真正执行了</span></span>
<span class="line">  <span class="token comment">// @ts-ignore console.log.calledOnce 无法识别 注释功能。这些注释是一种轻量级的方法来抑制下一行中出现的任何错误。</span></span>
<span class="line">  <span class="token comment">// 如果 spy 监控的 console.log 函数刚好被调用一次，则返回 true</span></span>
<span class="line">  chai<span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">.</span>calledOnce<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_5-9-3-stub" tabindex="-1"><a class="header-anchor" href="#_5-9-3-stub"><span>5.9.3 stub</span></a></h4><ul><li>类似于 spy，但完全取代了功能。这样就可以使存根函数做任何你喜欢的事情 - 抛出异常，返回一个特定的值等等</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span>  sinon <span class="token keyword">from</span> <span class="token string">&quot;sinon&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> expect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;chai&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> Todos <span class="token keyword">from</span> <span class="token string">&quot;../src/todos&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;测试 Todos&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;stub&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">const</span> todos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Todos</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// 用 stub 模拟 t.add 函数，stubAdd 函数被模拟为一个空函数</span></span>
<span class="line">    <span class="token keyword">const</span> stubAdd <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">stub</span><span class="token punctuation">(</span>todos<span class="token punctuation">,</span> <span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">callsFake</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// 执行被模拟的 stubAdd 函数，这时候 &#39;eat&#39; 并没有被真正地 push</span></span>
<span class="line">    <span class="token function">stubAdd</span><span class="token punctuation">(</span><span class="token string">&quot;eat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// 尝试打印，会打印出 []</span></span>
<span class="line">    todos<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// 我们期望 stubAdd 被执行了一次</span></span>
<span class="line">    <span class="token function">expect</span><span class="token punctuation">(</span>stubAdd<span class="token punctuation">.</span>calledOnce<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token boolean">true</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-9-4-mock" tabindex="-1"><a class="header-anchor" href="#_5-9-4-mock"><span>5.9.4 mock</span></a></h4><ul><li>通过组合 Spies 和 Stubs，可以更轻松地替换整个对象</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span>  sinon <span class="token keyword">from</span> <span class="token string">&quot;sinon&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> expect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;chai&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> Todos <span class="token keyword">from</span> <span class="token string">&quot;../src/todos&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;测试 Todos&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;mock&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">const</span> todos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Todos</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// 这时候 console 已经被 mock 完全 mock 了</span></span>
<span class="line">    <span class="token comment">// 这里可以调用console下的任何方法，但并不会执行</span></span>
<span class="line">    <span class="token keyword">const</span> mock <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span>console<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// 由于 console 已经完全被 mock了，所以我们这里可以提前描述我们预期的行为</span></span>
<span class="line">    mock<span class="token punctuation">.</span><span class="token function">expects</span><span class="token punctuation">(</span><span class="token string">&quot;log&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>calledOnce<span class="token punctuation">;</span></span>
<span class="line">    todos<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;eat&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    todos<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// 校验</span></span>
<span class="line">    mock<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-为js添加ts支持" tabindex="-1"><a class="header-anchor" href="#_6-为js添加ts支持"><span>6. 为JS添加TS支持</span></a></h2><h3 id="_6-1-sum-js" tabindex="-1"><a class="header-anchor" href="#_6-1-sum-js"><span>6.1 sum.js</span></a></h3><p>src\\sum.js</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token doc-comment comment">/**</span>
<span class="line"> * 可以使用注释给参数添加类型</span>
<span class="line"> * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>number<span class="token punctuation">}</span></span> <span class="token parameter">x</span>  </span>
<span class="line"> * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>number<span class="token punctuation">}</span></span> <span class="token parameter">y</span> </span>
<span class="line"> */</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toPrecision</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-3-sum-test-ts" tabindex="-1"><a class="header-anchor" href="#_6-3-sum-test-ts"><span>6.3 sum.test.ts</span></a></h3><p>test\\sum.test.ts</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token keyword">import</span> sum <span class="token keyword">from</span> <span class="token string">&#39;../src/sum&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span>  assert <span class="token keyword">from</span> <span class="token string">&#39;assert&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;test sum&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;1+2=3&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">    assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&#39;0.1+0.2=0.3&#39;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-3-tsconfig-json" tabindex="-1"><a class="header-anchor" href="#_6-3-tsconfig-json"><span>6.3 tsconfig.json</span></a></h3><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">{</span>
<span class="line">  &quot;compilerOptions&quot;: {</span>
<span class="line">+     &quot;checkJs&quot;: true, //允许代码中使用JS</span>
<span class="line">+     &quot;checkJs&quot;: true, //可以对JS进行类型检查</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-持续集成" tabindex="-1"><a class="header-anchor" href="#_7-持续集成"><span>7. 持续集成</span></a></h2><ul><li><a href="https://travis-ci.com" target="_blank" rel="noopener noreferrer">Travis CI</a> 提供的是持续集成服务（Continuous Integration，简称 CI）。它绑定 Github 上面的项目，只要有新的代码，就会自动抓取。然后，提供一个运行环境，执行测试，完成构建，还能部署到服务器</li><li>持续集成指的是只要代码有变更，就自动运行构建和测试，反馈运行结果。确保符合预期以后，再将新代码集成到主干</li><li>持续集成的好处在于，每次代码的小幅变更，就能看到运行结果，从而不断累积小的变更，而不是在开发周期结束时，一下子合并一大块代码</li></ul><h3 id="_7-1-登录并创建项目" tabindex="-1"><a class="header-anchor" href="#_7-1-登录并创建项目"><span>7.1 登录并创建项目</span></a></h3><ul><li><a href="https://travis-ci.com" target="_blank" rel="noopener noreferrer">Travis CI</a> 只支持 Github,所以你要拥有<code>GitHub</code>帐号</li><li>该帐号下面有一个项目,面有可运行的代码,还包含构建或测试脚本</li><li>你需要激活了一个仓库，Travis 会监听这个仓库的所有变化</li></ul><h3 id="_7-2-travis-yml" tabindex="-1"><a class="header-anchor" href="#_7-2-travis-yml"><span>7.2 .travis.yml</span></a></h3><ul><li><code>Travis</code> 要求项目的根目录下面，必须有一个<code>.travis.yml</code>文件。这是配置文件，指定了 Travis 的行为</li><li>该文件必须保存在 Github 仓库里面，一旦代码仓库有新的 <code>Commit</code>，Travis 就会去找这个文件，执行里面的命令</li><li>这个文件采用 YAML 格式。下面是一个最简单的 Node 项目的<code>.travis.yml</code>文件</li><li>language 字段指定了默认运行环境,<a href="https://docs.travis-ci.com/user/languages" target="_blank" rel="noopener noreferrer">所有的语言在此</a></li><li>node_js: &quot;11&quot; 表示不执行任何脚本，状态直接设为成功</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token literal-property property">language</span><span class="token operator">:</span> node_js</span>
<span class="line"><span class="token literal-property property">node_js</span><span class="token operator">:</span></span>
<span class="line">  <span class="token operator">-</span> <span class="token string">&quot;11&quot;</span></span>
<span class="line"><span class="token literal-property property">install</span><span class="token operator">:</span> npm install</span>
<span class="line"><span class="token literal-property property">script</span><span class="token operator">:</span>  npm test  </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-3-运行流程" tabindex="-1"><a class="header-anchor" href="#_7-3-运行流程"><span>7.3 运行流程</span></a></h3><h4 id="_7-3-1-运行流程" tabindex="-1"><a class="header-anchor" href="#_7-3-1-运行流程"><span>7.3.1 运行流程</span></a></h4><ul><li>Travis 的运行流程很简单，任何项目都会经过两个阶段 <ul><li>install 阶段：安装依赖</li><li>script 阶段：运行脚本</li></ul></li></ul><h4 id="_7-3-2-install" tabindex="-1"><a class="header-anchor" href="#_7-3-2-install"><span>7.3.2 install</span></a></h4><ul><li><code>install</code>字段用来指定安装脚本 <code>install: npm install -g npm</code></li><li>如果不需要安装，即跳过安装阶段，就直接设为true <code>install: true</code></li></ul><h4 id="_7-3-3-script" tabindex="-1"><a class="header-anchor" href="#_7-3-3-script"><span>7.3.3 script</span></a></h4><ul><li>script字段用来指定构建或测试脚本<div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">script: npm run build</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h4 id="_7-3-4-钩子方法" tabindex="-1"><a class="header-anchor" href="#_7-3-4-钩子方法"><span>7.3.4 钩子方法</span></a></h4><p>Travis 为上面这些阶段提供了7个钩子</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">before_install  安装阶段之前执行</span>
<span class="line">install 安装</span>
<span class="line">before_script 脚本阶段之前执行</span>
<span class="line">script 脚本阶段</span>
<span class="line">aftersuccess or afterfailure 脚本成功或失败</span>
<span class="line">[OPTIONAL] before_deploy 布署之前</span>
<span class="line">[OPTIONAL] deploy 布署</span>
<span class="line">[OPTIONAL] after_deploy 布署之后</span>
<span class="line">after_script  脚本阶段之后</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-4-实战" tabindex="-1"><a class="header-anchor" href="#_7-4-实战"><span>7.4 实战</span></a></h3><h4 id="_7-4-1-安装hexo" tabindex="-1"><a class="header-anchor" href="#_7-4-1-安装hexo"><span>7.4.1 安装hexo</span></a></h4><ul><li><a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener noreferrer">hexo</a>是一个快速、简洁且高效的博客框架</li></ul><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ npm install -g hexo-cli</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_7-4-2-生成项目" tabindex="-1"><a class="header-anchor" href="#_7-4-2-生成项目"><span>7.4.2 生成项目</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">hexo init zfblog</span>
<span class="line">cd zfblog</span>
<span class="line">npm install</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-4-3-启动项目" tabindex="-1"><a class="header-anchor" href="#_7-4-3-启动项目"><span>7.4.3 启动项目</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">hexo generate</span>
<span class="line">hexo server</span>
<span class="line">hexo deploy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-4-4-布署项目" tabindex="-1"><a class="header-anchor" href="#_7-4-4-布署项目"><span>7.4.4 布署项目</span></a></h4><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code class="language-text"><span class="line">$ cnpm install eslint hexo-deployer-git --save</span>
<span class="line">cnpm generate</span>
<span class="line">cnpm deploy</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>_config.yml</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"> </span>
<span class="line"> #</span>
<span class="line"><span class="token literal-property property">deploy</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">type</span><span class="token operator">:</span> git</span>
<span class="line">  <span class="token literal-property property">repo</span><span class="token operator">:</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>zhufengnodejs<span class="token operator">/</span>zfblog2<span class="token punctuation">.</span>git</span>
<span class="line">  <span class="token literal-property property">branch</span><span class="token operator">:</span> gh<span class="token operator">-</span>pages</span>
<span class="line">  <span class="token literal-property property">message</span><span class="token operator">:</span> </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><a href="https://zhufengnodejs.github.io/zfblog2" target="_blank" rel="noopener noreferrer">https://zhufengnodejs.github.io/zfblog2</a></p></blockquote><h4 id="_7-4-5-同步仓库" tabindex="-1"><a class="header-anchor" href="#_7-4-5-同步仓库"><span>7.4.5 同步仓库</span></a></h4><ul><li>登录<a href="https://travis-ci.com/" target="_blank" rel="noopener noreferrer">travis-ci.com</a>选择同步仓库</li></ul><p><img src="http://img.zhufengpeixun.cn/1.syncrepos.png" alt="syncrepos"></p><h4 id="_7-4-6-设置仓库环境变量" tabindex="-1"><a class="header-anchor" href="#_7-4-6-设置仓库环境变量"><span>7.4.6 设置仓库环境变量</span></a></h4><table><thead><tr><th style="text-align:left;">变量名</th><th style="text-align:left;">含义</th></tr></thead><tbody><tr><td style="text-align:left;">USERNAME</td><td style="text-align:left;">git用户名</td></tr><tr><td style="text-align:left;">UESREMAIL</td><td style="text-align:left;">git用户邮箱</td></tr><tr><td style="text-align:left;">GH_TOKEN</td><td style="text-align:left;">用户生成的令牌</td></tr><tr><td style="text-align:left;">GH_REF</td><td style="text-align:left;">仓库地址</td></tr><tr><td style="text-align:left;">GH_BRANCH</td><td style="text-align:left;">推送的pages分支</td></tr></tbody></table><p><img src="http://img.zhufengpeixun.cn/2.settings.png" alt="2.settings"></p><h4 id="_7-4-7-github生成访问令牌-即添加授权" tabindex="-1"><a class="header-anchor" href="#_7-4-7-github生成访问令牌-即添加授权"><span>7.4.7 Github生成访问令牌 (即添加授权)</span></a></h4><ul><li>访问令牌的作用就是授权仓库操作权限</li><li>Github&gt;settings&gt;Personal access tokens&gt; Generate new token &gt; Generate token&gt; Copy Token</li></ul><h4 id="_7-4-8-travis-yml" tabindex="-1"><a class="header-anchor" href="#_7-4-8-travis-yml"><span>7.4.8 .travis.yml</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code class="language-javascript"><span class="line"><span class="token literal-property property">language</span><span class="token operator">:</span> node_js</span>
<span class="line"><span class="token literal-property property">node_js</span><span class="token operator">:</span> </span>
<span class="line">    <span class="token operator">-</span> <span class="token string">&#39;11&#39;</span></span>
<span class="line"><span class="token literal-property property">install</span><span class="token operator">:</span></span>
<span class="line">  <span class="token operator">-</span> npm install</span>
<span class="line"><span class="token literal-property property">script</span><span class="token operator">:</span></span>
<span class="line">  <span class="token operator">-</span> hexo g</span>
<span class="line"><span class="token literal-property property">after_script</span><span class="token operator">:</span></span>
<span class="line">  <span class="token operator">-</span> cd <span class="token punctuation">.</span><span class="token operator">/</span><span class="token keyword">public</span></span>
<span class="line">  <span class="token operator">-</span> git init</span>
<span class="line">  <span class="token operator">-</span> git config user<span class="token punctuation">.</span>name <span class="token string">&quot;\${USERNAME}&quot;</span></span>
<span class="line">  <span class="token operator">-</span> git config user<span class="token punctuation">.</span>email <span class="token string">&quot;\${UESREMAIL}&quot;</span></span>
<span class="line">  <span class="token operator">-</span> git add <span class="token operator">-</span><span class="token constant">A</span></span>
<span class="line">  <span class="token operator">-</span> git commit <span class="token operator">-</span>m <span class="token string">&quot;Update documents&quot;</span></span>
<span class="line">  <span class="token operator">-</span> git push <span class="token operator">--</span>force  <span class="token string">&quot;https://\${GH_TOKEN}@\${GH_REF}&quot;</span> <span class="token string">&quot;master:\${GH_BRANCH}&quot;</span></span>
<span class="line"><span class="token literal-property property">branches</span><span class="token operator">:</span></span>
<span class="line">  <span class="token literal-property property">only</span><span class="token operator">:</span></span>
<span class="line">    <span class="token operator">-</span> master</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,126)])])}const i=n(p,[["render",l]]),u=JSON.parse('{"path":"/strong/65.2.typescript.html","title":"","lang":"en-US","frontmatter":{},"git":{"updatedTime":1681290319000,"contributors":[{"name":"yutao","username":"yutao","email":"642231346@qq.com","commits":1,"url":"https://github.com/yutao"}],"changelog":[{"hash":"f5ab8c9d34991ec274f7f652439afe5b2afb6147","time":1681290319000,"email":"642231346@qq.com","author":"yutao","message":"modify"}]},"filePathRelative":"strong/65.2.typescript.md"}');export{i as comp,u as data};
